(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[878],{5382:function(a,b,c){!function(a,d){d(b,c(7424),c(6690),c(9728))}(this,function(a,b,c,d){"use strict";function e(a){return a&&"object"==typeof a&&"default"in a?a:{default:a}}var f=e(b),g=e(c),h=e(d),i=function(a,b,c){return{endTime:b,insertTime:c,type:"exponentialRampToValue",value:a}},j=function(a,b,c){return{endTime:b,insertTime:c,type:"linearRampToValue",value:a}},k=function(a,b){return{startTime:b,type:"setValue",value:a}},l=function(a,b,c){return{duration:c,startTime:b,type:"setValueCurve",values:a}},m=function(a,b,c){var d=c.startTime,e=c.target,f=c.timeConstant;return e+(b-e)*Math.exp((d-a)/f)},n=function(a){return"exponentialRampToValue"===a.type},o=function(a){return"linearRampToValue"===a.type},p=function(a){return n(a)||o(a)},q=function(a){return"setValue"===a.type},r=function(a){return"setValueCurve"===a.type},s=function a(b,c,d,e){var f=b[c];return void 0===f?e:p(f)||q(f)?f.value:r(f)?f.values[f.values.length-1]:m(d,a(b,c-1,f.startTime,e),f)},t=function(a,b,c,d,e){return void 0===c?[d.insertTime,e]:p(c)?[c.endTime,c.value]:q(c)?[c.startTime,c.value]:r(c)?[c.startTime+c.duration,c.values[c.values.length-1]]:[c.startTime,s(a,b-1,c.startTime,e)]},u=function(a){return"cancelAndHold"===a.type},v=function(a){return"cancelScheduledValues"===a.type},w=function(a){return u(a)||v(a)?a.cancelTime:n(a)||o(a)?a.endTime:a.startTime},x=function(a,b,c,d){var e=d.endTime,f=d.value;return c===f?f:0<c&&0<f||c<0&&f<0?c*Math.pow(f/c,(a-b)/(e-b)):0},y=function(a,b,c,d){var e=d.endTime,f=d.value;return c+(a-b)/(e-b)*(f-c)},z=function(a,b){var c=Math.floor(b),d=Math.ceil(b);return c===d?a[c]:(1-(b-c))*a[c]+(1-(d-b))*a[d]},A=function(a,b){var c=b.duration,d=b.startTime,e=b.values,f=(a-d)/c*(e.length-1);return z(e,f)},B=function(a){return"setTarget"===a.type},C=function(a){function b(a){g.default(this,b),this._automationEvents=[],this._currenTime=0,this._defaultValue=a}return h.default(b,[{key:a,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(a){var b=w(a);if(u(a)||v(a)){var c=this._automationEvents.findIndex(function(c){return v(a)&&r(c)?c.startTime+c.duration>=b:w(c)>=b}),d=this._automationEvents[c];if(-1!==c&&(this._automationEvents=this._automationEvents.slice(0,c)),u(a)){var e=this._automationEvents[this._automationEvents.length-1];if(void 0!==d&&p(d)){if(B(e))throw Error("The internal list is malformed.");var f=r(e)?e.startTime+e.duration:w(e),g=r(e)?e.values[e.values.length-1]:e.value,h=n(d)?x(b,f,g,d):y(b,f,g,d),m=n(d)?i(h,b,this._currenTime):j(h,b,this._currenTime);this._automationEvents.push(m)}void 0!==e&&B(e)&&this._automationEvents.push(k(this.getValue(b),b)),void 0!==e&&r(e)&&e.startTime+e.duration>b&&(this._automationEvents[this._automationEvents.length-1]=l(new Float32Array([6,7]),e.startTime,b-e.startTime))}}else{var q=this._automationEvents.findIndex(function(a){return w(a)>b}),s=-1===q?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[q-1];if(void 0!==s&&r(s)&&w(s)+s.duration>b)return!1;var t=n(a)?i(a.value,a.endTime,this._currenTime):o(a)?j(a.value,b,this._currenTime):a;if(-1===q)this._automationEvents.push(t);else{if(r(a)&&b+a.duration>w(this._automationEvents[q]))return!1;this._automationEvents.splice(q,0,t)}}return!0}},{key:"flush",value:function(a){var b=this._automationEvents.findIndex(function(b){return w(b)>a});if(b>1){var c=this._automationEvents.slice(b-1),d=c[0];B(d)&&c.unshift(k(s(this._automationEvents,b-2,d.startTime,this._defaultValue),d.startTime)),this._automationEvents=c}}},{key:"getValue",value:function(a){if(0===this._automationEvents.length)return this._defaultValue;var b=this._automationEvents.findIndex(function(b){return w(b)>a}),c=this._automationEvents[b],d=(-1===b?this._automationEvents.length:b)-1,e=this._automationEvents[d];if(void 0!==e&&B(e)&&(void 0===c||!p(c)||c.insertTime>a))return m(a,s(this._automationEvents,d-1,e.startTime,this._defaultValue),e);if(void 0!==e&&q(e)&&(void 0===c||!p(c)))return e.value;if(void 0!==e&&r(e)&&(void 0===c||!p(c)||e.startTime+e.duration>a))return a<e.startTime+e.duration?A(a,e):e.values[e.values.length-1];if(void 0!==e&&p(e)&&(void 0===c||!p(c)))return e.value;if(void 0!==c&&n(c)){var g=t(this._automationEvents,d,e,c,this._defaultValue),h=f.default(g,2),i=h[0],j=h[1];return x(a,i,j,c)}if(void 0!==c&&o(c)){var k=t(this._automationEvents,d,e,c,this._defaultValue),l=f.default(k,2),u=l[0],v=l[1];return y(a,u,v,c)}return this._defaultValue}}]),b}(Symbol.iterator),D=function(a){return{cancelTime:a,type:"cancelAndHold"}},E=function(a){return{cancelTime:a,type:"cancelScheduledValues"}},F=function(a,b){return{endTime:b,type:"exponentialRampToValue",value:a}},G=function(a,b){return{endTime:b,type:"linearRampToValue",value:a}},H=function(a,b,c){return{startTime:b,target:a,timeConstant:c,type:"setTarget"}};a.AutomationEventList=C,a.createCancelAndHoldAutomationEvent=D,a.createCancelScheduledValuesAutomationEvent=E,a.createExponentialRampToValueAutomationEvent=F,a.createLinearRampToValueAutomationEvent=G,a.createSetTargetAutomationEvent=H,a.createSetValueAutomationEvent=k,a.createSetValueCurveAutomationEvent=l,Object.defineProperty(a,"__esModule",{value:!0})})},4878:function(a,b,c){"use strict";c.r(b),c.d(b,{AMOscillator:function(){return oc},AMSynth:function(){return oI},Abs:function(){return os},Add:function(){return oj},AmplitudeEnvelope:function(){return oF},Analyser:function(){return pX},AudioToGain:function(){return oa},AutoFilter:function(){return pn},AutoPanner:function(){return pp},AutoWah:function(){return pr},BaseContext:function(){return mI},BiquadFilter:function(){return oJ},BitCrusher:function(){return pu},Buffer:function(){return qt},BufferSource:function(){return qv},Buffers:function(){return qu},Channel:function(){return p3},Chebyshev:function(){return pw},Chorus:function(){return pB},Clock:function(){return np},Compressor:function(){return p9},Context:function(){return mJ},Convolver:function(){return qf},CrossFade:function(){return pk},DCMeter:function(){return p_},Delay:function(){return nq},Destination:function(){return qk},Distortion:function(){return pC},Draw:function(){return qp},DuoSynth:function(){return oN},EQ3:function(){return qe},Emitter:function(){return mH},Envelope:function(){return oB},FFT:function(){return p$},FMOscillator:function(){return od},FMSynth:function(){return oO},FatOscillator:function(){return of},FeedbackCombFilter:function(){return o0},FeedbackDelay:function(){return pE},Filter:function(){return oK},Follower:function(){return pq},Freeverb:function(){return pI},Frequency:function(){return m7},FrequencyClass:function(){return m4},FrequencyEnvelope:function(){return oL},FrequencyShifter:function(){return pF},Gain:function(){return nh},GainToAudio:function(){return ot},Gate:function(){return qa},GrainPlayer:function(){return or},GreaterThan:function(){return ox},GreaterThanZero:function(){return ow},IntervalTimeline:function(){return ny},JCReverb:function(){return pL},LFO:function(){return om},Limiter:function(){return qb},Listener:function(){return qn},Loop:function(){return o7},LowpassCombFilter:function(){return o2},Master:function(){return ql},MembraneSynth:function(){return oR},Merge:function(){return py},MetalSynth:function(){return oQ},Meter:function(){return pZ},MidSideCompressor:function(){return qc},MidSideMerge:function(){return pS},MidSideSplit:function(){return pR},Midi:function(){return nu},MidiClass:function(){return nt},Mono:function(){return p4},MonoSynth:function(){return oM},MultibandCompressor:function(){return qd},MultibandSplit:function(){return p5},Multiply:function(){return ob},Negate:function(){return ou},Noise:function(){return nH},NoiseSynth:function(){return oS},Offline:function(){return nr},OfflineContext:function(){return mO},OmniOscillator:function(){return oi},OnePoleFilter:function(){return o1},Oscillator:function(){return n7},PWMOscillator:function(){return og},PanVol:function(){return p2},Panner:function(){return po},Panner3D:function(){return p7},Param:function(){return nc},Part:function(){return o8},Pattern:function(){return pi},Phaser:function(){return pP},PingPongDelay:function(){return pN},PitchShift:function(){return pO},Player:function(){return op},Players:function(){return oq},PluckSynth:function(){return o3},PolySynth:function(){return o4},Pow:function(){return oy},PulseOscillator:function(){return oe},Recorder:function(){return p8},Reverb:function(){return pQ},Sampler:function(){return o5},Scale:function(){return ok},ScaleExp:function(){return oz},Sequence:function(){return pj},Signal:function(){return nk},Solo:function(){return p1},Split:function(){return px},StateTimeline:function(){return nb},StereoWidener:function(){return pU},Subtract:function(){return ov},SyncedSignal:function(){return oA},Synth:function(){return oG},Ticks:function(){return nw},TicksClass:function(){return nv},Time:function(){return m3},TimeClass:function(){return m2},Timeline:function(){return mC},ToneAudioBuffer:function(){return mN},ToneAudioBuffers:function(){return ns},ToneAudioNode:function(){return nd},ToneBufferSource:function(){return nG},ToneEvent:function(){return o6},ToneOscillatorNode:function(){return n6},Transport:function(){return qi},TransportTime:function(){return m9},TransportTimeClass:function(){return m8},Tremolo:function(){return pV},Unit:function(){return hL},UserMedia:function(){return n4},Vibrato:function(){return pW},Volume:function(){return nA},WaveShaper:function(){return n9},Waveform:function(){return p0},Zero:function(){return ol},connect:function(){return nf},connectSeries:function(){return ne},connectSignal:function(){return nl},context:function(){return qr},dbToGain:function(){return mW},debug:function(){return hK},defaultArg:function(){return mu},disconnect:function(){return ng},ftom:function(){return m$},gainToDb:function(){return mX},getContext:function(){return mR},getDestination:function(){return qm},getDraw:function(){return qq},getListener:function(){return qo},getTransport:function(){return qj},immediate:function(){return qh},intervalToFrequencyRatio:function(){return mY},isArray:function(){return mg},isBoolean:function(){return mf},isDefined:function(){return mb},isFunction:function(){return mc},isNote:function(){return mi},isNumber:function(){return md},isObject:function(){return me},isString:function(){return mh},isUndef:function(){return ma},loaded:function(){return qs},mtof:function(){return m0},now:function(){return qg},optionsFromArguments:function(){return mt},setContext:function(){return mS},start:function(){return mT},supported:function(){return l2},version:function(){return hM}});var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b$,b_,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c$,c_,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,da,db,dc,dd,de,df,dg,dh,di,dj,dk,dl,dm,dn,dp,dq,dr,ds,dt,du,dv,dw,dx,dy,dz,dA,dB,dC,dD,dE,dF,dG,dH,dI,dJ,dK,dL,dM,dN,dO,dP,dQ,dR,dS,dT,dU,dV,dW,dX,dY,dZ,d$,d_,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK,eL,eM,eN,eO,eP,eQ,eR,eS,eT,eU,eV,eW,eX,eY,eZ,e$,e_,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,fa,fb,fc,fd,fe,ff,fg,fh,fi,fj,fk,fl,fm,fn,fo,fp,fq,fr,fs,ft,fu,fv,fw,fx,fy,fz,fA,fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f$,f_,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn,go,gp,gq,gr,gs,gt,gu,gv,gw,gx,gy,gz,gA,gB,gC,gD,gE,gF,gG,gH,gI,gJ,gK,gL,gM,gN,gO,gP,gQ,gR,gS,gT,gU,gV,gW,gX,gY,gZ,g$,g_,g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,ha,hb,hc,hd,he,hf,hg,hh,hi,hj,hk,hl,hm,hn,ho,hp,hq,hr,hs,ht,hu,hv,hw,hx,hy,hz,hA,hB,hC,hD,hE,hF,hG,hH,hI,hJ,hK={};c.r(hK),c.d(hK,{assert:function(){return l3},assertContextRunning:function(){return l5},assertRange:function(){return l4},log:function(){return l8},setLogger:function(){return l7},warn:function(){return l9}});var hL={};c.r(hL);let hM="14.7.77";var hN=c(5382);let hO=()=>new DOMException("","AbortError"),hP=new WeakSet,hQ=new WeakMap,hR=new WeakMap,hS=new WeakMap,hT=new WeakMap,hU=new WeakMap,hV=new WeakMap,hW=new WeakMap,hX=new WeakMap,hY=new WeakMap,hZ={construct(){return hZ}},h$=a=>{try{let b=new Proxy(a,hZ);new b}catch{return!1}return!0},h_=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,h0=(a,b)=>{let c=[],d=a.replace(/^[\s]+/,""),e=d.match(h_);for(;null!==e;){let f=e[1].slice(1,-1),g=e[0].replace(/([\s]+)?;?$/,"").replace(f,new URL(f,b).toString());c.push(g),e=(d=d.slice(e[0].length).replace(/^[\s]+/,"")).match(h_)}return[c.join(";"),d]},h1=a=>{if(void 0!==a&&!Array.isArray(a))throw TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},h2=a=>{if(!h$(a))throw TypeError("The given value for processorCtor should be a constructor.");if(null===a.prototype||"object"!=typeof a.prototype)throw TypeError("The given value for processorCtor should have a prototype.")},h3=(a,b)=>{let c=a.get(b);if(void 0===c)throw Error("A value with the given key could not be found.");return c},h4=(a,b)=>{let c=Array.from(a).filter(b);if(c.length>1)throw Error("More than one element was found.");if(0===c.length)throw Error("No element was found.");let[d]=c;return a.delete(d),d},h5=(a,b,c,d)=>{let e=h3(a,b),f=h4(e,a=>a[0]===c&&a[1]===d);return 0===e.size&&a.delete(b),f},h6=a=>h3(hV,a),h7=a=>{if(hP.has(a))throw Error("The AudioNode is already stored.");hP.add(a),h6(a).forEach(a=>a(!0))},h8=a=>"port"in a,h9=a=>{if(!hP.has(a))throw Error("The AudioNode is not stored.");hP.delete(a),h6(a).forEach(a=>a(!1))},ia=(a,b)=>{!h8(a)&&b.every(a=>0===a.size)&&h9(a)},ib=(a,b)=>a.context===b,ic=a=>{try{a.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},id=()=>new DOMException("","IndexSizeError"),ie=a=>{var b;a.getChannelData=(b=a.getChannelData,c=>{try{return b.call(a,c)}catch(d){if(12===d.code)throw id();throw d}})},ig=a=>hP.has(a),ih=a=>"playbackRate"in a,ii=a=>"frequency"in a&&"gain"in a,ij=a=>"offset"in a,ik=a=>!("frequency"in a)&&"gain"in a,il=a=>"detune"in a&&"frequency"in a,im=a=>"pan"in a,io=a=>h3(hQ,a),ip=a=>h3(hS,a),iq=(a,b)=>{let{activeInputs:c}=io(a);c.forEach(c=>c.forEach(([c])=>{b.includes(a)||iq(c,[...b,a])}));let d=ih(a)?[a.playbackRate]:h8(a)?Array.from(a.parameters.values()):ii(a)?[a.Q,a.detune,a.frequency,a.gain]:ij(a)?[a.offset]:ik(a)?[a.gain]:il(a)?[a.detune,a.frequency]:im(a)?[a.pan]:[];for(let e of d){let f=ip(e);void 0!==f&&f.activeInputs.forEach(([a])=>iq(a,b))}ig(a)&&h9(a)},ir=a=>{iq(a.destination,[])},is=a=>{let b=new WeakMap,c=async(c,d)=>{let e=d.destination;return b.set(d,e),await a(c,d,e),e};return{render(a,d){let e=b.get(d);return void 0!==e?Promise.resolve(e):c(a,d)}}},it=a=>"context"in a,iu=a=>it(a[0]),iv=(a,b,c,d)=>{for(let e of a)if(c(e)){if(d)return!1;throw Error("The set contains at least one similar element.")}return a.add(b),!0},iw=(a,b,[c,d],e)=>{iv(a,[b,c,d],a=>a[0]===b&&a[1]===c,e)},ix=(a,[b,c,d],e)=>{let f=a.get(b);void 0===f?a.set(b,new Set([[c,d]])):iv(f,[c,d],a=>a[0]===c,e)},iy=a=>"inputs"in a,iz=(a,b,c,d)=>{if(iy(b)){let e=b.inputs[d];return a.connect(e,c,0),[e,c,0]}return a.connect(b,c,d),[b,c,d]},iA=(a,b,c)=>{for(let d of a)if(d[0]===b&&d[1]===c)return a.delete(d),d;return null},iB=(a,b,c)=>h4(a,a=>a[0]===b&&a[1]===c),iC=(a,b)=>{let c=h6(a);if(!c.delete(b))throw Error("Missing the expected event listener.")},iD=(a,b,c)=>{let d=h3(a,b),e=h4(d,a=>a[0]===c);return 0===d.size&&a.delete(b),e},iE=(a,b,c,d)=>{iy(b)?a.disconnect(b.inputs[d],c,0):a.disconnect(b,c,d)},iF=a=>h3(hR,a),iG=a=>h3(hT,a),iH=a=>hW.has(a),iI=a=>!hP.has(a),iJ=(a,b)=>new Promise(c=>{if(null!==b)c(!0);else{let d=a.createScriptProcessor(256,1,1),e=a.createGain(),f=a.createBuffer(1,2,44100),g=f.getChannelData(0);g[0]=1,g[1]=1;let h=a.createBufferSource();h.buffer=f,h.loop=!0,h.connect(d).connect(a.destination),h.connect(e),h.disconnect(e),d.onaudioprocess=b=>{let e=b.inputBuffer.getChannelData(0);Array.prototype.some.call(e,a=>1===a)?c(!0):c(!1),h.stop(),d.onaudioprocess=null,h.disconnect(d),d.disconnect(a.destination)},h.start()}}),iK=(a,b)=>{let c=new Map;for(let d of a)for(let e of d){let f=c.get(e);c.set(e,void 0===f?1:f+1)}c.forEach((a,c)=>b(c,a))},iL=a=>"context"in a,iM=(a,b,c,d)=>{let{activeInputs:e,passiveInputs:f}=ip(b),{outputs:g}=io(a),h=h6(a),i=g=>{let h=iF(a),i=iG(b);if(g){let j=iD(f,a,c);iw(e,a,j,!1),d||iH(a)||h.connect(i,c)}else{let k=iB(e,a,c);ix(f,k,!1),d||iH(a)||h.disconnect(i,c)}};return!!iv(g,[b,c],a=>a[0]===b&&a[1]===c,!0)&&(h.add(i),ig(a)?iw(e,a,[c,i],!0):ix(f,[a,c,i],!0),!0)},iN=(a,b,c,d)=>{let{activeInputs:e,passiveInputs:f}=io(b),g=iA(e[d],a,c);if(null===g){let h=h5(f,a,c,d);return[h[2],!1]}return[g[2],!0]},iO=(a,b,c)=>{let{activeInputs:d,passiveInputs:e}=ip(b),f=iA(d,a,c);if(null===f){let g=iD(e,a,c);return[g[1],!1]}return[f[2],!0]},iP=(a,b,c,d,e)=>{let[f,g]=iN(a,c,d,e);if(null===f||(iC(a,f),!g||b||iH(a)||iE(iF(a),iF(c),d,e)),ig(c)){let{activeInputs:h}=io(c);ia(c,h)}},iQ=(a,b,c,d)=>{let[e,f]=iO(a,c,d);null===e||(iC(a,e),!f||b||iH(a)||iF(a).disconnect(iG(c),d))},iR=(a,b)=>{let c=io(a),d=[];for(let e of c.outputs)iu(e)?iP(a,b,...e):iQ(a,b,...e),d.push(e[0]);return c.outputs.clear(),d},iS=(a,b,c)=>{let d=io(a),e=[];for(let f of d.outputs)f[1]===c&&(iu(f)?iP(a,b,...f):iQ(a,b,...f),e.push(f[0]),d.outputs.delete(f));return e},iT=(a,b,c,d,e)=>{let f=io(a);return Array.from(f.outputs).filter(a=>a[0]===c&&(void 0===d||a[1]===d)&&(void 0===e||a[2]===e)).map(c=>(iu(c)?iP(a,b,...c):iQ(a,b,...c),f.outputs.delete(c),c[0]))},iU=a=>({replay(b){for(let c of a)if("exponentialRampToValue"===c.type){let{endTime:d,value:e}=c;b.exponentialRampToValueAtTime(e,d)}else if("linearRampToValue"===c.type){let{endTime:f,value:g}=c;b.linearRampToValueAtTime(g,f)}else if("setTarget"===c.type){let{startTime:h,target:i,timeConstant:j}=c;b.setTargetAtTime(i,h,j)}else if("setValue"===c.type){let{startTime:k,value:l}=c;b.setValueAtTime(l,k)}else if("setValueCurve"===c.type){let{duration:m,startTime:n,values:o}=c;b.setValueCurveAtTime(o,n,m)}else throw Error("Can't apply an unknown automation.")}});class iV{constructor(a){this._map=new Map(a)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(a,b=null){return this._map.forEach((c,d)=>a.call(b,c,d,this))}get(a){return this._map.get(a)}has(a){return this._map.has(a)}keys(){return this._map.keys()}values(){return this._map.values()}}function iW(a,b,c,d,e){if("function"==typeof a.copyFromChannel)0===b[c].byteLength&&(b[c]=new Float32Array(128)),a.copyFromChannel(b[c],d,e);else{let f=a.getChannelData(d);if(0===b[c].byteLength)b[c]=f.slice(e,e+128);else{let g=new Float32Array(f.buffer,e*Float32Array.BYTES_PER_ELEMENT,128);b[c].set(g)}}}let iX=(a,b,c,d,e)=>{"function"==typeof a.copyToChannel?0!==b[c].byteLength&&a.copyToChannel(b[c],d,e):0!==b[c].byteLength&&a.getChannelData(d).set(b[c],e)},iY=(a,b)=>{let c=[];for(let d=0;d<a;d+=1){let e=[],f="number"==typeof b?b:b[d];for(let g=0;g<f;g+=1)e.push(new Float32Array(128));c.push(e)}return c},iZ=(a,b)=>{let c=h3(hY,a),d=iF(b);return h3(c,d)},i$=async(a,b,c,d,e,f,g)=>{let h=null===b?128*Math.ceil(a.context.length/128):b.length,i=d.channelCount*d.numberOfInputs,j=e.reduce((a,b)=>a+b,0),k=0===j?null:c.createBuffer(j,h,c.sampleRate);if(void 0===f)throw Error("Missing the processor constructor.");let l=io(a),m=await iZ(c,a),n=iY(d.numberOfInputs,d.channelCount),o=iY(d.numberOfOutputs,e),p=Array.from(a.parameters.keys()).reduce((a,b)=>({...a,[b]:new Float32Array(128)}),{});for(let q=0;q<h;q+=128){if(d.numberOfInputs>0&&null!==b)for(let r=0;r<d.numberOfInputs;r+=1)for(let s=0;s<d.channelCount;s+=1)iW(b,n[r],s,s,q);void 0!==f.parameterDescriptors&&null!==b&&f.parameterDescriptors.forEach(({name:a},c)=>{iW(b,p,a,i+c,q)});for(let t=0;t<d.numberOfInputs;t+=1)for(let u=0;u<e[t];u+=1)0===o[t][u].byteLength&&(o[t][u]=new Float32Array(128));try{let v=n.map((a,b)=>0===l.activeInputs[b].size?[]:a),w=g(q/c.sampleRate,c.sampleRate,()=>m.process(v,o,p));if(null!==k)for(let x=0,y=0;x<d.numberOfOutputs;x+=1){for(let z=0;z<e[x];z+=1)iX(k,o[x],z,y+z,q);y+=e[x]}if(!w)break}catch(A){a.dispatchEvent(new ErrorEvent("processorerror",{colno:A.colno,filename:A.filename,lineno:A.lineno,message:A.message}));break}}return k},i_=()=>new DOMException("","DataCloneError"),i0=a=>{let{port1:b,port2:c}=new MessageChannel;return new Promise(d=>{let e=()=>{c.onmessage=null,b.close(),c.close(),d()};c.onmessage=()=>e();try{b.postMessage(a,[a])}finally{e()}})},i1=a=>"delayTime"in a,i2=(a,b,c)=>{let d=b[c];if(void 0===d)throw a();return d},i3=()=>new DOMException("","EncodingError"),i4=()=>new DOMException("","InvalidStateError"),i5=()=>new DOMException("","InvalidAccessError"),i6=(a,b,c,d,e,f,g,h,i,j,k)=>{let l=j.length,m=h;for(let n=0;n<l;n+=1){let o=c[0]*j[n];for(let p=1;p<e;p+=1){let q=m-p&i-1;o+=c[p]*f[q],o-=a[p]*g[q]}for(let r=e;r<d;r+=1)o+=c[r]*f[m-r&i-1];for(let s=e;s<b;s+=1)o-=a[s]*g[m-s&i-1];f[m]=j[n],g[m]=o,m=m+1&i-1,k[n]=o}return m},i7=(a,b,c,d)=>{let e=c instanceof Float64Array?c:new Float64Array(c),f=d instanceof Float64Array?d:new Float64Array(d),g=e.length,h=f.length,i=Math.min(g,h);if(1!==e[0]){for(let j=0;j<g;j+=1)f[j]/=e[0];for(let k=1;k<h;k+=1)e[k]/=e[0]}let l=new Float32Array(32),m=new Float32Array(32),n=b.createBuffer(a.numberOfChannels,a.length,a.sampleRate),o=a.numberOfChannels;for(let p=0;p<o;p+=1){let q=a.getChannelData(p),r=n.getChannelData(p);l.fill(0),m.fill(0),i6(e,g,f,h,i,l,m,0,32,q,r)}return n},i8=async(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)=>{if(a(b,b)&&a(c,c)&&a(e,e)&&a(f,f)&&a(h,h)&&a(i,i)&&a(j,j)&&a(k,k)&&a(l,l)&&a(m,m)&&a(n,n)){let q=await Promise.all([a(d,d),a(g,g),a(o,o),a(p,p)]);return q.every(a=>a)}return!1},i9=a=>{let b=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let c=a.decodeAudioData(b.buffer,()=>{});if(void 0===c)return!1;return c.catch(()=>{}),!0}catch{}return!1},ja=(a,b,c)=>{let d=b[c];void 0!==d&&d!==a[c]&&(a[c]=d)},jb=(a,b)=>{ja(a,b,"channelCount"),ja(a,b,"channelCountMode"),ja(a,b,"channelInterpretation")},jc=a=>"function"==typeof a.getFloatTimeDomainData,jd=a=>{a.getFloatTimeDomainData=b=>{let c=new Uint8Array(b.length);a.getByteTimeDomainData(c);let d=Math.max(c.length,a.fftSize);for(let e=0;e<d;e+=1)b[e]=(c[e]-128)*.0078125;return b}},je=(a,b,c)=>{let d=b[c];void 0!==d&&d!==a[c].value&&(a[c].value=d)},jf=a=>{var b;let c;a.start=(b=a.start,c=!1,(d=0,e=0,f)=>{if(c)throw i4();b.call(a,d,e,f),c=!0})},jg=a=>{var b;a.start=(b=a.start,(c=0,d=0,e)=>{if("number"==typeof e&&e<0||d<0||c<0)throw RangeError("The parameters can't be negative.");b.call(a,c,d,e)})},jh=a=>{var b;a.stop=(b=a.stop,(c=0)=>{if(c<0)throw RangeError("The parameter can't be negative.");b.call(a,c)})},ji=a=>{let{port1:b}=new MessageChannel;try{b.postMessage(a)}finally{b.close()}},jj=(a,b)=>null===a?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(a*b))))),jk=a=>new Promise((b,c)=>{let{port1:d,port2:e}=new MessageChannel;d.onmessage=({data:a})=>{d.close(),e.close(),b(a)},d.onmessageerror=({data:a})=>{d.close(),e.close(),c(a)},e.postMessage(a)}),jl=async(a,b)=>{let c=await jk(b);return new a(c)},jm=(a,b,c,d)=>{let e=hY.get(a);void 0===e&&(e=new WeakMap,hY.set(a,e));let f=jl(c,d);return e.set(b,f),f},jn=(a,b)=>{let c=a.createBiquadFilter();return jb(c,b),je(c,b,"Q"),je(c,b,"detune"),je(c,b,"frequency"),je(c,b,"gain"),ja(c,b,"type"),c},jo=a=>{let b=a.numberOfOutputs;Object.defineProperty(a,"channelCount",{get:()=>b,set:a=>{if(a!==b)throw i4()}}),Object.defineProperty(a,"channelCountMode",{get:()=>"explicit",set:a=>{if("explicit"!==a)throw i4()}}),Object.defineProperty(a,"channelInterpretation",{get:()=>"discrete",set:a=>{if("discrete"!==a)throw i4()}})},jp=(a,b)=>{let c=a.createChannelSplitter(b.numberOfOutputs);return jb(c,b),jo(c),c},jq=(a,b)=>(a.connect=b.connect.bind(b),a.disconnect=b.disconnect.bind(b),a),jr=(a,b)=>{let c=a.createDelay(b.maxDelayTime);return jb(c,b),je(c,b,"delayTime"),c},js=(a,b)=>{let c=a.createGain();return jb(c,b),je(c,b,"gain"),c};function jt(a,b){let c=b[0]*b[0]+b[1]*b[1];return[(a[0]*b[0]+a[1]*b[1])/c,(a[1]*b[0]-a[0]*b[1])/c]}function ju(a,b){return[a[0]*b[0]-a[1]*b[1],a[0]*b[1]+a[1]*b[0]]}function jv(a,b){let c=[0,0];for(let d=a.length-1;d>=0;d-=1)c=ju(c,b),c[0]+=a[d];return c}let jw=(a,b)=>a.createMediaElementSource(b.mediaElement),jx=(a,b)=>{let c=a.createMediaStreamDestination();return jb(c,b),1===c.numberOfOutputs&&Object.defineProperty(c,"numberOfOutputs",{get:()=>0}),c},jy=(a,{mediaStream:b})=>{let c=b.getAudioTracks();c.sort((a,b)=>a.id<b.id?-1:a.id>b.id?1:0);let d=c.slice(0,1),e=a.createMediaStreamSource(new MediaStream(d));return Object.defineProperty(e,"mediaStream",{value:b}),e},jz=(a,b,c,d)=>a.createScriptProcessor(b,c,d),jA=()=>new DOMException("","NotSupportedError"),jB=a=>()=>{if(null===a)return!1;let b=new a(1,1,44100),c=b.createBuffer(1,1,44100);if(void 0===c.copyToChannel)return!0;let d=new Float32Array(2);try{c.copyFromChannel(d,0,0)}catch{return!1}return!0},jC=a=>()=>{if(null===a)return!1;if(void 0!==a.prototype&& void 0!==a.prototype.close)return!0;let b=new a,c=void 0!==b.close;try{b.close()}catch{}return c},jD=a=>()=>{if(null===a)return Promise.resolve(!1);let b=new a(1,1,44100);return new Promise(a=>{let c=!0,d=d=>{c&&(c=!1,b.startRendering(),a(d instanceof TypeError))},e;try{e=b.decodeAudioData(null,()=>{},d)}catch(f){d(f)}void 0!==e&&e.catch(d)})},jE=a=>()=>{if(null===a)return!1;let b;try{b=new a({latencyHint:"balanced"})}catch{return!1}return b.close(),!0},jF=a=>()=>{if(null===a)return!1;let b=new a(1,1,44100),c=b.createGain(),d=c.connect(c)===c;return c.disconnect(c),d},jG=(a,b)=>async()=>{if(null===a)return!0;if(null===b)return!1;let c=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),d=new MessageChannel,e=new b(1,128,44100),f=URL.createObjectURL(c),g=!1;try{await e.audioWorklet.addModule(f);let h=new a(e,"a",{numberOfOutputs:0}),i=e.createOscillator();await new Promise(a=>{h.port.onmessage=()=>a(),h.port.postMessage(d.port2,[d.port2])}),h.port.onmessage=()=>g=!0,i.connect(h),i.start(0),await e.startRendering(),g=await new Promise(a=>{d.port1.onmessage=({data:b})=>a(1===b),d.port1.postMessage(0)})}catch{}finally{d.port1.close(),URL.revokeObjectURL(f)}return g},jH=a=>()=>{if(null===a)return!1;let b=new a(1,1,44100),c=b.createChannelMerger();if("max"===c.channelCountMode)return!0;try{c.channelCount=2}catch{return!0}return!1},jI=a=>()=>{if(null===a)return!1;let b=new a(1,1,44100);if(void 0===b.createConstantSource)return!0;let c=b.createConstantSource();return c.offset.maxValue!==Number.POSITIVE_INFINITY},jJ=a=>()=>{if(null===a)return!1;let b=new a(1,1,44100),c=b.createConvolver();c.buffer=b.createBuffer(1,1,b.sampleRate);try{c.buffer=b.createBuffer(1,1,b.sampleRate)}catch{return!1}return!0},jK=a=>()=>{if(null===a)return!1;let b=new a(1,1,44100),c=b.createConvolver();try{c.channelCount=1}catch{return!1}return!0},jL=a=>()=>null!==a&&a.hasOwnProperty("isSecureContext"),jM=a=>()=>{if(null===a)return!1;let b=new a;try{return b.createMediaStreamSource(new MediaStream),!1}catch(c){return!0}finally{b.close()}},jN=a=>()=>{if(null===a)return Promise.resolve(!1);let b=new a(1,1,44100);if(void 0===b.createStereoPanner|| void 0===b.createConstantSource)return Promise.resolve(!0);let c=b.createConstantSource(),d=b.createStereoPanner();return c.channelCount=1,c.offset.value=1,d.channelCount=1,c.start(),c.connect(d).connect(b.destination),b.startRendering().then(a=>1!==a.getChannelData(0)[0])},jO=()=>new DOMException("","UnknownError"),jP=(a,b,c)=>void 0===a.copyFromChannel?a.getChannelData(c)[0]:(a.copyFromChannel(b,c),b[0]),jQ=a=>{if(null===a)return!1;let b=a.length;return b%2!=0?0!==a[Math.floor(b/2)]:a[b/2-1]+a[b/2]!==0},jR=(a,b,c,d)=>{let e=a;for(;!e.hasOwnProperty(b);)e=Object.getPrototypeOf(e);let{get:f,set:g}=Object.getOwnPropertyDescriptor(e,b);Object.defineProperty(a,b,{get:c(f),set:d(g)})},jS=a=>({...a,outputChannelCount:void 0!==a.outputChannelCount?a.outputChannelCount:1===a.numberOfInputs&&1===a.numberOfOutputs?[a.channelCount]:Array.from({length:a.numberOfOutputs},()=>1)}),jT=a=>({...a,channelCount:a.numberOfOutputs}),jU=a=>{let{imag:b,real:c}=a;return void 0===b?void 0===c?{...a,imag:[0,0],real:[0,0]}:{...a,imag:Array.from(c,()=>0),real:c}:void 0===c?{...a,imag:b,real:Array.from(b,()=>0)}:{...a,imag:b,real:c}},jV=(a,b,c)=>{try{a.setValueAtTime(b,c)}catch(d){if(9!==d.code)throw d;jV(a,b,c+1e-7)}},jW=a=>{let b=a.createBufferSource();b.start();try{b.start()}catch{return!0}return!1},jX=a=>{let b=a.createBufferSource(),c=a.createBuffer(1,1,44100);b.buffer=c;try{b.start(0,1)}catch{return!1}return!0},jY=a=>{let b=a.createBufferSource();b.start();try{b.stop()}catch{return!1}return!0},jZ=a=>{let b=a.createOscillator();try{b.start(-1)}catch(c){return c instanceof RangeError}return!1},j$=a=>{let b=a.createBuffer(1,1,44100),c=a.createBufferSource();c.buffer=b,c.start(),c.stop();try{return c.stop(),!0}catch{return!1}},j_=a=>{let b=a.createOscillator();try{b.stop(-1)}catch(c){return c instanceof RangeError}return!1},j0=a=>{let{port1:b,port2:c}=new MessageChannel;try{b.postMessage(a)}finally{b.close(),c.close()}},j1=()=>{try{new DOMException}catch{return!1}return!0},j2=()=>new Promise(a=>{let b=new ArrayBuffer(0),{port1:c,port2:d}=new MessageChannel;c.onmessage=({data:b})=>a(null!==b),d.postMessage(b,[b])}),j3=a=>{var b;a.start=(b=a.start,(c=0,d=0,e)=>{let f=a.buffer,g=null===f?d:Math.min(f.duration,d);null!==f&&g>f.duration-.5/a.context.sampleRate?b.call(a,c,0,0):b.call(a,c,g,e)})},j4=(a,b)=>{var c,d;let e=b.createGain();a.connect(e);let f=(c=a.disconnect,()=>{c.call(a,e),a.removeEventListener("ended",f)});a.addEventListener("ended",f),jq(a,e);let g;a.stop=(d=a.stop,g=!1,(b=0)=>{if(g)try{d.call(a,b)}catch{e.gain.setValueAtTime(0,b)}else d.call(a,b),g=!0})},j5=(a,b)=>c=>{let d={value:a};return(Object.defineProperties(c,{currentTarget:d,target:d}),"function"==typeof b)?b.call(a,c):b.handleEvent.call(a,c)},j6=(d=iv,(a,b,[c,e,f],g)=>{d(a[e],[b,c,f],a=>a[0]===b&&a[1]===c,g)}),j7=(e=iv,(a,b,[c,d,f],g)=>{let h=a.get(c);void 0===h?a.set(c,new Set([[d,b,f]])):e(h,[d,b,f],a=>a[0]===d&&a[1]===b,g)}),j8=(f=h4,(a,b,c,d)=>f(a[d],a=>a[0]===b&&a[1]===c)),j9=new WeakMap,ka=(g=j9,a=>{var b;return null!==(b=g.get(a))&& void 0!==b?b:0}),kb=(h=new Map,i=new WeakMap,(a,b)=>{let c=i.get(a);if(void 0!==c)return c;let d=h.get(a);if(void 0!==d)return d;try{let e=b();if(e instanceof Promise)return h.set(a,e),e.catch(()=>!1).then(b=>(h.delete(a),i.set(a,b),b));return i.set(a,e),e}catch{return i.set(a,!1),!1}}),kc="undefined"==typeof window?null:window,kd=(j=kb,k=id,(a,b)=>{let c=a.createAnalyser();if(jb(c,b),!(b.maxDecibels>b.minDecibels))throw k();return ja(c,b,"fftSize"),ja(c,b,"maxDecibels"),ja(c,b,"minDecibels"),ja(c,b,"smoothingTimeConstant"),j(jc,()=>jc(c))||jd(c),c}),ke=(l=io,a=>{let b=l(a);if(null===b.renderer)throw Error("Missing the renderer of the given AudioNode in the audio graph.");return b.renderer}),kf=(m=io,n=ke,o=iH,async(a,b,c)=>{let d=m(a);await Promise.all(d.activeInputs.map((d,e)=>Array.from(d).map(async([d,f])=>{let g=n(d),h=await g.render(d,b),i=a.context.destination;o(d)||a===i&&o(a)||h.connect(c,f,e)})).reduce((a,b)=>[...a,...b],[]))}),kg=(p=kd,q=iF,r=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=q(b),e=ib(d,c);if(!e){let f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,fftSize:d.fftSize,maxDecibels:d.maxDecibels,minDecibels:d.minDecibels,smoothingTimeConstant:d.smoothingTimeConstant};d=p(c,f)}return a.set(c,d),await r(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),kh=(s=hU,a=>{let b=s.get(a);if(void 0===b)throw i4();return b}),ki=null===(t=kc)?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,kj=(u=ki,a=>null!==u&&a instanceof u),kk=new WeakMap,kl=class{constructor(a){this._nativeEventTarget=a,this._listeners=new WeakMap}addEventListener(a,b,c){if(null!==b){let d=this._listeners.get(b);void 0===d&&(d=(v=j5)(this,b),"function"==typeof b&&this._listeners.set(b,d)),this._nativeEventTarget.addEventListener(a,d,c)}}dispatchEvent(a){return this._nativeEventTarget.dispatchEvent(a)}removeEventListener(a,b,c){let d=null===b?void 0:this._listeners.get(b);this._nativeEventTarget.removeEventListener(a,void 0===d?null:d,c)}},km=null===(w=kc)?null:w.hasOwnProperty("AudioContext")?w.AudioContext:w.hasOwnProperty("webkitAudioContext")?w.webkitAudioContext:null,kn=(x=km,a=>null!==x&&a instanceof x),ko=(y=kc,a=>null!==y&&"function"==typeof y.AudioNode&&a instanceof y.AudioNode),kp=(z=kc,a=>null!==z&&"function"==typeof z.AudioParam&&a instanceof z.AudioParam),kq=null===(A=kc)?null:A.hasOwnProperty("AudioWorkletNode")?A.AudioWorkletNode:null,kr=(T=(B=hQ,(a,b,c)=>{let d=[];for(let e=0;e<c.numberOfInputs;e+=1)d.push(new Set);B.set(a,{activeInputs:d,outputs:new Set,passiveInputs:new WeakMap,renderer:b})}),U=((a,b,c,d,e,f,g,h,i,j,k,l,m)=>{let n=new WeakMap;return(o,p,q,r,s)=>{let{activeInputs:t,passiveInputs:u}=f(p),{outputs:v}=f(o),w=h(o),x=f=>{let h=i(p),j=i(o);if(f){let v=h5(u,o,q,r);a(t,o,v,!1),s||l(o)||c(j,h,q,r),m(p)&&h7(p)}else{let w=d(t,o,q,r);b(u,r,w,!1),s||l(o)||e(j,h,q,r);let x=g(p);if(0===x)k(p)&&ia(p,t);else{let y=n.get(p);void 0!==y&&clearTimeout(y),n.set(p,setTimeout(()=>{k(p)&&ia(p,t)},1e3*x))}}};return!!j(v,[p,q,r],a=>a[0]===p&&a[1]===q&&a[2]===r,!0)&&(w.add(x),k(o)?a(t,o,[q,r,x],!0):b(u,r,[o,q,x],!0),!0)}})(j6,j7,iz,j8,iE,io,ka,h6,iF,iv,ig,iH,iI),V=kb,W=(C=hW,D=iE,E=io,F=iF,G=iG,H=ig,a=>(b,c)=>{let d=C.get(b);if(void 0===d){if(!a&&H(b)){let e=F(b),{outputs:f}=E(b);for(let g of f)if(iu(g)){let h=F(g[0]);D(e,h,g[1],g[2])}else{let i=G(g[0]);e.disconnect(i,g[1])}}C.set(b,c)}else C.set(b,d+c)}),X=id,Y=i5,Z=jA,$=(I=iz,J=hW,K=io,L=iF,M=iG,N=kh,O=ig,P=kj,(a,b)=>{let c=J.get(a);if(void 0===c)throw Error("Missing the expected cycle count.");let d=N(a.context),e=P(d);if(c===b){if(J.delete(a),!e&&O(a)){let f=L(a),{outputs:g}=K(a);for(let h of g)if(iu(h)){let i=L(h[0]);I(f,i,h[1],h[2])}else{let j=M(h[0]);f.connect(j,h[1])}}}else J.set(a,c-b)}),aa=(Q=kk,R=io,S=h3,function a(b,c){let d=it(c)?c:S(Q,c);if(i1(d))return[];if(b[0]===d)return[b];if(b.includes(d))return[];let{outputs:e}=R(d);return Array.from(e).map(c=>a([...b,d],c[0])).reduce((a,b)=>a.concat(b),[])}),ab=kl,ac=kh,ad=kn,ae=ko,af=kp,ag=kj,class extends ab{constructor(a,b,c,d){super(c),this._context=a,this._nativeAudioNode=c;let e=ac(a);ad(e)&& !0!==V(iJ,()=>iJ(e,ah=kq))&&(a=>{var b,c;let d=new Map;a.connect=(b=a.connect.bind(a),(a,c=0,e=0)=>{let f=iL(a)?b(a,c,e):b(a,c),g=d.get(a);return void 0===g?d.set(a,[{input:e,output:c}]):g.every(a=>a.input!==e||a.output!==c)&&g.push({input:e,output:c}),f}),a.disconnect=(c=a.disconnect,(b,e,f)=>{if(c.apply(a),void 0===b)d.clear();else if("number"==typeof b)for(let[g,h]of d){let i=h.filter(a=>a.output!==b);0===i.length?d.delete(g):d.set(g,i)}else if(d.has(b)){if(void 0===e)d.delete(b);else{let j=d.get(b);if(void 0!==j){let k=j.filter(a=>a.output!==e&&(a.input!==f|| void 0===f));0===k.length?d.delete(b):d.set(b,k)}}}for(let[l,m]of d)m.forEach(b=>{iL(l)?a.connect(l,b.output,b.input):a.connect(l,b.output)})})})(c),hR.set(this,c),hV.set(this,new Set),"closed"!==a.state&&b&&h7(this),T(this,d,c)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(a){this._nativeAudioNode.channelCount=a}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(a){this._nativeAudioNode.channelCountMode=a}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(a){this._nativeAudioNode.channelInterpretation=a}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(a,b=0,c=0){if(b<0||b>=this._nativeAudioNode.numberOfOutputs)throw X();let d=ac(this._context),e=ag(d);if(ae(a)||af(a))throw Y();if(it(a)){let f=iF(a);try{let g=iz(this._nativeAudioNode,f,b,c),h=iI(this);(e||h)&&this._nativeAudioNode.disconnect(...g),"closed"!==this.context.state&&!h&&iI(a)&&h7(a)}catch(i){if(12===i.code)throw Y();throw i}let j=U(this,a,b,c,e);if(j){let k=aa([this],a);iK(k,W(e))}return a}let l=iG(a);if("playbackRate"===l.name&&1024===l.maxValue)throw Z();try{this._nativeAudioNode.connect(l,b),(e||iI(this))&&this._nativeAudioNode.disconnect(l,b)}catch(m){if(12===m.code)throw Y();throw m}let n=iM(this,a,b,e);if(n){let o=aa([this],a);iK(o,W(e))}}disconnect(a,b,c){let d,e=ac(this._context),f=ag(e);if(void 0===a)d=iR(this,f);else if("number"==typeof a){if(a<0||a>=this.numberOfOutputs)throw X();d=iS(this,f,a)}else{if(void 0!==b&&(b<0||b>=this.numberOfOutputs)||it(a)&& void 0!==c&&(c<0||c>=a.numberOfInputs))throw X();if(0===(d=iT(this,f,a,b,c)).length)throw Y()}for(let g of d){let h=aa([this],g);iK(h,$)}}}),ks=(ai=kr,aj=kg,ak=id,al=kd,class extends ai{constructor(a,b){let c=(am=kh)(a),d=al(c,{channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8,...b}),e=kj(c)?aj():null;super(a,!1,d,e),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){let b=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=b,ak()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){let b=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=b,ak()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}}),kt=new WeakSet,ku=null===(ao=kc)?null:ao.hasOwnProperty("AudioBuffer")?ao.AudioBuffer:null,kv=(ap=new Uint32Array(1),a=>(ap[0]=a,ap[0])),kw=(aq=kv,ar=id,a=>{a.copyFromChannel=(b,c,d=0)=>{let e=aq(d),f=aq(c);if(f>=a.numberOfChannels)throw ar();let g=a.length,h=a.getChannelData(f),i=b.length;for(let j=e<0?-e:0;j+e<g&&j<i;j+=1)b[j]=h[j+e]},a.copyToChannel=(b,c,d=0)=>{let e=aq(d),f=aq(c);if(f>=a.numberOfChannels)throw ar();let g=a.length,h=a.getChannelData(f),i=b.length;for(let j=e<0?-e:0;j+e<g&&j<i;j+=1)h[j+e]=b[j]}}),kx=(as=kv,a=>{var b,c;a.copyFromChannel=(b=a.copyFromChannel,(c,d,e=0)=>{let f=as(e),g=as(d);if(f<a.length)return b.call(a,c,g,f)}),a.copyToChannel=(c=a.copyToChannel,(b,d,e=0)=>{let f=as(e),g=as(d);if(f<a.length)return c.call(a,b,g,f)})}),ky,kz=(au=kt,av=kb,aw=jA,ax=ku,ay=ki,az=(at=ku,()=>{if(null===at)return!1;try{new at({length:1,sampleRate:44100})}catch{return!1}return!0}),aA=kw,ky=null,class a{constructor(a){if(null===ay)throw Error("Missing the native OfflineAudioContext constructor.");let{length:b,numberOfChannels:c,sampleRate:d}={numberOfChannels:1,...a};null===ky&&(ky=new ay(1,1,44100));let e=null!==ax&&av(az,az)?new ax({length:b,numberOfChannels:c,sampleRate:d}):ky.createBuffer(c,b,d);if(0===e.numberOfChannels)throw aw();return"function"!=typeof e.copyFromChannel?(aA(e),ie(e)):av(ic,()=>ic(e))||(aB=kx)(e),au.add(e),e}static[Symbol.hasInstance](b){return null!==b&&"object"==typeof b&&Object.getPrototypeOf(b)===a.prototype||au.has(b)}}),kA=(aC=js,(a,b)=>{let c=aC(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});b.connect(c).connect(a.destination);let d=()=>{b.removeEventListener("ended",d),b.disconnect(c),c.disconnect()};b.addEventListener("ended",d)}),kB=(aD=ke,aE=ip,aF=iH,async(a,b,c)=>{let d=aE(a);await Promise.all(Array.from(d.activeInputs).map(async([a,d])=>{let e=aD(a),f=await e.render(a,b);aF(a)||f.connect(c,d)}))}),kC=(aG=kB,(a,b,c)=>aG(b,a,c)),kD=(aI=kA,aJ=kb,aK=jW,aL=jX,aM=jY,aN=jZ,aO=j$,aP=j_,aQ=j3,aR=(aH=jR,(a,b)=>{let c=b.createBuffer(1,1,44100);null===a.buffer&&(a.buffer=c),aH(a,"buffer",b=>()=>{let d=b.call(a);return d===c?null:d},b=>d=>b.call(a,null===d?c:d))}),aS=j4,(a,b)=>{let c=a.createBufferSource();return jb(c,b),je(c,b,"playbackRate"),ja(c,b,"buffer"),ja(c,b,"loop"),ja(c,b,"loopEnd"),ja(c,b,"loopStart"),aJ(aK,()=>aK(a))||jf(c),aJ(aL,()=>aL(a))||aQ(c),aJ(aM,()=>aM(a))||aR(c,a),aJ(aN,()=>aN(a))||jg(c),aJ(aO,()=>aO(a))||aS(c,a),aJ(aP,()=>aP(a))||jh(c),aI(a,c),c}),kE=(aU=(aT=ip,a=>{let b=aT(a);if(null===b.renderer)throw Error("Missing the renderer of the given AudioParam in the audio graph.");return b.renderer}),aV=kB,(a,b,c)=>{let d=aU(b);return d.replay(c),aV(b,a,c)}),kF=(aW=kC,aX=kD,aY=iF,aZ=kE,a$=kf,()=>{let a=new WeakMap,b=null,c=null,d=async(d,e)=>{let f=aY(d),g=ib(f,e);if(!g){let h={buffer:f.buffer,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,loop:f.loop,loopEnd:f.loopEnd,loopStart:f.loopStart,playbackRate:f.playbackRate.value};f=aX(e,h),null!==b&&f.start(...b),null!==c&&f.stop(c)}return a.set(e,f),g?await aW(e,d.playbackRate,f.playbackRate):await aZ(e,d.playbackRate,f.playbackRate),await a$(d,e,f),f};return{set start(value){b=value},set stop(value){c=value},render(b,c){let e=a.get(c);return void 0!==e?Promise.resolve(e):d(b,c)}}}),kG=(a0=(a_=hS,(a,b)=>{a_.set(a,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:b})}),a1=kk,a2=hT,a3=iU,a4=hN.createCancelAndHoldAutomationEvent,a5=hN.createCancelScheduledValuesAutomationEvent,a6=hN.createExponentialRampToValueAutomationEvent,a7=hN.createLinearRampToValueAutomationEvent,a8=hN.createSetTargetAutomationEvent,a9=hN.createSetValueAutomationEvent,ba=hN.createSetValueCurveAutomationEvent,bb=km,bc=jV,(a,b,c,d=null,e=null)=>{let f=new hN.AutomationEventList(c.defaultValue),g=b?a3(f):null,h={get defaultValue(){return c.defaultValue},get maxValue(){return null===d?c.maxValue:d},get minValue(){return null===e?c.minValue:e},get value(){return c.value},set value(value){c.value=value,h.setValueAtTime(value,a.context.currentTime)},cancelAndHoldAtTime(b){if("function"==typeof c.cancelAndHoldAtTime)null===g&&f.flush(a.context.currentTime),f.add(a4(b)),c.cancelAndHoldAtTime(b);else{let d=Array.from(f).pop();null===g&&f.flush(a.context.currentTime),f.add(a4(b));let e=Array.from(f).pop();c.cancelScheduledValues(b),d!==e&& void 0!==e&&("exponentialRampToValue"===e.type?c.exponentialRampToValueAtTime(e.value,e.endTime):"linearRampToValue"===e.type?c.linearRampToValueAtTime(e.value,e.endTime):"setValue"===e.type?c.setValueAtTime(e.value,e.startTime):"setValueCurve"===e.type&&c.setValueCurveAtTime(e.values,e.startTime,e.duration))}return h},cancelScheduledValues(b){return null===g&&f.flush(a.context.currentTime),f.add(a5(b)),c.cancelScheduledValues(b),h},exponentialRampToValueAtTime(b,d){if(0===b||!Number.isFinite(d)||d<0)throw RangeError();return null===g&&f.flush(a.context.currentTime),f.add(a6(b,d)),c.exponentialRampToValueAtTime(b,d),h},linearRampToValueAtTime(b,d){return null===g&&f.flush(a.context.currentTime),f.add(a7(b,d)),c.linearRampToValueAtTime(b,d),h},setTargetAtTime(b,d,e){return null===g&&f.flush(a.context.currentTime),f.add(a8(b,d,e)),c.setTargetAtTime(b,d,e),h},setValueAtTime(b,d){return null===g&&f.flush(a.context.currentTime),f.add(a9(b,d)),c.setValueAtTime(b,d),h},setValueCurveAtTime(b,d,e){let i=b instanceof Float32Array?b:new Float32Array(b);if(null!==bb&&"webkitAudioContext"===bb.name){let j=d+e,k=a.context.sampleRate,l=Math.ceil(d*k),m=Math.floor(j*k),n=m-l,o=new Float32Array(n);for(let p=0;p<n;p+=1){let q=(i.length-1)/e*((l+p)/k-d),r=Math.floor(q),s=Math.ceil(q);o[p]=r===s?i[r]:(1-(q-r))*i[r]+(1-(s-q))*i[s]}null===g&&f.flush(a.context.currentTime),f.add(ba(o,d,e)),c.setValueCurveAtTime(o,d,e);let t=m/k;t<j&&bc(h,o[o.length-1],t),bc(h,i[i.length-1],j)}else null===g&&f.flush(a.context.currentTime),f.add(ba(i,d,e)),c.setValueCurveAtTime(i,d,e);return h}};return a2.set(h,c),a1.set(h,a),a0(h,g),h}),kH=(bd=kr,be=kF,bf=kG,bg=i4,bh=kD,bi=kh,class extends bd{constructor(a,b){let c=bi(a),d={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1,...b},e=bh(c,d),f=(bj=kj)(c),g=f?be():null;super(a,!1,e,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=null!==d.buffer,this._nativeAudioBufferSourceNode=e,this._onended=null,this._playbackRate=bf(this,f,e.playbackRate,34028234663852886e22,-34028234663852886e22)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(a){if(this._nativeAudioBufferSourceNode.buffer=a,null!==a){if(this._isBufferSet)throw bg();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(a){this._nativeAudioBufferSourceNode.loop=a}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(a){this._nativeAudioBufferSourceNode.loopEnd=a}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(a){this._nativeAudioBufferSourceNode.loopStart=a}get onended(){return this._onended}set onended(a){let b="function"==typeof a?(bk=j5)(this,a):null;this._nativeAudioBufferSourceNode.onended=b;let c=this._nativeAudioBufferSourceNode.onended;this._onended=null!==c&&c===b?a:c}get playbackRate(){return this._playbackRate}start(a=0,b=0,c){if(this._nativeAudioBufferSourceNode.start(a,b,c),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===c?[a,b]:[a,b,c]),"closed"!==this.context.state){h7(this);let d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),ig(this)&&h9(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(a=0){this._nativeAudioBufferSourceNode.stop(a),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=a)}}),kI=(bn=kr,bo=is,bp=id,bq=i4,br=(bl=js,bm=jR,(a,b,c)=>{let d=a.destination;if(d.channelCount!==b)try{d.channelCount=b}catch{}c&&"explicit"!==d.channelCountMode&&(d.channelCountMode="explicit"),0===d.maxChannelCount&&Object.defineProperty(d,"maxChannelCount",{value:b});let e=bl(a,{channelCount:b,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,gain:1});return bm(e,"channelCount",a=>()=>a.call(e),a=>b=>{a.call(e,b);try{d.channelCount=b}catch(c){if(b>d.maxChannelCount)throw c}}),bm(e,"channelCountMode",a=>()=>a.call(e),a=>b=>{a.call(e,b),d.channelCountMode=b}),bm(e,"channelInterpretation",a=>()=>a.call(e),a=>b=>{a.call(e,b),d.channelInterpretation=b}),Object.defineProperty(e,"maxChannelCount",{get:()=>d.maxChannelCount}),e.connect(d),e}),bs=kh,class extends bn{constructor(a,b){let c=bs(a),d=(bt=kj)(c),e=br(c,b,d),f=d?bo(kf):null;super(a,!1,e,f),this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=e}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(a){if(this._isNodeOfNativeOfflineAudioContext)throw bq();if(a>this._nativeAudioDestinationNode.maxChannelCount)throw bp();this._nativeAudioDestinationNode.channelCount=a}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(a){if(this._isNodeOfNativeOfflineAudioContext)throw bq();this._nativeAudioDestinationNode.channelCountMode=a}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}}),kJ=(bv=kC,bw=jn,bx=iF,by=kE,bz=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=bx(b),e=ib(d,c);if(!e){let f={Q:d.Q.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,gain:d.gain.value,type:d.type};d=bw(c,f)}return a.set(c,d),e?(await bv(c,b.Q,d.Q),await bv(c,b.detune,d.detune),await bv(c,b.frequency,d.frequency),await bv(c,b.gain,d.gain)):(await by(c,b.Q,d.Q),await by(c,b.detune,d.detune),await by(c,b.frequency,d.frequency),await by(c,b.gain,d.gain)),await bz(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),kK=(bA=j9,(a,b)=>bA.set(a,b)),kL=(bB=kr,bC=kG,bD=kJ,bE=i5,bF=jn,bG=kh,class extends bB{constructor(a,b){let c=bG(a),d=bF(c,{Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass",...b}),e=(bH=kj)(c),f=e?bD():null;super(a,!1,d,f),this._Q=bC(this,e,d.Q,34028234663852886e22,-34028234663852886e22),this._detune=bC(this,e,d.detune,1200*Math.log2(34028234663852886e22),-1200*Math.log2(34028234663852886e22)),this._frequency=bC(this,e,d.frequency,a.sampleRate/2,0),this._gain=bC(this,e,d.gain,40*Math.log10(34028234663852886e22),-34028234663852886e22),this._nativeBiquadFilterNode=d,kK(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(a){this._nativeBiquadFilterNode.type=a}getFrequencyResponse(a,b,c){try{this._nativeBiquadFilterNode.getFrequencyResponse(a,b,c)}catch(d){if(11===d.code)throw bE();throw d}if(a.length!==b.length||b.length!==c.length)throw bE()}}),kM=(bJ=iv,bK=ko,(a,b,c)=>{var d,e;let f=new Set;return a.connect=(d=a.connect,(c,e=0,g=0)=>{let h=0===f.size;if(bK(c))return d.call(a,c,e,g),bJ(f,[c,e,g],a=>a[0]===c&&a[1]===e&&a[2]===g,!0),h&&b(),c;d.call(a,c,e),bJ(f,[c,e],a=>a[0]===c&&a[1]===e,!0),h&&b()}),a.disconnect=(e=a.disconnect,(b,d,g)=>{let h=f.size>0;if(void 0===b)e.apply(a),f.clear();else if("number"==typeof b)for(let i of(e.call(a,b),f))i[1]===b&&f.delete(i);else for(let j of(bK(b)?e.call(a,b,d,g):e.call(a,b,d),f))j[0]===b&&(void 0===d||j[1]===d)&&(void 0===g||j[2]===g)&&f.delete(j);let k=0===f.size;h&&k&&c()}),a}),kN=(bL=i4,bM=kM,(a,b)=>{b.channelCount=1,b.channelCountMode="explicit",Object.defineProperty(b,"channelCount",{get:()=>1,set:()=>{throw bL()}}),Object.defineProperty(b,"channelCountMode",{get:()=>"explicit",set:()=>{throw bL()}});let c=a.createBufferSource(),d=()=>{let a=b.numberOfInputs;for(let d=0;d<a;d+=1)c.connect(b,0,d)},e=()=>c.disconnect(b);bM(b,d,e)}),kO=(bN=km,bO=kN,(a,b)=>{let c=a.createChannelMerger(b.numberOfInputs);return null!==bN&&"webkitAudioContext"===bN.name&&bO(a,c),jb(c,b),c}),kP=(bP=kO,bQ=iF,bR=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=bQ(b),e=ib(d,c);if(!e){let f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,numberOfInputs:d.numberOfInputs};d=bP(c,f)}return a.set(c,d),await bR(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),kQ=(bS=kr,bT=kP,bU=kO,class extends bS{constructor(a,b){let c=(bV=kh)(a),d=bU(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6,...b}),e=kj(c)?bT():null;super(a,!1,d,e)}}),kR=(bX=jp,bY=iF,bZ=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=bY(b),e=ib(d,c);if(!e){let f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,numberOfOutputs:d.numberOfOutputs};d=bX(c,f)}return a.set(c,d),await bZ(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),kS=(b$=kr,b_=kR,b0=jp,b1=kh,class extends b${constructor(a,b){let c=b1(a),d=jT({channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6,...b}),e=b0(c,d),f=(b2=kj)(c)?b_():null;super(a,!1,e,f)}}),kT=(b4=kA,b5=kD,b6=js,b7=kM,(a,{offset:b,...c})=>{let d=a.createBuffer(1,2,44100),e=b5(a,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),f=b6(a,{...c,gain:b}),g=d.getChannelData(0);g[0]=1,g[1]=1,e.buffer=d,e.loop=!0;let h={get bufferSize(){return},get channelCount(){return f.channelCount},set channelCount(value){f.channelCount=value},get channelCountMode(){return f.channelCountMode},set channelCountMode(value){f.channelCountMode=value},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(value){f.channelInterpretation=value},get context(){return f.context},get inputs(){return[]},get numberOfInputs(){return e.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get offset(){return f.gain},get onended(){return e.onended},set onended(value){e.onended=value},addEventListener(...a){return e.addEventListener(a[0],a[1],a[2])},dispatchEvent(...a){return e.dispatchEvent(a[0])},removeEventListener(...a){return e.removeEventListener(a[0],a[1],a[2])},start(a=0){e.start.call(e,a)},stop(a=0){e.stop.call(e,a)}},i=()=>e.connect(f),j=()=>e.disconnect(f);return b4(a,e),b7(jq(h,f),i,j)}),kU=(b8=kA,b9=kb,ca=kT,cb=jZ,cc=j_,(a,b)=>{if(void 0===a.createConstantSource)return ca(a,b);let c=a.createConstantSource();return jb(c,b),je(c,b,"offset"),b9(cb,()=>cb(a))||jg(c),b9(cc,()=>cc(a))||jh(c),b8(a,c),c}),kV=(cd=kC,ce=kU,cf=iF,cg=kE,ch=kf,()=>{let a=new WeakMap,b=null,c=null,d=async(d,e)=>{let f=cf(d),g=ib(f,e);if(!g){let h={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,offset:f.offset.value};f=ce(e,h),null!==b&&f.start(b),null!==c&&f.stop(c)}return a.set(e,f),g?await cd(e,d.offset,f.offset):await cg(e,d.offset,f.offset),await ch(d,e,f),f};return{set start(value){b=value},set stop(value){c=value},render(b,c){let e=a.get(c);return void 0!==e?Promise.resolve(e):d(b,c)}}}),kW=(ci=kr,cj=kG,ck=kV,cl=kU,cm=kh,class extends ci{constructor(a,b){let c=cm(a),d=cl(c,{channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1,...b}),e=(cn=kj)(c),f=e?ck():null;super(a,!1,d,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=d,this._offset=cj(this,e,d.offset,34028234663852886e22,-34028234663852886e22),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(a){let b="function"==typeof a?(co=j5)(this,a):null;this._nativeConstantSourceNode.onended=b;let c=this._nativeConstantSourceNode.onended;this._onended=null!==c&&c===b?a:c}start(a=0){if(this._nativeConstantSourceNode.start(a),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=a),"closed"!==this.context.state){h7(this);let b=()=>{this._nativeConstantSourceNode.removeEventListener("ended",b),ig(this)&&h9(this)};this._nativeConstantSourceNode.addEventListener("ended",b)}}stop(a=0){this._nativeConstantSourceNode.stop(a),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=a)}}),kX=(cp=jA,cq=jR,(a,b)=>{let c=a.createConvolver();if(jb(c,b),b.disableNormalization===c.normalize&&(c.normalize=!b.disableNormalization),ja(c,b,"buffer"),b.channelCount>2||(cq(c,"channelCount",a=>()=>a.call(c),a=>b=>{if(b>2)throw cp();return a.call(c,b)}),"max"===b.channelCountMode))throw cp();return cq(c,"channelCountMode",a=>()=>a.call(c),a=>b=>{if("max"===b)throw cp();return a.call(c,b)}),c}),kY=(cr=kX,cs=iF,ct=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=cs(b),e=ib(d,c);if(!e){let f={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,disableNormalization:!d.normalize};d=cr(c,f)}return a.set(c,d),iy(d)?await ct(b,c,d.inputs[0]):await ct(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),kZ=(cu=kr,cv=kY,cw=kX,cx=kh,cy=kj,cz=kK,class extends cu{constructor(a,b){let c=cx(a),d={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1,...b},e=cw(c,d),f=cy(c),g=f?cv():null;super(a,!1,e,g),this._isBufferNullified=!1,this._nativeConvolverNode=e,null!==d.buffer&&cz(this,d.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,null===a&&null!==this._nativeConvolverNode.buffer){let b=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=b.createBuffer(1,1,b.sampleRate),this._isBufferNullified=!0,cz(this,0)}else this._isBufferNullified=!1,cz(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}}),k$=(cA=kC,cB=jr,cC=iF,cD=kE,cE=kf,a=>{let b=new WeakMap,c=async(c,d)=>{let e=cC(c),f=ib(e,d);if(!f){let g={channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation,delayTime:e.delayTime.value,maxDelayTime:a};e=cB(d,g)}return b.set(d,e),f?await cA(d,c.delayTime,e.delayTime):await cD(d,c.delayTime,e.delayTime),await cE(c,d,e),e};return{render(a,d){let e=b.get(d);return void 0!==e?Promise.resolve(e):c(a,d)}}}),k_=(cF=kr,cG=kG,cH=k$,cI=jr,cJ=kh,class extends cF{constructor(a,b){let c=cJ(a),d={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1,...b},e=cI(c,d),f=(cK=kj)(c),g=f?cH(d.maxDelayTime):null;super(a,!1,e,g),this._delayTime=cG(this,f,e.delayTime),kK(this,d.maxDelayTime)}get delayTime(){return this._delayTime}}),k0=(cM=jA,(a,b)=>{let c=a.createDynamicsCompressor();if(jb(c,b),b.channelCount>2||"max"===b.channelCountMode)throw cM();return je(c,b,"attack"),je(c,b,"knee"),je(c,b,"ratio"),je(c,b,"release"),je(c,b,"threshold"),c}),k1=(cN=kC,cO=k0,cP=iF,cQ=kE,cR=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=cP(b),e=ib(d,c);if(!e){let f={attack:d.attack.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,knee:d.knee.value,ratio:d.ratio.value,release:d.release.value,threshold:d.threshold.value};d=cO(c,f)}return a.set(c,d),e?(await cN(c,b.attack,d.attack),await cN(c,b.knee,d.knee),await cN(c,b.ratio,d.ratio),await cN(c,b.release,d.release),await cN(c,b.threshold,d.threshold)):(await cQ(c,b.attack,d.attack),await cQ(c,b.knee,d.knee),await cQ(c,b.ratio,d.ratio),await cQ(c,b.release,d.release),await cQ(c,b.threshold,d.threshold)),await cR(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),k2=(cS=kr,cT=kG,cU=k1,cV=k0,cW=jA,cX=kh,class extends cS{constructor(a,b){let c=cX(a),d=cV(c,{attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24,...b}),e=(cY=kj)(c),f=e?cU():null;super(a,!1,d,f),this._attack=cT(this,e,d.attack),this._knee=cT(this,e,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=cT(this,e,d.ratio),this._release=cT(this,e,d.release),this._threshold=cT(this,e,d.threshold),kK(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(a){let b=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=a,a>2)throw this._nativeDynamicsCompressorNode.channelCount=b,cW()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(a){let b=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=a,"max"===a)throw this._nativeDynamicsCompressorNode.channelCountMode=b,cW()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}}),k3=(c$=kC,c_=js,c0=iF,c1=kE,c2=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=c0(b),e=ib(d,c);if(!e){let f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,gain:d.gain.value};d=c_(c,f)}return a.set(c,d),e?await c$(c,b.gain,d.gain):await c1(c,b.gain,d.gain),await c2(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),k4=(c3=kr,c4=kG,c5=k3,c6=js,class extends c3{constructor(a,b){let c=(c7=kh)(a),d=c6(c,{channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1,...b}),e=kj(c),f=e?c5():null;super(a,!1,d,f),this._gain=c4(this,e,d.gain,34028234663852886e22,-34028234663852886e22)}get gain(){return this._gain}}),k5=(c9=i5,da=i4,db=jz,dc=jA,(a,b,{channelCount:c,channelCountMode:d,channelInterpretation:e,feedback:f,feedforward:g})=>{let h=jj(b,a.sampleRate),i=f instanceof Float64Array?f:new Float64Array(f),j=g instanceof Float64Array?g:new Float64Array(g),k=i.length,l=j.length,m=Math.min(k,l);if(0===k||k>20)throw dc();if(0===i[0])throw da();if(0===l||l>20)throw dc();if(0===j[0])throw da();if(1!==i[0]){for(let n=0;n<l;n+=1)j[n]/=i[0];for(let o=1;o<k;o+=1)i[o]/=i[0]}let p=db(a,h,c,c);p.channelCount=c,p.channelCountMode=d,p.channelInterpretation=e;let q=[],r=[],s=[];for(let t=0;t<c;t+=1){q.push(0);let u=new Float32Array(32),v=new Float32Array(32);u.fill(0),v.fill(0),r.push(u),s.push(v)}p.onaudioprocess=a=>{let b=a.inputBuffer,c=a.outputBuffer,d=b.numberOfChannels;for(let e=0;e<d;e+=1){let f=b.getChannelData(e),g=c.getChannelData(e);q[e]=i6(i,k,j,l,m,r[e],s[e],q[e],32,f,g)}};let w=a.sampleRate/2,x={get bufferSize(){return h},get channelCount(){return p.channelCount},set channelCount(value){p.channelCount=value},get channelCountMode(){return p.channelCountMode},set channelCountMode(value){p.channelCountMode=value},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(value){p.channelInterpretation=value},get context(){return p.context},get inputs(){return[p]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},addEventListener(...a){return p.addEventListener(a[0],a[1],a[2])},dispatchEvent(...a){return p.dispatchEvent(a[0])},getFrequencyResponse(a,b,c){if(a.length!==b.length||b.length!==c.length)throw c9();let d=a.length;for(let e=0;e<d;e+=1){let f=-Math.PI*(a[e]/w),g=[Math.cos(f),Math.sin(f)],h=jv(j,g),k=jv(i,g),l=jt(h,k);b[e]=Math.sqrt(l[0]*l[0]+l[1]*l[1]),c[e]=Math.atan2(l[1],l[0])}},removeEventListener(...a){return p.removeEventListener(a[0],a[1],a[2])}};return jq(x,p)}),k6=(df=kb,dg=js,dh=jz,di=(dd=js,de=ki,()=>{if(null===de)return Promise.resolve(!1);let a=new de(1,1,44100),b=dd(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(c=>{a.oncomplete=()=>{b.disconnect(),c(0!==a.currentTime)},a.startRendering()})}),a=>df(i9,()=>i9(a))?Promise.resolve(df(di,di)).then(b=>{if(!b){let c=dh(a,512,0,1);a.oncomplete=()=>{c.onaudioprocess=null,c.disconnect()},c.onaudioprocess=()=>a.currentTime,c.connect(a.destination)}return a.startRendering()}):new Promise(b=>{let c=dg(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});a.oncomplete=a=>{c.disconnect(),b(a.renderedBuffer)},c.connect(a.destination),a.startRendering()})),k7=(dj=kD,dk=iF,dl=ki,dm=kf,dn=k6,(a,b)=>{let c=new WeakMap,d=null,e=async(e,f)=>{let g=null,h=dk(e),i=ib(h,f);if(void 0===f.createIIRFilter?g=dj(f,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):i||(h=f.createIIRFilter(b,a)),c.set(f,null===g?h:g),null!==g){if(null===d){if(null===dl)throw Error("Missing the native OfflineAudioContext constructor.");let j=new dl(e.context.destination.channelCount,e.context.length,f.sampleRate);d=(async()=>{await dm(e,j,j.destination);let c=await dn(j);return i7(c,f,a,b)})()}let k=await d;return g.buffer=k,g.start(0),g}return await dm(e,f,h),h};return{render(a,b){let d=c.get(b);return void 0!==d?Promise.resolve(d):e(a,b)}}}),k8=(dp=k5,(a,b,c)=>{if(void 0===a.createIIRFilter)return dp(a,b,c);let d=a.createIIRFilter(c.feedforward,c.feedback);return jb(d,c),d}),k9=(dq=kr,dr=k8,ds=k7,dt=kh,class extends dq{constructor(a,b){var c,d;let e=dt(a),f=(du=kj)(e),g={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",...b},h=dr(e,f?null:a.baseLatency,g),i=f?ds(g.feedback,g.feedforward):null;super(a,!1,h,i),(c=h).getFrequencyResponse=(d=c.getFrequencyResponse,(a,b,e)=>{if(a.length!==b.length||b.length!==e.length)throw i5();return d.call(c,a,b,e)}),this._nativeIIRFilterNode=h,kK(this,1)}getFrequencyResponse(a,b,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,b,c)}}),la=(dw=kG,dx=kO,dy=kU,dz=jz,dA=jA,dB=jP,dC=kj,dD=jR,(a,b)=>{let c=b.listener,{forwardX:d,forwardY:e,forwardZ:f,positionX:g,positionY:h,positionZ:i,upX:j,upY:k,upZ:l}=void 0===c.forwardX?(()=>{let d=new Float32Array(1),e=dx(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),f=dC(b),g=!1,h=[0,0,-1,0,1,0],i=[0,0,0],j=()=>{if(g)return;g=!0;let a=dz(b,256,9,0);a.onaudioprocess=({inputBuffer:a})=>{let b=[dB(a,d,0),dB(a,d,1),dB(a,d,2),dB(a,d,3),dB(a,d,4),dB(a,d,5)];b.some((a,b)=>a!==h[b])&&(c.setOrientation(...b),h=b);let e=[dB(a,d,6),dB(a,d,7),dB(a,d,8)];e.some((a,b)=>a!==i[b])&&(c.setPosition(...e),i=e)},e.connect(a)},k=a=>b=>{b!==h[a]&&(h[a]=b,c.setOrientation(...h))},l=a=>b=>{b!==i[a]&&(i[a]=b,c.setPosition(...i))},m=(c,d,g)=>{var h,i,k,l,m,n,o;let p=dy(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:d});p.connect(e,0,c),p.start(),Object.defineProperty(p.offset,"defaultValue",{get(){return d}});let q=dw({context:a},f,p.offset,34028234663852886e22,-34028234663852886e22);return dD(q,"value",a=>()=>a.call(q),a=>b=>{try{a.call(q,b)}catch(c){if(9!==c.code)throw c}j(),f&&g(b)}),q.cancelAndHoldAtTime=(h=q.cancelAndHoldAtTime,f?()=>{throw dA()}:(...a)=>{let b=h.apply(q,a);return j(),b}),q.cancelScheduledValues=(i=q.cancelScheduledValues,f?()=>{throw dA()}:(...a)=>{let b=i.apply(q,a);return j(),b}),q.exponentialRampToValueAtTime=(k=q.exponentialRampToValueAtTime,f?()=>{throw dA()}:(...a)=>{let b=k.apply(q,a);return j(),b}),q.linearRampToValueAtTime=(l=q.linearRampToValueAtTime,f?()=>{throw dA()}:(...a)=>{let b=l.apply(q,a);return j(),b}),q.setTargetAtTime=(m=q.setTargetAtTime,f?()=>{throw dA()}:(...a)=>{let b=m.apply(q,a);return j(),b}),q.setValueAtTime=(n=q.setValueAtTime,f?()=>{throw dA()}:(...a)=>{let b=n.apply(q,a);return j(),b}),q.setValueCurveAtTime=(o=q.setValueCurveAtTime,f?()=>{throw dA()}:(...a)=>{let b=o.apply(q,a);return j(),b}),q};return{forwardX:m(0,0,k(0)),forwardY:m(1,0,k(1)),forwardZ:m(2,-1,k(2)),positionX:m(6,0,l(0)),positionY:m(7,0,l(1)),positionZ:m(8,0,l(2)),upX:m(3,0,k(3)),upY:m(4,1,k(4)),upZ:m(5,0,k(5))}})():c;return{get forwardX(){return d},get forwardY(){return e},get forwardZ(){return f},get positionX(){return g},get positionY(){return h},get positionZ(){return i},get upX(){return j},get upY(){return k},get upZ(){return l}}}),lb=new WeakMap,lc=(dE=kI,dF=la,dG=kl,dH=kj,class extends dG{constructor(a,b){super(a),this._nativeContext=a,hU.set(this,a),dH(a)&&(dI=lb).set(a,new Set),this._destination=new dE(this,b),this._listener=dF(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){let b="function"==typeof a?(dJ=j5)(this,a):null;this._nativeContext.onstatechange=b;let c=this._nativeContext.onstatechange;this._onstatechange=null!==c&&c===b?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}}),ld=(dK=kA,dL=kb,dM=jZ,dN=j$,dO=j_,dP=j4,(a,b)=>{let c=a.createOscillator();return jb(c,b),je(c,b,"detune"),je(c,b,"frequency"),void 0!==b.periodicWave?c.setPeriodicWave(b.periodicWave):ja(c,b,"type"),dL(dM,()=>dM(a))||jg(c),dL(dN,()=>dN(a))||dP(c,a),dL(dO,()=>dO(a))||jh(c),dK(a,c),c}),le=(dQ=kC,dR=ld,dS=iF,dT=kE,dU=kf,()=>{let a=new WeakMap,b=null,c=null,d=null,e=async(e,f)=>{let g=dS(e),h=ib(g,f);if(!h){let i={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,detune:g.detune.value,frequency:g.frequency.value,periodicWave:null===b?void 0:b,type:g.type};g=dR(f,i),null!==c&&g.start(c),null!==d&&g.stop(d)}return a.set(f,g),h?(await dQ(f,e.detune,g.detune),await dQ(f,e.frequency,g.frequency)):(await dT(f,e.detune,g.detune),await dT(f,e.frequency,g.frequency)),await dU(e,f,g),g};return{set periodicWave(value){b=value},set start(value){c=value},set stop(value){d=value},render(b,c){let d=a.get(c);return void 0!==d?Promise.resolve(d):e(b,c)}}}),lf=(dV=kr,dW=kG,dX=ld,dY=le,dZ=kh,class extends dV{constructor(a,b){let c=dZ(a),d={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine",...b},e=dX(c,d),f=(d$=kj)(c),g=f?dY():null,h=a.sampleRate/2;super(a,!1,e,g),this._detune=dW(this,f,e.detune,153600,-153600),this._frequency=dW(this,f,e.frequency,h,-h),this._nativeOscillatorNode=e,this._onended=null,this._oscillatorNodeRenderer=g,null!==this._oscillatorNodeRenderer&& void 0!==d.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(a){let b="function"==typeof a?(d_=j5)(this,a):null;this._nativeOscillatorNode.onended=b;let c=this._nativeOscillatorNode.onended;this._onended=null!==c&&c===b?a:c}get type(){return this._nativeOscillatorNode.type}set type(a){this._nativeOscillatorNode.type=a,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(a){this._nativeOscillatorNode.setPeriodicWave(a),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=a)}start(a=0){if(this._nativeOscillatorNode.start(a),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=a),"closed"!==this.context.state){h7(this);let b=()=>{this._nativeOscillatorNode.removeEventListener("ended",b),ig(this)&&h9(this)};this._nativeOscillatorNode.addEventListener("ended",b)}}stop(a=0){this._nativeOscillatorNode.stop(a),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=a)}}),lg=(d0=kD,(a,b)=>{let c=d0(a,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),d=a.createBuffer(1,2,44100);return c.buffer=d,c.loop=!0,c.connect(b),c.start(),()=>{c.stop(),c.disconnect(b)}}),lh=(d1=lg,d2=i4,d3=js,d4=jQ,d5=kM,(a,{curve:b,oversample:c,...d})=>{let e=a.createWaveShaper(),f=a.createWaveShaper();jb(e,d),jb(f,d);let g=d3(a,{...d,gain:1}),h=d3(a,{...d,gain:-1}),i=d3(a,{...d,gain:1}),j=d3(a,{...d,gain:-1}),k=null,l=!1,m=null,n={get bufferSize(){return},get channelCount(){return e.channelCount},set channelCount(value){g.channelCount=value,h.channelCount=value,e.channelCount=value,i.channelCount=value,f.channelCount=value,j.channelCount=value},get channelCountMode(){return e.channelCountMode},set channelCountMode(value){g.channelCountMode=value,h.channelCountMode=value,e.channelCountMode=value,i.channelCountMode=value,f.channelCountMode=value,j.channelCountMode=value},get channelInterpretation(){return e.channelInterpretation},set channelInterpretation(value){g.channelInterpretation=value,h.channelInterpretation=value,e.channelInterpretation=value,i.channelInterpretation=value,f.channelInterpretation=value,j.channelInterpretation=value},get context(){return e.context},get curve(){return m},set curve(value){if(null!==value&&value.length<2)throw d2();if(null===value)e.curve=value,f.curve=value;else{let o=value.length,p=new Float32Array(o+2-o%2),q=new Float32Array(o+2-o%2);p[0]=value[0],q[0]=-value[o-1];let r=Math.ceil((o+1)/2),s=(o+1)/2-1;for(let t=1;t<r;t+=1){let u=t/r*s,v=Math.floor(u),w=Math.ceil(u);p[t]=v===w?value[v]:(1-(u-v))*value[v]+(1-(w-u))*value[w],q[t]=v===w?-value[o-1-v]:-((1-(u-v))*value[o-1-v])-(1-(w-u))*value[o-1-w]}p[r]=o%2==1?value[r-1]:(value[r-2]+value[r-1])/2,e.curve=p,f.curve=q}m=value,l&&(d4(m)&&null===k?k=d1(a,g):null!==k&&(k(),k=null))},get inputs(){return[g]},get numberOfInputs(){return e.numberOfInputs},get numberOfOutputs(){return e.numberOfOutputs},get oversample(){return e.oversample},set oversample(value){e.oversample=value,f.oversample=value},addEventListener(...a){return g.addEventListener(a[0],a[1],a[2])},dispatchEvent(...a){return g.dispatchEvent(a[0])},removeEventListener(...a){return g.removeEventListener(a[0],a[1],a[2])}};null!==b&&(n.curve=b instanceof Float32Array?b:new Float32Array(b)),c!==n.oversample&&(n.oversample=c);let x=()=>{g.connect(e).connect(i),g.connect(h).connect(f).connect(j).connect(i),l=!0,d4(m)&&(k=d1(a,g))},y=()=>{g.disconnect(e),e.disconnect(i),g.disconnect(h),h.disconnect(f),f.disconnect(j),j.disconnect(i),l=!1,null!==k&&(k(),k=null)};return d5(jq(n,i),x,y)}),li=(d6=lg,d7=i4,d8=lh,d9=jQ,ea=kM,eb=km,ec=jR,(a,b)=>{let c=a.createWaveShaper();if(null!==eb&&"webkitAudioContext"===eb.name&& void 0===a.createGain().gain.automationRate)return d8(a,b);jb(c,b);let d=null===b.curve||b.curve instanceof Float32Array?b.curve:new Float32Array(b.curve);if(null!==d&&d.length<2)throw d7();ja(c,{curve:d},"curve"),ja(c,b,"oversample");let e=null,f=!1;ec(c,"curve",a=>()=>a.call(c),b=>d=>(b.call(c,d),f&&(d9(d)&&null===e?e=d6(a,c):d9(d)||null===e||(e(),e=null)),d));let g=()=>{f=!0,d9(c.curve)&&(e=d6(a,c))},h=()=>{f=!1,null!==e&&(e(),e=null)};return ea(c,g,h)}),lj=(ed=iz,ee=i4,ef=kO,eg=js,eh=jz,ei=li,ej=jA,ek=iE,el=jP,em=kM,(a,{coneInnerAngle:b,coneOuterAngle:c,coneOuterGain:d,distanceModel:e,maxDistance:f,orientationX:g,orientationY:h,orientationZ:i,panningModel:j,positionX:k,positionY:l,positionZ:m,refDistance:n,rolloffFactor:o,...p})=>{let q=a.createPanner();if(p.channelCount>2||"max"===p.channelCountMode)throw ej();jb(q,p);let r={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},s=ef(a,{...r,channelInterpretation:"speakers",numberOfInputs:6}),t=eg(a,{...p,gain:1}),u=eg(a,{...r,gain:1}),v=eg(a,{...r,gain:0}),w=eg(a,{...r,gain:0}),x=eg(a,{...r,gain:0}),y=eg(a,{...r,gain:0}),z=eg(a,{...r,gain:0}),A=eh(a,256,6,1),B=ei(a,{...r,curve:new Float32Array([1,1]),oversample:"none"}),C=[g,h,i],D=[k,l,m],E=new Float32Array(1);A.onaudioprocess=({inputBuffer:a})=>{let b=[el(a,E,0),el(a,E,1),el(a,E,2)];b.some((a,b)=>a!==C[b])&&(q.setOrientation(...b),C=b);let c=[el(a,E,3),el(a,E,4),el(a,E,5)];c.some((a,b)=>a!==D[b])&&(q.setPosition(...c),D=c)},Object.defineProperty(v.gain,"defaultValue",{get:()=>0}),Object.defineProperty(w.gain,"defaultValue",{get:()=>0}),Object.defineProperty(x.gain,"defaultValue",{get:()=>0}),Object.defineProperty(y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0});let F={get bufferSize(){return},get channelCount(){return q.channelCount},set channelCount(value){if(value>2)throw ej();t.channelCount=value,q.channelCount=value},get channelCountMode(){return q.channelCountMode},set channelCountMode(value){if("max"===value)throw ej();t.channelCountMode=value,q.channelCountMode=value},get channelInterpretation(){return q.channelInterpretation},set channelInterpretation(value){t.channelInterpretation=value,q.channelInterpretation=value},get coneInnerAngle(){return q.coneInnerAngle},set coneInnerAngle(value){q.coneInnerAngle=value},get coneOuterAngle(){return q.coneOuterAngle},set coneOuterAngle(value){q.coneOuterAngle=value},get coneOuterGain(){return q.coneOuterGain},set coneOuterGain(value){if(value<0||value>1)throw ee();q.coneOuterGain=value},get context(){return q.context},get distanceModel(){return q.distanceModel},set distanceModel(value){q.distanceModel=value},get inputs(){return[t]},get maxDistance(){return q.maxDistance},set maxDistance(value){if(value<0)throw RangeError();q.maxDistance=value},get numberOfInputs(){return q.numberOfInputs},get numberOfOutputs(){return q.numberOfOutputs},get orientationX(){return u.gain},get orientationY(){return v.gain},get orientationZ(){return w.gain},get panningModel(){return q.panningModel},set panningModel(value){q.panningModel=value},get positionX(){return x.gain},get positionY(){return y.gain},get positionZ(){return z.gain},get refDistance(){return q.refDistance},set refDistance(value){if(value<0)throw RangeError();q.refDistance=value},get rolloffFactor(){return q.rolloffFactor},set rolloffFactor(value){if(value<0)throw RangeError();q.rolloffFactor=value},addEventListener(...a){return t.addEventListener(a[0],a[1],a[2])},dispatchEvent(...a){return t.dispatchEvent(a[0])},removeEventListener(...a){return t.removeEventListener(a[0],a[1],a[2])}};b!==F.coneInnerAngle&&(F.coneInnerAngle=b),c!==F.coneOuterAngle&&(F.coneOuterAngle=c),d!==F.coneOuterGain&&(F.coneOuterGain=d),e!==F.distanceModel&&(F.distanceModel=e),f!==F.maxDistance&&(F.maxDistance=f),g!==F.orientationX.value&&(F.orientationX.value=g),h!==F.orientationY.value&&(F.orientationY.value=h),i!==F.orientationZ.value&&(F.orientationZ.value=i),j!==F.panningModel&&(F.panningModel=j),k!==F.positionX.value&&(F.positionX.value=k),l!==F.positionY.value&&(F.positionY.value=l),m!==F.positionZ.value&&(F.positionZ.value=m),n!==F.refDistance&&(F.refDistance=n),o!==F.rolloffFactor&&(F.rolloffFactor=o),(1!==C[0]||0!==C[1]||0!==C[2])&&q.setOrientation(...C),(0!==D[0]||0!==D[1]||0!==D[2])&&q.setPosition(...D);let G=()=>{t.connect(q),ed(t,B,0,0),B.connect(u).connect(s,0,0),B.connect(v).connect(s,0,1),B.connect(w).connect(s,0,2),B.connect(x).connect(s,0,3),B.connect(y).connect(s,0,4),B.connect(z).connect(s,0,5),s.connect(A).connect(a.destination)},H=()=>{t.disconnect(q),ek(t,B,0,0),B.disconnect(u),u.disconnect(s),B.disconnect(v),v.disconnect(s),B.disconnect(w),w.disconnect(s),B.disconnect(x),x.disconnect(s),B.disconnect(y),y.disconnect(s),B.disconnect(z),z.disconnect(s),s.disconnect(A),A.disconnect(a.destination)};return em(jq(F,q),G,H)}),lk=(en=lj,(a,b)=>{let c=a.createPanner();return void 0===c.orientationX?en(a,b):(jb(c,b),je(c,b,"orientationX"),je(c,b,"orientationY"),je(c,b,"orientationZ"),je(c,b,"positionX"),je(c,b,"positionY"),je(c,b,"positionZ"),ja(c,b,"coneInnerAngle"),ja(c,b,"coneOuterAngle"),ja(c,b,"coneOuterGain"),ja(c,b,"distanceModel"),ja(c,b,"maxDistance"),ja(c,b,"panningModel"),ja(c,b,"refDistance"),ja(c,b,"rolloffFactor"),c)}),ll=(eo=kC,ep=kO,eq=kU,er=js,es=lk,et=iF,eu=ki,ev=kE,ew=kf,ex=k6,()=>{let a=new WeakMap,b=null,c=async(c,d)=>{let e=null,f=et(c),g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation},h={...g,coneInnerAngle:f.coneInnerAngle,coneOuterAngle:f.coneOuterAngle,coneOuterGain:f.coneOuterGain,distanceModel:f.distanceModel,maxDistance:f.maxDistance,panningModel:f.panningModel,refDistance:f.refDistance,rolloffFactor:f.rolloffFactor},i=ib(f,d);if("bufferSize"in f)e=er(d,{...g,gain:1});else if(!i){let j={...h,orientationX:f.orientationX.value,orientationY:f.orientationY.value,orientationZ:f.orientationZ.value,positionX:f.positionX.value,positionY:f.positionY.value,positionZ:f.positionZ.value};f=es(d,j)}if(a.set(d,null===e?f:e),null!==e){if(null===b){if(null===eu)throw Error("Missing the native OfflineAudioContext constructor.");let k=new eu(6,c.context.length,d.sampleRate),l=ep(k,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});l.connect(k.destination),b=(async()=>{let a=await Promise.all([c.orientationX,c.orientationY,c.orientationZ,c.positionX,c.positionY,c.positionZ].map(async(a,b)=>{let c=eq(k,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===b?1:0});return await ev(k,a,c.offset),c}));for(let b=0;b<6;b+=1)a[b].connect(l,0,b),a[b].start(0);return ex(k)})()}let m=await b,n=er(d,{...g,gain:1});await ew(c,d,n);let o=[];for(let p=0;p<m.numberOfChannels;p+=1)o.push(m.getChannelData(p));let q=[o[0][0],o[1][0],o[2][0]],r=[o[3][0],o[4][0],o[5][0]],s=er(d,{...g,gain:1}),t=es(d,{...h,orientationX:q[0],orientationY:q[1],orientationZ:q[2],positionX:r[0],positionY:r[1],positionZ:r[2]});n.connect(s).connect(t.inputs[0]),t.connect(e);for(let u=128;u<m.length;u+=128){let v=[o[0][u],o[1][u],o[2][u]],w=[o[3][u],o[4][u],o[5][u]];if(v.some((a,b)=>a!==q[b])||w.some((a,b)=>a!==r[b])){q=v,r=w;let x=u/d.sampleRate;s.gain.setValueAtTime(0,x),s=er(d,{...g,gain:0}),t=es(d,{...h,orientationX:q[0],orientationY:q[1],orientationZ:q[2],positionX:r[0],positionY:r[1],positionZ:r[2]}),s.gain.setValueAtTime(1,x),n.connect(s).connect(t.inputs[0]),t.connect(e)}}return e}return i?(await eo(d,c.orientationX,f.orientationX),await eo(d,c.orientationY,f.orientationY),await eo(d,c.orientationZ,f.orientationZ),await eo(d,c.positionX,f.positionX),await eo(d,c.positionY,f.positionY),await eo(d,c.positionZ,f.positionZ)):(await ev(d,c.orientationX,f.orientationX),await ev(d,c.orientationY,f.orientationY),await ev(d,c.orientationZ,f.orientationZ),await ev(d,c.positionX,f.positionX),await ev(d,c.positionY,f.positionY),await ev(d,c.positionZ,f.positionZ)),iy(f)?await ew(c,d,f.inputs[0]):await ew(c,d,f),f};return{render(b,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):c(b,d)}}}),lm=(ey=kr,ez=kG,eA=lk,eB=ll,eC=kh,class extends ey{constructor(a,b){let c=eC(a),d=eA(c,{channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1,...b}),e=(eD=kj)(c),f=e?eB():null;super(a,!1,d,f),this._nativePannerNode=d,this._orientationX=ez(this,e,d.orientationX,34028234663852886e22,-34028234663852886e22),this._orientationY=ez(this,e,d.orientationY,34028234663852886e22,-34028234663852886e22),this._orientationZ=ez(this,e,d.orientationZ,34028234663852886e22,-34028234663852886e22),this._positionX=ez(this,e,d.positionX,34028234663852886e22,-34028234663852886e22),this._positionY=ez(this,e,d.positionY,34028234663852886e22,-34028234663852886e22),this._positionZ=ez(this,e,d.positionZ,34028234663852886e22,-34028234663852886e22),kK(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(a){this._nativePannerNode.coneInnerAngle=a}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(a){this._nativePannerNode.coneOuterAngle=a}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(a){this._nativePannerNode.coneOuterGain=a}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(a){this._nativePannerNode.distanceModel=a}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(a){this._nativePannerNode.maxDistance=a}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(a){this._nativePannerNode.panningModel=a}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(a){this._nativePannerNode.refDistance=a}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(a){this._nativePannerNode.rolloffFactor=a}}),ln=(eF=id,(a,{disableNormalization:b,imag:c,real:d})=>{let e=c instanceof Float32Array?c:new Float32Array(c),f=d instanceof Float32Array?d:new Float32Array(d),g=a.createPeriodicWave(f,e,{disableNormalization:b});if(Array.from(c).length<2)throw eF();return g}),lo=(eG=ln,eH=kh,eI=new WeakSet,class a{constructor(a,b){let c=eH(a),d=jU({disableNormalization:!1,...b}),e=eG(c,d);return eI.add(e),e}static[Symbol.hasInstance](b){return null!==b&&"object"==typeof b&&Object.getPrototypeOf(b)===a.prototype||eI.has(b)}}),lp=((a,b,c,d,e,f)=>{let g=new Float32Array([1,1]),h=Math.PI/2,i={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},j={...i,oversample:"none"},k=(a,b,e,f)=>{let k=new Float32Array(16385),l=new Float32Array(16385);for(let m=0;m<16385;m+=1){let n=m/16384*h;k[m]=Math.cos(n),l[m]=Math.sin(n)}let o=c(a,{...i,gain:0}),p=d(a,{...j,curve:k}),q=d(a,{...j,curve:g}),r=c(a,{...i,gain:0}),s=d(a,{...j,curve:l});return{connectGraph(){b.connect(o),b.connect(void 0===q.inputs?q:q.inputs[0]),b.connect(r),q.connect(e),e.connect(void 0===p.inputs?p:p.inputs[0]),e.connect(void 0===s.inputs?s:s.inputs[0]),p.connect(o.gain),s.connect(r.gain),o.connect(f,0,0),r.connect(f,0,1)},disconnectGraph(){b.disconnect(o),b.disconnect(void 0===q.inputs?q:q.inputs[0]),b.disconnect(r),q.disconnect(e),e.disconnect(void 0===p.inputs?p:p.inputs[0]),e.disconnect(void 0===s.inputs?s:s.inputs[0]),p.disconnect(o.gain),s.disconnect(r.gain),o.disconnect(f,0,0),r.disconnect(f,0,1)}}},l=(a,e,f,k)=>{let l=new Float32Array(16385),m=new Float32Array(16385),n=new Float32Array(16385),o=new Float32Array(16385),p=Math.floor(8192.5);for(let q=0;q<16385;q+=1)if(q>p){let r=(q-p)/(16384-p)*h;l[q]=Math.cos(r),m[q]=Math.sin(r),n[q]=0,o[q]=1}else{let s=q/(16384-p)*h;l[q]=1,m[q]=0,n[q]=Math.cos(s),o[q]=Math.sin(s)}let t=b(a,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),u=c(a,{...i,gain:0}),v=d(a,{...j,curve:l}),w=c(a,{...i,gain:0}),x=d(a,{...j,curve:m}),y=d(a,{...j,curve:g}),z=c(a,{...i,gain:0}),A=d(a,{...j,curve:n}),B=c(a,{...i,gain:0}),C=d(a,{...j,curve:o});return{connectGraph(){e.connect(t),e.connect(void 0===y.inputs?y:y.inputs[0]),t.connect(u,0),t.connect(w,0),t.connect(z,1),t.connect(B,1),y.connect(f),f.connect(void 0===v.inputs?v:v.inputs[0]),f.connect(void 0===x.inputs?x:x.inputs[0]),f.connect(void 0===A.inputs?A:A.inputs[0]),f.connect(void 0===C.inputs?C:C.inputs[0]),v.connect(u.gain),x.connect(w.gain),A.connect(z.gain),C.connect(B.gain),u.connect(k,0,0),z.connect(k,0,0),w.connect(k,0,1),B.connect(k,0,1)},disconnectGraph(){e.disconnect(t),e.disconnect(void 0===y.inputs?y:y.inputs[0]),t.disconnect(u,0),t.disconnect(w,0),t.disconnect(z,1),t.disconnect(B,1),y.disconnect(f),f.disconnect(void 0===v.inputs?v:v.inputs[0]),f.disconnect(void 0===x.inputs?x:x.inputs[0]),f.disconnect(void 0===A.inputs?A:A.inputs[0]),f.disconnect(void 0===C.inputs?C:C.inputs[0]),v.disconnect(u.gain),x.disconnect(w.gain),A.disconnect(z.gain),C.disconnect(B.gain),u.disconnect(k,0,0),z.disconnect(k,0,0),w.disconnect(k,0,1),B.disconnect(k,0,1)}}},m=(a,b,c,d,f)=>{if(1===b)return k(a,c,d,f);if(2===b)return l(a,c,d,f);throw e()};return(b,{channelCount:d,channelCountMode:g,pan:h,...i})=>{if("max"===g)throw e();let j=a(b,{...i,channelCount:1,channelCountMode:g,numberOfInputs:2}),k=c(b,{...i,channelCount:d,channelCountMode:g,gain:1}),l=c(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:h}),{connectGraph:n,disconnectGraph:o}=m(b,d,k,l,j);Object.defineProperty(l.gain,"defaultValue",{get:()=>0}),Object.defineProperty(l.gain,"maxValue",{get:()=>1}),Object.defineProperty(l.gain,"minValue",{get:()=>-1});let p={get bufferSize(){return},get channelCount(){return k.channelCount},set channelCount(value){k.channelCount!==value&&(q&&o(),{connectGraph:n,disconnectGraph:o}=m(b,value,k,l,j),q&&n()),k.channelCount=value},get channelCountMode(){return k.channelCountMode},set channelCountMode(value){if("clamped-max"===value||"max"===value)throw e();k.channelCountMode=value},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(value){k.channelInterpretation=value},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get pan(){return l.gain},addEventListener(...a){return k.addEventListener(a[0],a[1],a[2])},dispatchEvent(...a){return k.dispatchEvent(a[0])},removeEventListener(...a){return k.removeEventListener(a[0],a[1],a[2])}},q=!1,r=()=>{n(),q=!0},s=()=>{o(),q=!1};return f(jq(p,j),r,s)}})(kO,jp,js,li,jA,kM),lq=(eK=lp,eL=jA,(a,b)=>{let c=b.channelCountMode;if("clamped-max"===c)throw eL();if(void 0===a.createStereoPanner)return eK(a,b);let d=a.createStereoPanner();return jb(d,b),je(d,b,"pan"),Object.defineProperty(d,"channelCountMode",{get:()=>c,set:a=>{if(a!==c)throw eL()}}),d}),lr=(eM=kC,eN=lq,eO=iF,eP=kE,eQ=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=eO(b),e=ib(d,c);if(!e){let f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,pan:d.pan.value};d=eN(c,f)}return a.set(c,d),e?await eM(c,b.pan,d.pan):await eP(c,b.pan,d.pan),iy(d)?await eQ(b,c,d.inputs[0]):await eQ(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),ls=(eR=kr,eS=kG,eT=lq,eU=lr,class extends eR{constructor(a,b){let c=(eV=kh)(a),d=eT(c,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0,...b}),e=kj(c),f=e?eU():null;super(a,!1,d,f),this._pan=eS(this,e,d.pan)}get pan(){return this._pan}}),lt=(eX=li,eY=iF,eZ=kf,()=>{let a=new WeakMap,b=async(b,c)=>{let d=eY(b),e=ib(d,c);if(!e){let f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,curve:d.curve,oversample:d.oversample};d=eX(c,f)}return a.set(c,d),iy(d)?await eZ(b,c,d.inputs[0]):await eZ(b,c,d),d};return{render(c,d){let e=a.get(d);return void 0!==e?Promise.resolve(e):b(c,d)}}}),lu=(e$=kr,e_=i4,e0=li,e1=lt,e2=kh,class extends e${constructor(a,b){let c=e2(a),d=e0(c,{channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none",...b}),e=(e3=kj)(c),f=e?e1():null;super(a,!0,d,f),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,kK(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(a){if(null===a)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(a.length<2)throw e_();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=a}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(a){this._nativeWaveShaperNode.oversample=a}}),lv=null!==(e5=kc)&&e5.isSecureContext,lw=(e6=kc,(a,b,c)=>{Object.defineProperties(e6,{currentFrame:{configurable:!0,get(){return Math.round(a*b)}},currentTime:{configurable:!0,get(){return a}}});try{return c()}finally{null!==e6&&(delete e6.currentFrame,delete e6.currentTime)}}),lx=new WeakMap,ly=(e7=lx,e8=ki,a=>{let b=e7.get(a);if(void 0!==b)return b;if(null===e8)throw Error("Missing the native OfflineAudioContext constructor.");return b=new e8(1,1,44100),e7.set(a,b),b}),lz,lA=lv?(fd=kb,fe=jA,ff=(e9=kc,a=>new Promise((b,c)=>{if(null===e9){c(SyntaxError());return}let d=e9.document.head;if(null===d)c(SyntaxError());else{let e=e9.document.createElement("script"),f=new Blob([a],{type:"application/javascript"}),g=URL.createObjectURL(f),h=e9.onerror,i=()=>{e9.onerror=h,URL.revokeObjectURL(g)};e9.onerror=(a,b,d,e,f)=>b===g||b===e9.location.href&&1===d&&1===e?(i(),c(f),!1):null!==h?h(a,b,d,e,f):void 0,e.onerror=()=>{i(),c(SyntaxError())},e.onload=()=>{i(),b()},e.src=g,e.type="module",d.appendChild(e)}})),fg=lw,fh=(fa=hO,async a=>{try{let b=await fetch(a);if(b.ok)return[await b.text(),b.url]}catch{}throw fa()}),fi=kh,fj=ly,fk=kj,fl=kq,fm=new WeakMap,fn=new WeakMap,fo=(fb=kq,fc=ki,async()=>{if(null===fb)return!0;if(null===fc)return!1;let a=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),b=new fc(1,128,44100),c=URL.createObjectURL(a),d=!1,e=!1;try{await b.audioWorklet.addModule(c);let f=new fb(b,"a",{numberOfOutputs:0}),g=b.createOscillator();f.port.onmessage=()=>d=!0,f.onprocessorerror=()=>e=!0,g.connect(f),g.start(0),await b.startRendering()}catch{}finally{URL.revokeObjectURL(c)}return d&&!e}),fp=kc,lz=0,(a,b,c={credentials:"omit"})=>{let d=fn.get(a);if(void 0!==d&&d.has(b))return Promise.resolve();let e=fm.get(a);if(void 0!==e){let f=e.get(b);if(void 0!==f)return f}let g=fi(a),h=void 0===g.audioWorklet?fh(b).then(([a,b])=>{let[c,d]=h0(a,b),e=`${c};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${d}
})})(window,'_AWGS')`;return ff(e)}).then(()=>{let a=fp._AWGS.pop();if(void 0===a)throw SyntaxError();fg(g.currentTime,g.sampleRate,()=>a(class{},void 0,(a,b)=>{if(""===a.trim())throw fe();let c=hX.get(g);if(void 0!==c){if(c.has(a))throw fe();h2(b),h1(b.parameterDescriptors),c.set(a,b)}else h2(b),h1(b.parameterDescriptors),hX.set(g,new Map([[a,b]]))},g.sampleRate,void 0,void 0))}):Promise.all([fh(b),Promise.resolve(fd(fo,fo))]).then(([[a,b],d])=>{let e=lz+1;lz=e;let[f,h]=h0(a,b),i=d?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}",j=d?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));",k=d?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));",l=`${f};((AudioWorkletProcessor,registerProcessor)=>{${h}
})(${i},(n,p)=>registerProcessor(n,class extends p{${j}process(i,o,p){${k}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${e}',class extends AudioWorkletProcessor{process(){return !1}})`,m=new Blob([l],{type:"application/javascript; charset=utf-8"}),n=URL.createObjectURL(m);return g.audioWorklet.addModule(n,c).then(()=>{if(fk(g))return g;let a=fj(g);return a.audioWorklet.addModule(n,c).then(()=>a)}).then(a=>{if(null===fl)throw SyntaxError();try{new fl(a,`__sac${e}`)}catch{throw SyntaxError()}}).finally(()=>URL.revokeObjectURL(n))});return void 0===e?fm.set(a,new Map([[b,h]])):e.set(b,h),h.then(()=>{let c=fn.get(a);void 0===c?fn.set(a,new Set([b])):c.add(b)}).finally(()=>{let c=fm.get(a);void 0!==c&&c.delete(b)}),h}):void 0,lB=(fq=kn,fr=kj,a=>fq(a)||fr(a)),lC=(fs=kt,ft=kb,fu=i_,fv=i3,fw=new WeakSet,fx=kh,fy=lB,fz=ic,fA=i9,fB=kw,fC=kx,(a,b)=>{let c=fy(a)?a:fx(a);if(fw.has(b)){let d=fu();return Promise.reject(d)}try{fw.add(b)}catch{}return ft(fA,()=>fA(c))?c.decodeAudioData(b).then(a=>(i0(b).catch(()=>{}),ft(fz,()=>fz(a))||fC(a),fs.add(a),a)):new Promise((a,d)=>{let e=async()=>{try{await i0(b)}catch{}},f=a=>{d(a),e()};try{c.decodeAudioData(b,b=>{"function"!=typeof b.copyFromChannel&&(fB(b),ie(b)),fs.add(b),e().then(()=>a(b))},a=>{null===a?f(fv()):f(a)})}catch(g){f(g)}})}),lD=(fD=lA,fE=ks,fF=kz,fG=kH,fH=kL,fI=kQ,fJ=kS,fK=kW,fL=kZ,fM=lC,fN=k_,fO=k2,fP=k4,fQ=k9,fR=lc,fS=lf,fT=lm,fU=lo,class extends fR{constructor(a,b){super(a,b),this._nativeContext=a,this._audioWorklet=void 0===fD?void 0:{addModule:(a,b)=>fD(this,a,b)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new fE(this)}createBiquadFilter(){return new fH(this)}createBuffer(a,b,c){return new fF({length:b,numberOfChannels:a,sampleRate:c})}createBufferSource(){return new fG(this)}createChannelMerger(a=6){return new fI(this,{numberOfInputs:a})}createChannelSplitter(a=6){return new fJ(this,{numberOfOutputs:a})}createConstantSource(){return new fK(this)}createConvolver(){return new fL(this)}createDelay(a=1){return new fN(this,{maxDelayTime:a})}createDynamicsCompressor(){return new fO(this)}createGain(){return new fP(this)}createIIRFilter(a,b){return new fQ(this,{feedback:b,feedforward:a})}createOscillator(){return new fS(this)}createPanner(){return new fT(this)}createPeriodicWave(a,b,c={disableNormalization:!1}){return new fU(this,{...c,imag:b,real:a})}createStereoPanner(){return new(fV=ls)(this)}createWaveShaper(){return new(fW=lu)(this)}decodeAudioData(a,b,c){return fM(this._nativeContext,a).then(a=>("function"==typeof b&&b(a),a),a=>{throw"function"==typeof c&&c(a),a})}}),lE=(fX=kr,fY=jw,class extends fX{constructor(a,b){let c=(fZ=kh)(a),d=fY(c,b);if(kj(c))throw TypeError();super(a,!0,d,null),this._nativeMediaElementAudioSourceNode=d}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}}),lF=(f_=kr,f0=jx,class extends f_{constructor(a,b){let c=(f1=kh)(a);if(kj(c))throw TypeError();let d=f0(c,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",...b});super(a,!1,d,null),this._nativeMediaStreamAudioDestinationNode=d}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}}),lG=(f3=kr,f4=jy,class extends f3{constructor(a,b){let c=(f5=kh)(a),d=f4(c,b);if(kj(c))throw TypeError();super(a,!0,d,null),this._nativeMediaStreamAudioSourceNode=d}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}),lH=(f7=i4,f8=kj,(a,{mediaStreamTrack:b})=>{if("function"==typeof a.createMediaStreamTrackSource)return a.createMediaStreamTrackSource(b);let c=new MediaStream([b]),d=a.createMediaStreamSource(c);if("audio"!==b.kind)throw f7();if(f8(a))throw TypeError();return d}),lI=(f9=kr,class extends f9{constructor(a,b){let c=kh(a),d=(ga=lH)(c,b);super(a,!0,d,null)}}),lJ=(gc=lD,gd=i4,ge=jA,gf=jO,gg=lE,gh=lF,gi=lG,gj=lI,gk=km,class extends gc{constructor(a={}){var b;if(null===gk)throw Error("Missing the native AudioContext constructor.");let c;try{c=new gk(a)}catch(d){if(12===d.code&&"sampleRate is not in range"===d.message)throw ge();throw d}if(null===c)throw gf();if(!(void 0===(b=a.latencyHint)||"number"==typeof b||"string"==typeof b&&("balanced"===b||"interactive"===b||"playback"===b)))throw TypeError(`The provided value '${a.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==a.sampleRate&&c.sampleRate!==a.sampleRate)throw ge();super(c,2);let{latencyHint:e}=a,{sampleRate:f}=c;if(this._baseLatency="number"==typeof c.baseLatency?c.baseLatency:"balanced"===e?512/f:"interactive"===e|| void 0===e?256/f:"playback"===e?1024/f:128*Math.max(2,Math.min(128,Math.round(e*f/128)))/f,this._nativeAudioContext=c,"webkitAudioContext"===gk.name?(this._nativeGainNode=c.createGain(),this._nativeOscillatorNode=c.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(c.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===c.state){this._state="suspended";let g=()=>{"suspended"===this._state&&(this._state=null),c.removeEventListener("statechange",g)};c.addEventListener("statechange",g)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw gd()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),ir(this)}))}createMediaElementSource(a){return new gg(this,{mediaElement:a})}createMediaStreamDestination(){return new gh(this)}createMediaStreamSource(a){return new gi(this,{mediaStream:a})}createMediaStreamTrackSource(a){return new gj(this,{mediaStreamTrack:a})}resume(){return"suspended"===this._state?new Promise((a,b)=>{let c=()=>{this._nativeAudioContext.removeEventListener("statechange",c),"running"===this._nativeAudioContext.state?a():this.resume().then(a,b)};this._nativeAudioContext.addEventListener("statechange",c)}):this._nativeAudioContext.resume().catch(a=>{if(void 0===a||15===a.code)throw gd();throw a})}suspend(){return this._nativeAudioContext.suspend().catch(a=>{if(void 0===a)throw gd();throw a})}}),lK=(gl=lb,a=>{let b=gl.get(a);if(void 0===b)throw Error("The context has no set of AudioWorkletNodes.");return b}),lL=(gm=lK,(a,b)=>{gm(a).add(b)}),lM=(gn=id,(a,b,c=0,d=0)=>{let e=a[c];if(void 0===e)throw gn();return iL(b)?e.connect(b,0,d):e.connect(b,0)}),lN=(go=lK,(a,b)=>{go(a).delete(b)}),lO=(gp=id,(a,b,c,d=0)=>void 0===b?a.forEach(a=>a.disconnect()):"number"==typeof b?i2(gp,a,b).disconnect():iL(b)?void 0===c?a.forEach(a=>a.disconnect(b)):void 0===d?i2(gp,a,c).disconnect(b,0):i2(gp,a,c).disconnect(b,0,d):void 0===c?a.forEach(a=>a.disconnect(b)):i2(gp,a,c).disconnect(b,0)),lP=new WeakMap,lQ=(gq=lP,gr=h3,a=>gr(gq,a)),lR=(gs=lM,gt=id,gu=i4,gv=kO,gw=jp,gx=kU,gy=js,gz=jz,gA=jA,gB=lO,gC=lw,gD=lQ,gE=kM,(a,b,c,d)=>{var e,f;if(0===d.numberOfInputs&&0===d.numberOfOutputs)throw gA();let g=Array.isArray(d.outputChannelCount)?d.outputChannelCount:Array.from(d.outputChannelCount);if(g.some(a=>a<1))throw gA();if(g.length!==d.numberOfOutputs)throw gt();if("explicit"!==d.channelCountMode)throw gA();let h=d.channelCount*d.numberOfInputs,i=g.reduce((a,b)=>a+b,0),j=void 0===c.parameterDescriptors?0:c.parameterDescriptors.length;if(h+j>6||i>6)throw gA();let k=new MessageChannel,l=[],m=[];for(let n=0;n<d.numberOfInputs;n+=1)l.push(gy(a,{channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,gain:1})),m.push(gw(a,{channelCount:d.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:d.channelCount}));let o=[];if(void 0!==c.parameterDescriptors)for(let{defaultValue:p,maxValue:q,minValue:r,name:s}of c.parameterDescriptors){let t=gx(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==d.parameterData[s]?d.parameterData[s]:void 0===p?0:p});Object.defineProperties(t.offset,{defaultValue:{get:()=>void 0===p?0:p},maxValue:{get:()=>void 0===q?34028234663852886e22:q},minValue:{get:()=>void 0===r?-34028234663852886e22:r}}),o.push(t)}let u=gv(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,h+j)}),v=jj(b,a.sampleRate),w=gz(a,v,h+j,Math.max(1,i)),x=gw(a,{channelCount:Math.max(1,i),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,i)}),y=[];for(let z=0;z<d.numberOfOutputs;z+=1)y.push(gv(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[z]}));for(let A=0;A<d.numberOfInputs;A+=1){l[A].connect(m[A]);for(let B=0;B<d.channelCount;B+=1)m[A].connect(u,B,A*d.channelCount+B)}let C=new iV(void 0===c.parameterDescriptors?[]:c.parameterDescriptors.map(({name:a},b)=>{let c=o[b];return c.connect(u,0,h+b),c.start(0),[a,c.offset]}));u.connect(w);let D=d.channelInterpretation,E=null,F=0===d.numberOfOutputs?[w]:y,G={get bufferSize(){return v},get channelCount(){return d.channelCount},set channelCount(_){throw gu()},get channelCountMode(){return d.channelCountMode},set channelCountMode(_){throw gu()},get channelInterpretation(){return D},set channelInterpretation(value){for(let H of l)H.channelInterpretation=value;D=value},get context(){return w.context},get inputs(){return l},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get onprocessorerror(){return E},set onprocessorerror(value){"function"==typeof E&&G.removeEventListener("processorerror",E),"function"==typeof(E="function"==typeof value?value:null)&&G.addEventListener("processorerror",E)},get parameters(){return C},get port(){return k.port2},addEventListener(...a){return w.addEventListener(a[0],a[1],a[2])},connect:gs.bind(null,F),disconnect:gB.bind(null,F),dispatchEvent(...a){return w.dispatchEvent(a[0])},removeEventListener(...a){return w.removeEventListener(a[0],a[1],a[2])}},I=new Map;k.port1.addEventListener=(e=k.port1.addEventListener,(...b)=>{if("message"===b[0]){let c="function"==typeof b[1]?b[1]:"object"==typeof b[1]&&null!==b[1]&&"function"==typeof b[1].handleEvent?b[1].handleEvent:null;if(null!==c){let d=I.get(b[1]);void 0!==d?b[1]=d:(b[1]=b=>{gC(a.currentTime,a.sampleRate,()=>c(b))},I.set(c,b[1]))}}return e.call(k.port1,b[0],b[1],b[2])}),k.port1.removeEventListener=(f=k.port1.removeEventListener,(...a)=>{if("message"===a[0]){let b=I.get(a[1]);void 0!==b&&(I.delete(a[1]),a[1]=b)}return f.call(k.port1,a[0],a[1],a[2])});let J=null;Object.defineProperty(k.port1,"onmessage",{get:()=>J,set:a=>{"function"==typeof J&&k.port1.removeEventListener("message",J),"function"==typeof(J="function"==typeof a?a:null)&&(k.port1.addEventListener("message",J),k.port1.start())}}),c.prototype.port=k.port1;let K=null,L=jm(a,G,c,d);L.then(a=>K=a);let M=iY(d.numberOfInputs,d.channelCount),N=iY(d.numberOfOutputs,g),O=void 0===c.parameterDescriptors?[]:c.parameterDescriptors.reduce((a,{name:b})=>({...a,[b]:new Float32Array(128)}),{}),P=!0,Q=()=>{d.numberOfOutputs>0&&w.disconnect(x);for(let a=0,b=0;a<d.numberOfOutputs;a+=1){let c=y[a];for(let e=0;e<g[a];e+=1)x.disconnect(c,b+e,e);b+=g[a]}},R=new Map;w.onaudioprocess=({inputBuffer:b,outputBuffer:e})=>{if(null!==K){let f=gD(G);for(let i=0;i<v;i+=128){for(let j=0;j<d.numberOfInputs;j+=1)for(let k=0;k<d.channelCount;k+=1)iW(b,M[j],k,k,i);void 0!==c.parameterDescriptors&&c.parameterDescriptors.forEach(({name:a},c)=>{iW(b,O,a,h+c,i)});for(let n=0;n<d.numberOfInputs;n+=1)for(let p=0;p<g[n];p+=1)0===N[n][p].byteLength&&(N[n][p]=new Float32Array(128));try{let q=M.map((a,b)=>{let c=f[b];if(c.size>0)return R.set(b,v/128),a;let d=R.get(b);return void 0===d?[]:(a.every(a=>a.every(a=>0===a))&&(1===d?R.delete(b):R.set(b,d-1)),a)}),r=gC(a.currentTime+i/a.sampleRate,a.sampleRate,()=>K.process(q,N,O));P=r;for(let s=0,t=0;s<d.numberOfOutputs;s+=1){for(let x=0;x<g[s];x+=1)iX(e,N[s],x,t+x,i);t+=g[s]}}catch(y){P=!1,G.dispatchEvent(new ErrorEvent("processorerror",{colno:y.colno,filename:y.filename,lineno:y.lineno,message:y.message}))}if(!P){for(let z=0;z<d.numberOfInputs;z+=1){l[z].disconnect(m[z]);for(let A=0;A<d.channelCount;A+=1)m[i].disconnect(u,A,z*d.channelCount+A)}if(void 0!==c.parameterDescriptors){let B=c.parameterDescriptors.length;for(let C=0;C<B;C+=1){let D=o[C];D.disconnect(u,0,h+C),D.stop()}}u.disconnect(w),w.onaudioprocess=null,S?Q():V();break}}}};let S=!1,T=gy(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),U=()=>w.connect(T).connect(a.destination),V=()=>{w.disconnect(T),T.disconnect()},W=()=>{if(P){V(),d.numberOfOutputs>0&&w.connect(x);for(let a=0,b=0;a<d.numberOfOutputs;a+=1){let c=y[a];for(let e=0;e<g[a];e+=1)x.connect(c,b+e,e);b+=g[a]}}S=!0},X=()=>{P&&(U(),Q()),S=!1};return U(),gE(G,W,X)}),lS=(gF=i4,gG=lR,gH=js,gI=jA,gJ=kM,(a,b,c,d,e,f)=>{if(null!==c)try{var g,h;let i=new c(a,d,f),j=new Map,k=null;if(Object.defineProperties(i,{channelCount:{get:()=>f.channelCount,set:()=>{throw gF()}},channelCountMode:{get:()=>"explicit",set:()=>{throw gF()}},onprocessorerror:{get:()=>k,set:a=>{"function"==typeof k&&i.removeEventListener("processorerror",k),k="function"==typeof a?a:null,"function"==typeof k&&i.addEventListener("processorerror",k)}}}),i.addEventListener=(g=i.addEventListener,(...a)=>{if("processorerror"===a[0]){let b="function"==typeof a[1]?a[1]:"object"==typeof a[1]&&null!==a[1]&&"function"==typeof a[1].handleEvent?a[1].handleEvent:null;if(null!==b){let c=j.get(a[1]);void 0!==c?a[1]=c:(a[1]=c=>{"error"===c.type?(Object.defineProperties(c,{type:{value:"processorerror"}}),b(c)):b(new ErrorEvent(a[0],{...c}))},j.set(b,a[1]))}}return g.call(i,"error",a[1],a[2]),g.call(i,...a)}),i.removeEventListener=(h=i.removeEventListener,(...a)=>{if("processorerror"===a[0]){let b=j.get(a[1]);void 0!==b&&(j.delete(a[1]),a[1]=b)}return h.call(i,"error",a[1],a[2]),h.call(i,a[0],a[1],a[2])}),0!==f.numberOfOutputs){let l=gH(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.connect(l).connect(a.destination);let m=()=>l.disconnect(),n=()=>l.connect(a.destination);return gJ(i,m,n)}return i}catch(o){if(11===o.code)throw gI();throw o}if(void 0===e)throw gI();return ji(f),gG(a,b,e,f)}),lT=(gK=kC,gL=lM,gM=kD,gN=kO,gO=jp,gP=kU,gQ=js,gR=lN,gS=lO,gT=lw,gU=iF,gV=kq,gW=ki,gX=kE,gY=kf,gZ=k6,(a,b,c)=>{let d=new WeakMap,e=null,f=async(f,g)=>{let h=gU(f),i=null,j=ib(h,g),k=Array.isArray(b.outputChannelCount)?b.outputChannelCount:Array.from(b.outputChannelCount);if(null===gV){let l=k.reduce((a,b)=>a+b,0),m=gO(g,{channelCount:Math.max(1,l),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,l)}),n=[];for(let o=0;o<f.numberOfOutputs;o+=1)n.push(gN(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:k[o]}));let p=gQ(g,{channelCount:b.channelCount,channelCountMode:b.channelCountMode,channelInterpretation:b.channelInterpretation,gain:1});p.connect=gL.bind(null,n),p.disconnect=gS.bind(null,n),i=[m,n,p]}else j||(h=new gV(g,a));if(d.set(g,null===i?h:i[2]),null!==i){if(null===e){if(void 0===c)throw Error("Missing the processor constructor.");if(null===gW)throw Error("Missing the native OfflineAudioContext constructor.");let q=f.channelCount*f.numberOfInputs,r=void 0===c.parameterDescriptors?0:c.parameterDescriptors.length,s=q+r,t=async()=>{let a=new gW(s,128*Math.ceil(f.context.length/128),g.sampleRate),c=[],d=[];for(let e=0;e<b.numberOfInputs;e+=1)c.push(gQ(a,{channelCount:b.channelCount,channelCountMode:b.channelCountMode,channelInterpretation:b.channelInterpretation,gain:1})),d.push(gO(a,{channelCount:b.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:b.channelCount}));let h=await Promise.all(Array.from(f.parameters.values()).map(async b=>{let c=gP(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:b.value});return await gX(a,b,c.offset),c})),i=gN(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,q+r)});for(let j=0;j<b.numberOfInputs;j+=1){c[j].connect(d[j]);for(let k=0;k<b.channelCount;k+=1)d[j].connect(i,k,j*b.channelCount+k)}for(let[l,m]of h.entries())m.connect(i,0,q+l),m.start(0);return i.connect(a.destination),await Promise.all(c.map(b=>gY(f,a,b))),gZ(a)};e=i$(f,0===s?null:await t(),g,b,k,c,gT)}let u=await e,v=gM(g,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[w,x,y]=i;null!==u&&(v.buffer=u,v.start(0)),v.connect(w);for(let z=0,A=0;z<f.numberOfOutputs;z+=1){let B=x[z];for(let C=0;C<k[z];C+=1)w.connect(B,A+C,C);A+=k[z]}return y}if(j)for(let[D,E]of f.parameters.entries())await gK(g,E,h.parameters.get(D));else for(let[F,G]of f.parameters.entries())await gX(g,G,h.parameters.get(F));return await gY(f,g,h),h};return{render(a,b){gR(b,a);let c=d.get(b);return void 0!==c?Promise.resolve(c):f(a,b)}}}),lU=(g$=lx,a=>g$.get(a)),lV=(g_=lP,(a,b)=>{g_.set(a,b)}),lW=lv?(g0=lL,g1=kr,g2=kG,g3=lT,g4=lS,g5=io,g6=lU,g7=kh,g8=kj,g9=kq,ha=jS,hb=lV,class extends g1{constructor(a,b,c){var d;let e=g7(a),f=g8(e),g=ha({channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{},...c});(hc=j0)(g);let h=hX.get(e),i=null==h?void 0:h.get(b),j=f||"closed"!==e.state?e:null!==(d=g6(e))&& void 0!==d?d:e,k=g4(j,f?null:a.baseLatency,g9,b,i,g),l=f?g3(b,g,i):null;super(a,!0,k,l);let m=[];k.parameters.forEach((a,b)=>{let c=g2(this,f,a);m.push([b,c])}),this._nativeAudioWorkletNode=k,this._onprocessorerror=null,this._parameters=new iV(m),f&&g0(e,this);let{activeInputs:n}=g5(this);hb(k,n)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(a){let b="function"==typeof a?(hd=j5)(this,a):null;this._nativeAudioWorkletNode.onprocessorerror=b;let c=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==c&&c===b?a:c}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}}):void 0,lX=(hj=jA,hk=ki,(a,b,c)=>{if(null===hk)throw Error("Missing the native OfflineAudioContext constructor.");try{return new hk(a,b,c)}catch(d){if("SyntaxError"===d.name)throw hj();throw d}}),lY=(hl=kt,hm=kb,hn=ke,ho=lK,hp=k6,hq=ic,hr=kw,hs=kx,(a,b)=>hn(a).render(a,b).then(()=>Promise.all(Array.from(ho(b)).map(a=>hn(a).render(a,b)))).then(()=>hp(b)).then(a=>("function"!=typeof a.copyFromChannel?(hr(a),ie(a)):hm(hq,()=>hq(a))||hs(a),hl.add(a),a))),lZ=(hx=lD,hy=kb,hz=i4,class extends hx{constructor(a,b,c){let d;if("number"==typeof a&& void 0!==b&& void 0!==c)d={length:b,numberOfChannels:a,sampleRate:c};else if("object"==typeof a)d=a;else throw Error("The given parameters are not valid.");let{length:e,numberOfChannels:f,sampleRate:g}={numberOfChannels:1,...d},h=(hA=lX)(f,e,g);hy(i9,()=>i9(h))||h.addEventListener("statechange",(()=>{let a=0,b=c=>{"running"===this._state&&(a>0?(h.removeEventListener("statechange",b),c.stopImmediatePropagation(),this._waitForThePromiseToSettle(c)):a+=1)};return b})()),super(h,f),this._length=e,this._nativeOfflineAudioContext=h,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(hz()):(this._state="running",(hB=lY)(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,ir(this)}))}_waitForThePromiseToSettle(a){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}}),l$=(hC=hU,hD=kn,a=>{let b=hC.get(a);return hD(b)||hD(a)}),l_=(hE=hR,hF=ko,a=>hE.has(a)||hF(a)),l0=(hG=hT,hH=kp,a=>hG.has(a)||hH(a)),l1=(hI=hU,hJ=kj,a=>{let b=hI.get(a);return hJ(b)||hJ(a)}),l2=()=>i8(kb,jB(ki),jC(km),jD(ki),jE(km),jF(ki),jG(kq,ki),jH(ki),jI(ki),jJ(ki),jK(ki),j1,jL(kc),jM(km),jN(ki),j2);function l3(a,b){if(!a)throw Error(b)}function l4(a,b,c=1/0){if(!(b<=a&&a<=c))throw RangeError(`Value must be within [${b}, ${c}], got: ${a}`)}function l5(a){a.isOffline||"running"===a.state||l9('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let l6=console;function l7(a){l6=a}function l8(...a){l6.log(...a)}function l9(...a){l6.warn(...a)}function ma(a){return void 0===a}function mb(a){return!ma(a)}function mc(a){return"function"==typeof a}function md(a){return"number"==typeof a}function me(a){return"[object Object]"===Object.prototype.toString.call(a)&&a.constructor===Object}function mf(a){return"boolean"==typeof a}function mg(a){return Array.isArray(a)}function mh(a){return"string"==typeof a}function mi(a){return mh(a)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(a)}let mj="object"==typeof self?self:null,mk=mj&&(mj.hasOwnProperty("AudioContext")||mj.hasOwnProperty("webkitAudioContext"));var ml=function(a,b){return(ml=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,b)},mm=function(){return(mm=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function mn(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}function mo(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d.throw(a))}catch(b){f(b)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})}function mp(a){return this instanceof mp?(this.v=a,this):new mp(a)}function mq(a){return a instanceof AudioBuffer}function mr(a,b){var c,d;return"value"===a||l0(c=b)||l_(d=b)||mq(b)}function ms(a,...b){if(!b.length)return a;let c=b.shift();if(me(a)&&me(c))for(let d in c)mr(d,c[d])?a[d]=c[d]:me(c[d])?(a[d]||Object.assign(a,{[d]:{}}),ms(a[d],c[d])):Object.assign(a,{[d]:c[d]});return ms(a,...b)}function mt(a,b,c=[],d){let e={},f=Array.from(b);if(me(f[0])&&d&&!Reflect.has(f[0],d)){let g=Object.keys(f[0]).some(b=>Reflect.has(a,b));g||(ms(e,{[d]:f[0]}),c.splice(c.indexOf(d),1),f.shift())}if(1===f.length&&me(f[0]))ms(e,f[0]);else for(let h=0;h<c.length;h++)mb(f[h])&&(e[c[h]]=f[h]);return ms(a,e)}function mu(a,b){return ma(a)?b:a}function mv(a,b){return b.forEach(b=>{Reflect.has(a,b)&&delete a[b]}),a}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */ /**
 * @class  Tone is the base class of all other classes.
 * @category Core
 * @constructor
 */ class mw{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...a){(this.debug||mj&&this.toString()===mj.TONE_DEBUG_CLASS)&&l8(this,...a)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}function mx(a,b){return a>b+1e-6}function my(a,b){return mx(a,b)||mA(a,b)}function mz(a,b){return a+1e-6<b}function mA(a,b){return 1e-6>Math.abs(a-b)}function mB(a,b,c){return Math.max(Math.min(a,c),b)}mw.version=hM;class mC extends mw{constructor(){super(),this.name="Timeline",this._timeline=[];let a=mt(mC.getDefaults(),arguments,["memory"]);this.memory=a.memory,this.increasing=a.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(a){if(l3(Reflect.has(a,"time"),"Timeline: events must have a time attribute"),a.time=a.time.valueOf(),this.increasing&&this.length){let b=this._timeline[this.length-1];l3(my(a.time,b.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(a)}else{let c=this._search(a.time);this._timeline.splice(c+1,0,a)}if(this.length>this.memory){let d=this.length-this.memory;this._timeline.splice(0,d)}return this}remove(a){let b=this._timeline.indexOf(a);return -1!==b&&this._timeline.splice(b,1),this}get(a,b="time"){let c=this._search(a,b);return -1!==c?this._timeline[c]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(a,b="time"){let c=this._search(a,b);return c+1<this._timeline.length?this._timeline[c+1]:null}getBefore(a){let b=this._timeline.length;if(b>0&&this._timeline[b-1].time<a)return this._timeline[b-1];let c=this._search(a);return c-1>=0?this._timeline[c-1]:null}cancel(a){if(this._timeline.length>1){let b=this._search(a);if(b>=0){if(mA(this._timeline[b].time,a)){for(let c=b;c>=0;c--)if(mA(this._timeline[c].time,a))b=c;else break;this._timeline=this._timeline.slice(0,b)}else this._timeline=this._timeline.slice(0,b+1)}else this._timeline=[]}else 1===this._timeline.length&&my(this._timeline[0].time,a)&&(this._timeline=[]);return this}cancelBefore(a){let b=this._search(a);return b>=0&&(this._timeline=this._timeline.slice(b+1)),this}previousEvent(a){let b=this._timeline.indexOf(a);return b>0?this._timeline[b-1]:null}_search(a,b="time"){if(0===this._timeline.length)return -1;let c=0,d=this._timeline.length,e=d;if(d>0&&this._timeline[d-1][b]<=a)return d-1;for(;c<e;){let f=Math.floor(c+(e-c)/2),g=this._timeline[f],h=this._timeline[f+1];if(mA(g[b],a)){for(let i=f;i<this._timeline.length;i++){let j=this._timeline[i];if(mA(j[b],a))f=i;else break}return f}if(mz(g[b],a)&&mx(h[b],a))return f;mx(g[b],a)?e=f:c=f+1}return -1}_iterate(a,b=0,c=this._timeline.length-1){this._timeline.slice(b,c+1).forEach(a)}forEach(a){return this._iterate(a),this}forEachBefore(a,b){let c=this._search(a);return -1!==c&&this._iterate(b,0,c),this}forEachAfter(a,b){let c=this._search(a);return this._iterate(b,c+1),this}forEachBetween(a,b,c){let d=this._search(a),e=this._search(b);return -1!==d&& -1!==e?(this._timeline[d].time!==a&&(d+=1),this._timeline[e].time===b&&(e-=1),this._iterate(c,d,e)):-1===d&&this._iterate(c,0,e),this}forEachFrom(a,b){let c=this._search(a);for(;c>=0&&this._timeline[c].time>=a;)c--;return this._iterate(b,c+1),this}forEachAtTime(a,b){let c=this._search(a);if(-1!==c&&mA(this._timeline[c].time,a)){let d=c;for(let e=c;e>=0;e--)if(mA(this._timeline[e].time,a))d=e;else break;this._iterate(a=>{b(a)},d,c)}return this}dispose(){return super.dispose(),this._timeline=[],this}}let mD=[];function mE(a){mD.push(a)}let mF=[];function mG(a){mF.push(a)}class mH extends mw{constructor(){super(...arguments),this.name="Emitter"}on(a,b){let c=a.split(/\W+/);return c.forEach(a=>{ma(this._events)&&(this._events={}),this._events.hasOwnProperty(a)||(this._events[a]=[]),this._events[a].push(b)}),this}once(a,b){let c=(...d)=>{b(...d),this.off(a,c)};return this.on(a,c),this}off(a,b){let c=a.split(/\W+/);return c.forEach(c=>{if(ma(this._events)&&(this._events={}),this._events.hasOwnProperty(a)){if(ma(b))this._events[a]=[];else{let d=this._events[a];for(let e=d.length-1;e>=0;e--)d[e]===b&&d.splice(e,1)}}}),this}emit(a,...b){if(this._events&&this._events.hasOwnProperty(a)){let c=this._events[a].slice(0);for(let d=0,e=c.length;d<e;d++)c[d].apply(this,b)}return this}static mixin(a){["on","once","off","emit"].forEach(b=>{let c=Object.getOwnPropertyDescriptor(mH.prototype,b);Object.defineProperty(a.prototype,b,c)})}dispose(){return super.dispose(),this._events=void 0,this}}class mI extends mH{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class mJ extends mI{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new mC,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;let a=mt(mJ.getDefaults(),arguments,["context",]);if(a.context)this._context=a.context;else{var b;this._context=(b={latencyHint:a.latencyHint},new lJ(b))}this._ticker=new class{constructor(a,b,c){this._callback=a,this._type=b,this._updateInterval=c,this._createClock()}_createWorker(){let a=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),b=URL.createObjectURL(a),c=new Worker(b);c.onmessage=this._callback.bind(this),this._worker=c}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(a){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(a){this._updateInterval=Math.max(a,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*a,1))}get type(){return this._type}set type(a){this._disposeClock(),this._type=a,this._createClock()}dispose(){this._disposeClock()}}(this.emit.bind(this,"tick"),a.clockSource,a.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(a.latencyHint),this.lookAhead=a.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){if(!this._initialized){var a;a=this,mD.forEach(b=>b(a)),this._initialized=!0}return this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(a,b,c){return this._context.createBuffer(a,b,c)}createChannelMerger(a){return this._context.createChannelMerger(a)}createChannelSplitter(a){return this._context.createChannelSplitter(a)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(a){return this._context.createDelay(a)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(a,b){return this._context.createIIRFilter(a,b)}createPanner(){return this._context.createPanner()}createPeriodicWave(a,b,c){return this._context.createPeriodicWave(a,b,c)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(a){var b;l3(l$(b=this._context),"Not available if OfflineAudioContext");let c=this._context;return c.createMediaStreamSource(a)}createMediaElementSource(a){var b;l3(l$(b=this._context),"Not available if OfflineAudioContext");let c=this._context;return c.createMediaElementSource(a)}createMediaStreamDestination(){var a;l3(l$(a=this._context),"Not available if OfflineAudioContext");let b=this._context;return b.createMediaStreamDestination()}decodeAudioData(a){return this._context.decodeAudioData(a)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(a){l3(!this._initialized,"The listener cannot be set after initialization."),this._listener=a}get transport(){return this.initialize(),this._transport}set transport(a){l3(!this._initialized,"The transport cannot be set after initialization."),this._transport=a}get draw(){return this.initialize(),this._draw}set draw(a){l3(!this._initialized,"Draw cannot be set after initialization."),this._draw=a}get destination(){return this.initialize(),this._destination}set destination(a){l3(!this._initialized,"The destination cannot be set after initialization."),this._destination=a}createAudioWorkletNode(a,b){var c,d,e;return c=this.rawContext,d=a,e=b,l3(mb(lW),"This node only works in a secure context (https or localhost)"),new lW(c,d,e)}addAudioWorkletModule(a,b){return mo(this,void 0,void 0,function*(){l3(mb(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(b)||this._workletModules.set(b,this.rawContext.audioWorklet.addModule(a)),yield this._workletModules.get(b)})}workletsAreReady(){return mo(this,void 0,void 0,function*(){let a=[];this._workletModules.forEach(b=>a.push(b)),yield Promise.all(a)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(a){this._ticker.updateInterval=a}get clockSource(){return this._ticker.type}set clockSource(a){this._ticker.type=a}get latencyHint(){return this._latencyHint}_setLatencyHint(a){let b=0;if(this._latencyHint=a,mh(a))switch(a){case"interactive":b=.1;break;case"playback":b=.5;break;case"balanced":b=.25}this.lookAhead=b,this.updateInterval=b/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){var a;return l$(a=this._context)?this._context.resume():Promise.resolve()}close(){return mo(this,void 0,void 0,function*(){var a,b;l$(a=this._context)&&(yield this._context.close()),this._initialized&&(b=this,mF.forEach(a=>a(b)))})}getConstant(a){if(this._constants.has(a))return this._constants.get(a);{let b=this._context.createBuffer(1,128,this._context.sampleRate),c=b.getChannelData(0);for(let d=0;d<c.length;d++)c[d]=a;let e=this._context.createBufferSource();return e.channelCount=1,e.channelCountMode="explicit",e.buffer=b,e.loop=!0,e.start(0),this._constants.set(a,e),e}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(a=>this._constants[a].disconnect()),this}_timeoutLoop(){let a=this.now(),b=this._timeouts.peek();for(;this._timeouts.length&&b&&b.time<=a;)b.callback(),this._timeouts.shift(),b=this._timeouts.peek()}setTimeout(a,b){this._timeoutIds++;let c=this.now();return this._timeouts.add({callback:a,id:this._timeoutIds,time:c+b}),this._timeoutIds}clearTimeout(a){return this._timeouts.forEach(b=>{b.id===a&&this._timeouts.remove(b)}),this}clearInterval(a){return this.clearTimeout(a)}setInterval(a,b){let c=++this._timeoutIds,d=()=>{let e=this.now();this._timeouts.add({callback:()=>{a(),d()},id:c,time:e+b})};return d(),c}}function mK(a,b){mg(b)?b.forEach(b=>mK(a,b)):Object.defineProperty(a,b,{enumerable:!0,writable:!1})}function mL(a,b){mg(b)?b.forEach(b=>mL(a,b)):Object.defineProperty(a,b,{writable:!0})}let mM=()=>{};class mN extends mw{constructor(){super(),this.name="ToneAudioBuffer",this.onload=mM;let a=mt(mN.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=a.reverse,this.onload=a.onload,a.url&&mq(a.url)||a.url instanceof mN?this.set(a.url):mh(a.url)&&this.load(a.url).catch(a.onerror)}static getDefaults(){return{onerror:mM,onload:mM,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:mR().sampleRate}set(a){return a instanceof mN?a.loaded?this._buffer=a.get():a.onload=()=>{this.set(a),this.onload(this)}:this._buffer=a,this._reversed&&this._reverse(),this}get(){return this._buffer}load(a){return mo(this,void 0,void 0,function*(){let b=mN.load(a).then(a=>{this.set(a),this.onload(this)});mN.downloads.push(b);try{yield b}finally{let c=mN.downloads.indexOf(b);mN.downloads.splice(c,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(a){let b=mg(a)&&a[0].length>0,c=b?a.length:1,d=b?a[0].length:a.length,e=mR(),f=e.createBuffer(c,d,e.sampleRate),g=b||1!==c?a:[a];for(let h=0;h<c;h++)f.copyToChannel(g[h],h);return this._buffer=f,this}toMono(a){if(md(a))this.fromArray(this.toArray(a));else{let b=new Float32Array(this.length),c=this.numberOfChannels;for(let d=0;d<c;d++){let e=this.toArray(d);for(let f=0;f<e.length;f++)b[f]+=e[f]}b=b.map(a=>a/c),this.fromArray(b)}return this}toArray(a){if(md(a))return this.getChannelData(a);if(1===this.numberOfChannels)return this.toArray(0);{let b=[];for(let c=0;c<this.numberOfChannels;c++)b[c]=this.getChannelData(c);return b}}getChannelData(a){return this._buffer?this._buffer.getChannelData(a):new Float32Array(0)}slice(a,b=this.duration){let c=Math.floor(a*this.sampleRate),d=Math.floor(b*this.sampleRate);l3(c<d,"The start time must be less than the end time");let e=mR().createBuffer(this.numberOfChannels,d-c,this.sampleRate);for(let f=0;f<this.numberOfChannels;f++)e.copyToChannel(this.getChannelData(f).subarray(c,d),f);return new mN(e)}_reverse(){if(this.loaded)for(let a=0;a<this.numberOfChannels;a++)this.getChannelData(a).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(a){this._reversed!==a&&(this._reversed=a,this._reverse())}static fromArray(a){return new mN().fromArray(a)}static fromUrl(a){return mo(this,void 0,void 0,function*(){let b=new mN;return yield b.load(a)})}static load(a){return mo(this,void 0,void 0,function*(){let b=a.match(/\[([^\]\[]+\|.+)\]$/);if(b){let c=b[1].split("|"),d=c[0];for(let e of c)if(mN.supportsType(e)){d=e;break}a=a.replace(b[0],d)}let f=""===mN.baseUrl||mN.baseUrl.endsWith("/")?mN.baseUrl:mN.baseUrl+"/",g=yield fetch(f+a);if(!g.ok)throw Error(`could not load url: ${a}`);let h=yield g.arrayBuffer(),i=yield mR().decodeAudioData(h);return i})}static supportsType(a){let b=a.split("."),c=b[b.length-1],d=document.createElement("audio").canPlayType("audio/"+c);return""!==d}static loaded(){return mo(this,void 0,void 0,function*(){for(yield Promise.resolve();mN.downloads.length;)yield mN.downloads[0]})}}mN.baseUrl="",mN.downloads=[];class mO extends mJ{constructor(){var a,b,c,d,e,f;super({clockSource:"offline",context:(a=arguments[0],l1(a))?arguments[0]:(b=arguments[0],c=arguments[1]*arguments[2],d=arguments[2],new lZ(b,c,d)),lookAhead:0,updateInterval:(e=arguments[0],l1(e))?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,f=arguments[0],this._duration=l1(f)?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(a){return mo(this,void 0,void 0,function*(){let b=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,b++;let c=Math.floor(this.sampleRate/128);a&&b%c==0&&(yield new Promise(a=>setTimeout(a,1)))}})}render(a=!0){return mo(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(a);let b=yield this._context.startRendering();return new mN(b)})}close(){return Promise.resolve()}}let mP=new class extends mI{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(a,b,c){return{}}createChannelMerger(a){return{}}createChannelSplitter(a){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(a){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(a,b){return{}}createPanner(){return{}}createPeriodicWave(a,b,c){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(a){return{}}createMediaElementSource(a){return{}}createMediaStreamDestination(){return{}}decodeAudioData(a){return Promise.resolve({})}createAudioWorkletNode(a,b){return{}}get rawContext(){return{}}addAudioWorkletModule(a,b){return mo(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(a,b){return 0}clearTimeout(a){return this}setInterval(a,b){return 0}clearInterval(a){return this}getConstant(a){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(a){}get destination(){return{}}set destination(a){}now(){return 0}immediate(){return 0}},mQ=mP;function mR(){return mQ===mP&&mk&&mS(new mJ),mQ}function mS(a){var b,c;mQ=l$(b=a)?new mJ(a):l1(c=a)?new mO(a):a}function mT(){return mQ.resume()}if(mj&&!mj.TONE_SILENCE_LOGGING){let mU="v";"dev"===hM&&(mU="");let mV=` * Tone.js ${mU}${hM} * `;console.log(`%c${mV}`,"background: #000; color: #fff")}function mW(a){return Math.pow(10,a/20)}function mX(a){return 20*(Math.log(a)/Math.LN10)}function mY(a){return Math.pow(2,a/12)}let mZ=440;function m$(a){return Math.round(m_(a))}function m_(a){return 69+12*Math.log2(a/mZ)}function m0(a){return mZ*Math.pow(2,(a-69)/12)}class m1 extends mw{constructor(a,b,c){super(),this.defaultUnits="s",this._val=b,this._units=c,this.context=a,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:a=>this._frequencyToUnits(parseFloat(a)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:a=>this._ticksToUnits(parseInt(a,10)),regexp:/^(\d+)i$/i},m:{method:a=>this._beatsToUnits(parseInt(a,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(a,b)=>{let c=parseInt(a,10),d="."===b?1.5:1;return 1===c?this._beatsToUnits(this._getTimeSignature())*d:this._beatsToUnits(4/c)*d},regexp:/^(\d+)n(\.?)$/i},number:{method:a=>this._expressions[this.defaultUnits].method.call(this,a),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:a=>this._secondsToUnits(parseFloat(a)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:a=>parseInt(a,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:a=>{let b=parseInt(a,10);return this._beatsToUnits(8/(3*Math.floor(b)))},regexp:/^(\d+)t$/i},tr:{method:(a,b,c)=>{let d=0;return a&&"0"!==a&&(d+=this._beatsToUnits(this._getTimeSignature()*parseFloat(a))),b&&"0"!==b&&(d+=this._beatsToUnits(parseFloat(b))),c&&"0"!==c&&(d+=this._beatsToUnits(parseFloat(c)/4)),d},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof m1&&this.fromType(this._val),ma(this._val))return this._noArg();if(mh(this._val)&&ma(this._units)){for(let a in this._expressions)if(this._expressions[a].regexp.test(this._val.trim())){this._units=a;break}}else if(me(this._val)){let b=0;for(let c in this._val)if(mb(this._val[c])){let d=this._val[c],e=new this.constructor(this.context,c).valueOf()*d;b+=e}return b}if(mb(this._units)){let f=this._expressions[this._units],g=this._val.toString().trim().match(f.regexp);return g?f.method.apply(this,g.slice(1)):f.method.call(this,this._val)}return mh(this._val)?parseFloat(this._val):(0,this._val)}_frequencyToUnits(a){return 1/a}_beatsToUnits(a){return 60/this._getBpm()*a}_secondsToUnits(a){return a}_ticksToUnits(a){return a*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(a){switch(this._units=void 0,this.defaultUnits){case"s":this._val=a.toSeconds();break;case"i":this._val=a.toTicks();break;case"hz":this._val=a.toFrequency();break;case"midi":this._val=a.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class m2 extends m1{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:a=>this._now()+new this.constructor(this.context,a).valueOf(),regexp:/^\+(.+)/},quantize:{method:a=>{let b=new m2(this.context,a).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(b))},regexp:/^@(.+)/}})}quantize(a,b=1){let c=new this.constructor(this.context,a).valueOf(),d=this.valueOf();return d+(Math.round(d/c)*c-d)*b}toNotation(){let a=this.toSeconds(),b=["1m"];for(let c=1;c<9;c++){let d=Math.pow(2,c);b.push(d+"n."),b.push(d+"n"),b.push(d+"t")}b.push("0");let e=b[0],f=new m2(this.context,b[0]).toSeconds();return b.forEach(b=>{let c=new m2(this.context,b).toSeconds();Math.abs(c-a)<Math.abs(f-a)&&(e=b,f=c)}),e}toBarsBeatsSixteenths(){let a=this._beatsToUnits(1),b=this.valueOf()/a;b=parseFloat(b.toFixed(4));let c=Math.floor(b/this._getTimeSignature()),d=b%1*4;b=Math.floor(b)%this._getTimeSignature();let e=d.toString();e.length>3&&(d=parseFloat(parseFloat(e).toFixed(3)));let f=[c,b,d];return f.join(":")}toTicks(){let a=this._beatsToUnits(1),b=this.valueOf()/a;return Math.round(b*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return m$(this.toFrequency())}_now(){return this.context.now()}}function m3(a,b){return new m2(mR(),a,b)}class m4 extends m2{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return mZ}static set A4(a){var b;mZ=b=a}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(a){return"midi"===this.defaultUnits?a:m4.mtof(a)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(a,b){let c=m5[a.toLowerCase()],d=c+(parseInt(b,10)+1)*12;return"midi"===this.defaultUnits?d:m4.mtof(d)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(a,b,c){let d=1;return a&&"0"!==a&&(d*=this._beatsToUnits(this._getTimeSignature()*parseFloat(a))),b&&"0"!==b&&(d*=this._beatsToUnits(parseFloat(b))),c&&"0"!==c&&(d*=this._beatsToUnits(parseFloat(c)/4)),d}}})}transpose(a){return new m4(this.context,this.valueOf()*mY(a))}harmonize(a){return a.map(a=>this.transpose(a))}toMidi(){return m$(this.valueOf())}toNote(){let a=this.toFrequency(),b=Math.log2(a/m4.A4),c=Math.round(12*b)+57,d=Math.floor(c/12);d<0&&(c+=-12*d);let e=m6[c%12];return e+d.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let a=this._beatsToUnits(1),b=this.valueOf()/a;return Math.floor(b*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(a){return a}_ticksToUnits(a){return 1/(60*a/(this._getBpm()*this._getPPQ()))}_beatsToUnits(a){return 1/super._beatsToUnits(a)}_secondsToUnits(a){return 1/a}static mtof(a){return m0(a)}static ftom(a){return m$(a)}}let m5={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},m6=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function m7(a,b){return new m4(mR(),a,b)}class m8 extends m2{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function m9(a,b){return new m8(mR(),a,b)}class na extends mw{constructor(){super();let a=mt(na.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=a.context}static getDefaults(){return{context:mR()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(a){return new m2(this.context,a).toSeconds()}toFrequency(a){return new m4(this.context,a).toFrequency()}toTicks(a){return new m8(this.context,a).toTicks()}_getPartialProperties(a){let b=this.get();return Object.keys(b).forEach(c=>{ma(a[c])&&delete b[c]}),b}get(){var a;let b=(a=this,a.constructor.getDefaults());return Object.keys(b).forEach(a=>{if(Reflect.has(this,a)){let c=this[a];mb(c)&&mb(c.value)&&mb(c.setValueAtTime)?b[a]=c.value:c instanceof na?b[a]=c._getPartialProperties(b[a]):mg(c)||md(c)||mh(c)||mf(c)?b[a]=c:delete b[a]}}),b}set(a){return Object.keys(a).forEach(b=>{Reflect.has(this,b)&&mb(this[b])&&(this[b]&&mb(this[b].value)&&mb(this[b].setValueAtTime)?this[b].value!==a[b]&&(this[b].value=a[b]):this[b]instanceof na?this[b].set(a[b]):this[b]=a[b])}),this}}class nb extends mC{constructor(a="stopped"){super(),this.name="StateTimeline",this._initial=a,this.setStateAtTime(this._initial,0)}getValueAtTime(a){let b=this.get(a);return null!==b?b.state:this._initial}setStateAtTime(a,b,c){return l4(b,0),this.add(Object.assign({},c,{state:a,time:b})),this}getLastState(a,b){let c=this._search(b);for(let d=c;d>=0;d--){let e=this._timeline[d];if(e.state===a)return e}}getNextState(a,b){let c=this._search(b);if(-1!==c)for(let d=c;d<this._timeline.length;d++){let e=this._timeline[d];if(e.state===a)return e}}}class nc extends na{constructor(){var a,b;super(mt(nc.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;let c=mt(nc.getDefaults(),arguments,["param","units","convert"]);for(l3(mb(c.param)&&(l0(a=c.param)||c.param instanceof nc),"param must be an AudioParam");!l0(b=c.param);)c.param=c.param._param;this._swappable=!!mb(c.swappable)&&c.swappable,this._swappable?(this.input=this.context.createGain(),this._param=c.param,this.input.connect(this._param)):this._param=this.input=c.param,this._events=new mC(1e3),this._initialValue=this._param.defaultValue,this.units=c.units,this.convert=c.convert,this._minValue=c.minValue,this._maxValue=c.maxValue,mb(c.value)&&c.value!==this._toType(this._initialValue)&&this.setValueAtTime(c.value,0)}static getDefaults(){return Object.assign(na.getDefaults(),{convert:!0,units:"number"})}get value(){let a=this.now();return this.getValueAtTime(a)}set value(a){this.cancelScheduledValues(this.now()),this.setValueAtTime(a,this.now())}get minValue(){return mb(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return mb(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(a,b){return this.units===b}_assertRange(a){return mb(this.maxValue)&&mb(this.minValue)&&l4(a,this._fromType(this.minValue),this._fromType(this.maxValue)),a}_fromType(a){if(this.convert&&!this.overridden)return this._is(a,"time")?this.toSeconds(a):this._is(a,"decibels")?mW(a):this._is(a,"frequency")?this.toFrequency(a):a;return this.overridden?0:a}_toType(a){return this.convert&&"decibels"===this.units?mX(a):a}setValueAtTime(a,b){let c=this.toSeconds(b),d=this._fromType(a);return l3(isFinite(d)&&isFinite(c),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(a)}, ${JSON.stringify(b)}`),this._assertRange(d),this.log(this.units,"setValueAtTime",a,c),this._events.add({time:c,type:"setValueAtTime",value:d}),this._param.setValueAtTime(d,c),this}getValueAtTime(a){let b=Math.max(this.toSeconds(a),0),c=this._events.getAfter(b),d=this._events.get(b),e=this._initialValue;if(null===d)e=this._initialValue;else if("setTargetAtTime"===d.type&&(null===c||"setValueAtTime"===c.type)){let f=this._events.getBefore(d.time),g;g=null===f?this._initialValue:f.value,"setTargetAtTime"===d.type&&(e=this._exponentialApproach(d.time,g,d.value,d.constant,b))}else if(null===c)e=d.value;else if("linearRampToValueAtTime"===c.type||"exponentialRampToValueAtTime"===c.type){let h=d.value;if("setTargetAtTime"===d.type){let i=this._events.getBefore(d.time);h=null===i?this._initialValue:i.value}e="linearRampToValueAtTime"===c.type?this._linearInterpolate(d.time,h,c.time,c.value,b):this._exponentialInterpolate(d.time,h,c.time,c.value,b)}else e=d.value;return this._toType(e)}setRampPoint(a){a=this.toSeconds(a);let b=this.getValueAtTime(a);return this.cancelAndHoldAtTime(a),0===this._fromType(b)&&(b=this._toType(this._minOutput)),this.setValueAtTime(b,a),this}linearRampToValueAtTime(a,b){let c=this._fromType(a),d=this.toSeconds(b);return l3(isFinite(c)&&isFinite(d),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(a)}, ${JSON.stringify(b)}`),this._assertRange(c),this._events.add({time:d,type:"linearRampToValueAtTime",value:c}),this.log(this.units,"linearRampToValueAtTime",a,d),this._param.linearRampToValueAtTime(c,d),this}exponentialRampToValueAtTime(a,b){let c=this._fromType(a);c=mA(c,0)?this._minOutput:c,this._assertRange(c);let d=this.toSeconds(b);return l3(isFinite(c)&&isFinite(d),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(a)}, ${JSON.stringify(b)}`),this._events.add({time:d,type:"exponentialRampToValueAtTime",value:c}),this.log(this.units,"exponentialRampToValueAtTime",a,d),this._param.exponentialRampToValueAtTime(c,d),this}exponentialRampTo(a,b,c){return c=this.toSeconds(c),this.setRampPoint(c),this.exponentialRampToValueAtTime(a,c+this.toSeconds(b)),this}linearRampTo(a,b,c){return c=this.toSeconds(c),this.setRampPoint(c),this.linearRampToValueAtTime(a,c+this.toSeconds(b)),this}targetRampTo(a,b,c){return c=this.toSeconds(c),this.setRampPoint(c),this.exponentialApproachValueAtTime(a,c,b),this}exponentialApproachValueAtTime(a,b,c){b=this.toSeconds(b),c=this.toSeconds(c);let d=Math.log(c+1)/Math.log(200);return this.setTargetAtTime(a,b,d),this.cancelAndHoldAtTime(b+.9*c),this.linearRampToValueAtTime(a,b+c),this}setTargetAtTime(a,b,c){let d=this._fromType(a);l3(isFinite(c)&&c>0,"timeConstant must be a number greater than 0");let e=this.toSeconds(b);return this._assertRange(d),l3(isFinite(d)&&isFinite(e),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(a)}, ${JSON.stringify(b)}`),this._events.add({constant:c,time:e,type:"setTargetAtTime",value:d}),this.log(this.units,"setTargetAtTime",a,e,c),this._param.setTargetAtTime(d,e,c),this}setValueCurveAtTime(a,b,c,d=1){c=this.toSeconds(c),b=this.toSeconds(b);let e=this._fromType(a[0])*d;this.setValueAtTime(this._toType(e),b);let f=c/(a.length-1);for(let g=1;g<a.length;g++){let h=this._fromType(a[g])*d;this.linearRampToValueAtTime(this._toType(h),b+g*f)}return this}cancelScheduledValues(a){let b=this.toSeconds(a);return l3(isFinite(b),`Invalid argument to cancelScheduledValues: ${JSON.stringify(a)}`),this._events.cancel(b),this._param.cancelScheduledValues(b),this.log(this.units,"cancelScheduledValues",b),this}cancelAndHoldAtTime(a){let b=this.toSeconds(a),c=this._fromType(this.getValueAtTime(b));l3(isFinite(b),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(a)}`),this.log(this.units,"cancelAndHoldAtTime",b,"value="+c);let d=this._events.get(b),e=this._events.getAfter(b);return d&&mA(d.time,b)?e?(this._param.cancelScheduledValues(e.time),this._events.cancel(e.time)):(this._param.cancelAndHoldAtTime(b),this._events.cancel(b+this.sampleTime)):e&&(this._param.cancelScheduledValues(e.time),this._events.cancel(e.time),"linearRampToValueAtTime"===e.type?this.linearRampToValueAtTime(this._toType(c),b):"exponentialRampToValueAtTime"===e.type&&this.exponentialRampToValueAtTime(this._toType(c),b)),this._events.add({time:b,type:"setValueAtTime",value:c}),this._param.setValueAtTime(c,b),this}rampTo(a,b=.1,c){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(a,b,c):this.linearRampTo(a,b,c),this}apply(a){let b=this.context.currentTime;a.setValueAtTime(this.getValueAtTime(b),b);let c=this._events.get(b);if(c&&"setTargetAtTime"===c.type){let d=this._events.getAfter(c.time),e=d?d.time:b+2,f=(e-b)/10;for(let g=b;g<e;g+=f)a.linearRampToValueAtTime(this.getValueAtTime(g),g)}return this._events.forEachAfter(this.context.currentTime,b=>{"cancelScheduledValues"===b.type?a.cancelScheduledValues(b.time):"setTargetAtTime"===b.type?a.setTargetAtTime(b.value,b.time,b.constant):a[b.type](b.value,b.time)}),this}setParam(a){l3(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let b=this.input;return b.disconnect(this._param),this.apply(a),this._param=a,b.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(a,b,c,d,e){return c+(b-c)*Math.exp(-(e-a)/d)}_linearInterpolate(a,b,c,d,e){return b+(d-b)*((e-a)/(c-a))}_exponentialInterpolate(a,b,c,d,e){return b*Math.pow(d/b,(e-a)/(c-a))}}class nd extends na{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){var a;return mb(this.input)?l0(a=this.input)||this.input instanceof nc?1:this.input.numberOfInputs:0}get numberOfOutputs(){return mb(this.output)?this.output.numberOfOutputs:0}_isAudioNode(a){var b;return mb(a)&&(a instanceof nd||l_(b=a))}_getInternalNodes(){let a=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&a.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&a.push(this.output),a}_setChannelProperties(a){let b=this._getInternalNodes();b.forEach(b=>{b.channelCount=a.channelCount,b.channelCountMode=a.channelCountMode,b.channelInterpretation=a.channelInterpretation})}_getChannelProperties(){let a=this._getInternalNodes();l3(a.length>0,"ToneAudioNode does not have any internal nodes");let b=a[0];return{channelCount:b.channelCount,channelCountMode:b.channelCountMode,channelInterpretation:b.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(a){let b=this._getChannelProperties();this._setChannelProperties(Object.assign(b,{channelCount:a}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(a){let b=this._getChannelProperties();this._setChannelProperties(Object.assign(b,{channelCountMode:a}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(a){let b=this._getChannelProperties();this._setChannelProperties(Object.assign(b,{channelInterpretation:a}))}connect(a,b=0,c=0){return nf(this,a,b,c),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return l9("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(a,b=0,c=0){return ng(this,a,b,c),this}chain(...a){return ne(this,...a),this}fan(...a){return a.forEach(a=>this.connect(a)),this}dispose(){var a,b;return super.dispose(),mb(this.input)&&(this.input instanceof nd?this.input.dispose():l_(a=this.input)&&this.input.disconnect()),mb(this.output)&&(this.output instanceof nd?this.output.dispose():l_(b=this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function ne(...a){let b=a.shift();a.reduce((a,b)=>{if(a instanceof nd)a.connect(b);else{var c;l_(c=a)&&nf(a,b)}return b},b)}function nf(a,b,c=0,d=0){var e,f;for(l3(mb(a),"Cannot connect from undefined node"),l3(mb(b),"Cannot connect to undefined node"),(b instanceof nd||l_(e=b))&&l3(b.numberOfInputs>0,"Cannot connect to node with no inputs"),l3(a.numberOfOutputs>0,"Cannot connect from node with no outputs");b instanceof nd||b instanceof nc;)mb(b.input)&&(b=b.input);for(;a instanceof nd;)mb(a.output)&&(a=a.output);l0(f=b)?a.connect(b,c):a.connect(b,c,d)}function ng(a,b,c=0,d=0){var e,f,g;if(mb(b))for(;b instanceof nd;)b=b.input;for(;!l_(e=a);)mb(a.output)&&(a=a.output);l0(f=b)?a.disconnect(b,c):l_(g=b)?a.disconnect(b,c,d):a.disconnect()}class nh extends nd{constructor(){super(mt(nh.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let a=mt(nh.getDefaults(),arguments,["gain","units"]);this.gain=new nc({context:this.context,convert:a.convert,param:this._gainNode.gain,units:a.units,value:a.gain,minValue:a.minValue,maxValue:a.maxValue}),mK(this,"gain")}static getDefaults(){return Object.assign(nd.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class ni extends nd{constructor(a){super(a),this.onended=mM,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new nh({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(a){let b=this.toSeconds(a);return -1!==this._startTime&&b>=this._startTime&&(-1===this._stopTime||b<=this._stopTime)?"started":"stopped"},this._fadeIn=a.fadeIn,this._fadeOut=a.fadeOut,this._curve=a.curve,this.onended=a.onended}static getDefaults(){return Object.assign(nd.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:mM})}_startGain(a,b=1){l3(-1===this._startTime,"Source cannot be started more than once");let c=this.toSeconds(this._fadeIn);return this._startTime=a+c,this._startTime=Math.max(this._startTime,this.context.currentTime),c>0?(this._gainNode.gain.setValueAtTime(0,a),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(b,a+c):this._gainNode.gain.exponentialApproachValueAtTime(b,a,c)):this._gainNode.gain.setValueAtTime(b,a),this}stop(a){return this.log("stop",a),this._stopGain(this.toSeconds(a)),this}_stopGain(a){l3(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();let b=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(a)+b,this._stopTime=Math.max(this._stopTime,this.context.currentTime),b>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,b,a):this._gainNode.gain.targetRampTo(0,b,a):(this._gainNode.gain.cancelAndHoldAtTime(a),this._gainNode.gain.setValueAtTime(0,a)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let a="exponential"===this._curve?2*b:0;this._stopSource(this.now()+a),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==mM&&(this.onended(this),this.onended=mM,!this.context.isOffline)){let a=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(a):setTimeout(a,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),l3(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class nj extends ni{constructor(){super(mt(nj.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();let a=mt(nj.getDefaults(),arguments,["offset"]);nf(this._source,this._gainNode),this.offset=new nc({context:this.context,convert:a.convert,param:this._source.offset,units:a.units,value:a.offset,minValue:a.minValue,maxValue:a.maxValue})}static getDefaults(){return Object.assign(ni.getDefaults(),{convert:!0,offset:1,units:"number"})}start(a){let b=this.toSeconds(a);return this.log("start",b),this._startGain(b),this._source.start(b),this}_stopSource(a){this._source.stop(a)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class nk extends nd{constructor(){super(mt(nk.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;let a=mt(nk.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new nj({context:this.context,convert:a.convert,offset:a.value,units:a.units,minValue:a.minValue,maxValue:a.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(nd.getDefaults(),{convert:!0,units:"number",value:0})}connect(a,b=0,c=0){return nl(this,a,b,c),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(a,b){return this._param.setValueAtTime(a,b),this}getValueAtTime(a){return this._param.getValueAtTime(a)}setRampPoint(a){return this._param.setRampPoint(a),this}linearRampToValueAtTime(a,b){return this._param.linearRampToValueAtTime(a,b),this}exponentialRampToValueAtTime(a,b){return this._param.exponentialRampToValueAtTime(a,b),this}exponentialRampTo(a,b,c){return this._param.exponentialRampTo(a,b,c),this}linearRampTo(a,b,c){return this._param.linearRampTo(a,b,c),this}targetRampTo(a,b,c){return this._param.targetRampTo(a,b,c),this}exponentialApproachValueAtTime(a,b,c){return this._param.exponentialApproachValueAtTime(a,b,c),this}setTargetAtTime(a,b,c){return this._param.setTargetAtTime(a,b,c),this}setValueCurveAtTime(a,b,c,d){return this._param.setValueCurveAtTime(a,b,c,d),this}cancelScheduledValues(a){return this._param.cancelScheduledValues(a),this}cancelAndHoldAtTime(a){return this._param.cancelAndHoldAtTime(a),this}rampTo(a,b,c){return this._param.rampTo(a,b,c),this}get value(){return this._param.value}set value(a){this._param.value=a}get convert(){return this._param.convert}set convert(a){this._param.convert=a}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(a){this._param.overridden=a}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(a){return this._param.apply(a),this}}function nl(a,b,c,d){var e;(b instanceof nc||l0(e=b)||b instanceof nk&&b.override)&&(b.cancelScheduledValues(0),b.setValueAtTime(0,0),b instanceof nk&&(b.overridden=!0)),nf(a,b,c,d)}class nm extends nc{constructor(){super(mt(nm.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new mC(1/0),this._multiplier=1;let a=mt(nm.getDefaults(),arguments,["value"]);this._multiplier=a.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(a.value)}),this.setValueAtTime(a.value,0)}static getDefaults(){return Object.assign(nc.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(a,b,c){b=this.toSeconds(b),this.setRampPoint(b);let d=this._fromType(a),e=this._events.get(b),f=Math.round(Math.max(1/c,1));for(let g=0;g<=f;g++){let h=c*g+b,i=this._exponentialApproach(e.time,e.value,d,c,h);this.linearRampToValueAtTime(this._toType(i),h)}return this}setValueAtTime(a,b){let c=this.toSeconds(b);super.setValueAtTime(a,b);let d=this._events.get(c),e=this._events.previousEvent(d),f=this._getTicksUntilEvent(e,c);return d.ticks=Math.max(f,0),this}linearRampToValueAtTime(a,b){let c=this.toSeconds(b);super.linearRampToValueAtTime(a,b);let d=this._events.get(c),e=this._events.previousEvent(d),f=this._getTicksUntilEvent(e,c);return d.ticks=Math.max(f,0),this}exponentialRampToValueAtTime(a,b){b=this.toSeconds(b);let c=this._fromType(a),d=this._events.get(b),e=Math.round(Math.max((b-d.time)*10,1)),f=(b-d.time)/e;for(let g=0;g<=e;g++){let h=f*g+d.time,i=this._exponentialInterpolate(d.time,d.value,b,c,h);this.linearRampToValueAtTime(this._toType(i),h)}return this}_getTicksUntilEvent(a,b){if(null===a)a={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ma(a.ticks)){let c=this._events.previousEvent(a);a.ticks=this._getTicksUntilEvent(c,a.time)}let d=this._fromType(this.getValueAtTime(a.time)),e=this._fromType(this.getValueAtTime(b)),f=this._events.get(b);return f&&f.time===b&&"setValueAtTime"===f.type&&(e=this._fromType(this.getValueAtTime(b-this.sampleTime))),.5*(b-a.time)*(d+e)+a.ticks}getTicksAtTime(a){let b=this.toSeconds(a),c=this._events.get(b);return Math.max(this._getTicksUntilEvent(c,b),0)}getDurationOfTicks(a,b){let c=this.toSeconds(b),d=this.getTicksAtTime(b);return this.getTimeOfTick(d+a)-c}getTimeOfTick(a){let b=this._events.get(a,"ticks"),c=this._events.getAfter(a,"ticks");if(b&&b.ticks===a)return b.time;if(b&&c&&"linearRampToValueAtTime"===c.type&&b.value!==c.value){let d=this._fromType(this.getValueAtTime(b.time)),e=this._fromType(this.getValueAtTime(c.time)),f=(e-d)/(c.time-b.time),g=Math.sqrt(Math.pow(d,2)-2*f*(b.ticks-a)),h=(-d+g)/f,i=(-d-g)/f;return(h>0?h:i)+b.time}return b?0===b.value?1/0:b.time+(a-b.ticks)/b.value:a/this._initialValue}ticksToTime(a,b){return this.getDurationOfTicks(a,b)}timeToTicks(a,b){let c=this.toSeconds(b),d=this.toSeconds(a),e=this.getTicksAtTime(c),f=this.getTicksAtTime(c+d);return f-e}_fromType(a){return"bpm"===this.units&&this.multiplier?1/(60/a/this.multiplier):super._fromType(a)}_toType(a){return"bpm"===this.units&&this.multiplier?a/this.multiplier*60:super._toType(a)}get multiplier(){return this._multiplier}set multiplier(a){let b=this.value;this._multiplier=a,this.cancelScheduledValues(0),this.setValueAtTime(b,0)}}class nn extends nk{constructor(){super(mt(nn.getDefaults(),arguments,["value"])),this.name="TickSignal";let a=mt(nn.getDefaults(),arguments,["value"]);this.input=this._param=new nm({context:this.context,convert:a.convert,multiplier:a.multiplier,param:this._constantSource.offset,units:a.units,value:a.value})}static getDefaults(){return Object.assign(nk.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(a,b){return this._param.ticksToTime(a,b)}timeToTicks(a,b){return this._param.timeToTicks(a,b)}getTimeOfTick(a){return this._param.getTimeOfTick(a)}getDurationOfTicks(a,b){return this._param.getDurationOfTicks(a,b)}getTicksAtTime(a){return this._param.getTicksAtTime(a)}get multiplier(){return this._param.multiplier}set multiplier(a){this._param.multiplier=a}dispose(){return super.dispose(),this._param.dispose(),this}}class no extends na{constructor(){super(mt(no.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new nb,this._tickOffset=new mC;let a=mt(no.getDefaults(),arguments,["frequency"]);this.frequency=new nn({context:this.context,units:a.units,value:a.frequency}),mK(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},na.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(a,b){let c=this.toSeconds(a);return"started"!==this._state.getValueAtTime(c)&&(this._state.setStateAtTime("started",c),mb(b)&&this.setTicksAtTime(b,c)),this}stop(a){let b=this.toSeconds(a);if("stopped"===this._state.getValueAtTime(b)){let c=this._state.get(b);c&&c.time>0&&(this._tickOffset.cancel(c.time),this._state.cancel(c.time))}return this._state.cancel(b),this._state.setStateAtTime("stopped",b),this.setTicksAtTime(0,b),this}pause(a){let b=this.toSeconds(a);return"started"===this._state.getValueAtTime(b)&&this._state.setStateAtTime("paused",b),this}cancel(a){return a=this.toSeconds(a),this._state.cancel(a),this._tickOffset.cancel(a),this}getTicksAtTime(a){let b=this.toSeconds(a),c=this._state.getLastState("stopped",b),d={state:"paused",time:b};this._state.add(d);let e=c,f=0;return this._state.forEachBetween(c.time,b+this.sampleTime,a=>{let b=e.time,c=this._tickOffset.get(a.time);c&&c.time>=e.time&&(f=c.ticks,b=c.time),"started"===e.state&&"started"!==a.state&&(f+=this.frequency.getTicksAtTime(a.time)-this.frequency.getTicksAtTime(b)),e=a}),this._state.remove(d),f}get ticks(){return this.getTicksAtTime(this.now())}set ticks(a){this.setTicksAtTime(a,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(a){let b=this.now(),c=this.frequency.timeToTicks(a,b);this.setTicksAtTime(c,b)}getSecondsAtTime(a){a=this.toSeconds(a);let b=this._state.getLastState("stopped",a),c={state:"paused",time:a};this._state.add(c);let d=b,e=0;return this._state.forEachBetween(b.time,a+this.sampleTime,a=>{let b=d.time,c=this._tickOffset.get(a.time);c&&c.time>=d.time&&(e=c.seconds,b=c.time),"started"===d.state&&"started"!==a.state&&(e+=a.time-b),d=a}),this._state.remove(c),e}setTicksAtTime(a,b){return b=this.toSeconds(b),this._tickOffset.cancel(b),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(a,b),ticks:a,time:b}),this}getStateAtTime(a){return a=this.toSeconds(a),this._state.getValueAtTime(a)}getTimeOfTick(a,b=this.now()){let c=this._tickOffset.get(b),d=this._state.get(b),e=Math.max(c.time,d.time),f=this.frequency.getTicksAtTime(e)+a-c.ticks;return this.frequency.getTimeOfTick(f)}forEachTickBetween(a,b,c){let d=this._state.get(a);this._state.forEachBetween(a,b,b=>{d&&"started"===d.state&&"started"!==b.state&&this.forEachTickBetween(Math.max(d.time,a),b.time-this.sampleTime,c),d=b});let e=null;if(d&&"started"===d.state){let f=Math.max(d.time,a),g=this.frequency.getTicksAtTime(f),h=this.frequency.getTicksAtTime(d.time),i=g-h,j=Math.ceil(i)-i;j=mA(j,1)?0:j;let k=this.frequency.getTimeOfTick(g+j);for(;k<b;){try{c(k,Math.round(this.getTicksAtTime(k)))}catch(l){e=l;break}k+=this.frequency.getDurationOfTicks(1,k)}}if(e)throw e;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class np extends na{constructor(){super(mt(np.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=mM,this._lastUpdate=0,this._state=new nb("stopped"),this._boundLoop=this._loop.bind(this);let a=mt(np.getDefaults(),arguments,["callback","frequency"]);this.callback=a.callback,this._tickSource=new no({context:this.context,frequency:a.frequency,units:a.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,mK(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(na.getDefaults(),{callback:mM,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(a,b){l5(this.context);let c=this.toSeconds(a);return this.log("start",c),"started"!==this._state.getValueAtTime(c)&&(this._state.setStateAtTime("started",c),this._tickSource.start(c,b),c<this._lastUpdate&&this.emit("start",c,b)),this}stop(a){let b=this.toSeconds(a);return this.log("stop",b),this._state.cancel(b),this._state.setStateAtTime("stopped",b),this._tickSource.stop(b),b<this._lastUpdate&&this.emit("stop",b),this}pause(a){let b=this.toSeconds(a);return"started"===this._state.getValueAtTime(b)&&(this._state.setStateAtTime("paused",b),this._tickSource.pause(b),b<this._lastUpdate&&this.emit("pause",b)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(a){this._tickSource.ticks=a}get seconds(){return this._tickSource.seconds}set seconds(a){this._tickSource.seconds=a}getSecondsAtTime(a){return this._tickSource.getSecondsAtTime(a)}setTicksAtTime(a,b){return this._tickSource.setTicksAtTime(a,b),this}getTimeOfTick(a,b=this.now()){return this._tickSource.getTimeOfTick(a,b)}getTicksAtTime(a){return this._tickSource.getTicksAtTime(a)}nextTickTime(a,b){let c=this.toSeconds(b),d=this.getTicksAtTime(c);return this._tickSource.getTimeOfTick(d+a,c)}_loop(){let a=this._lastUpdate,b=this.now();this._lastUpdate=b,this.log("loop",a,b),a!==b&&(this._state.forEachBetween(a,b,a=>{switch(a.state){case"started":let b=this._tickSource.getTicksAtTime(a.time);this.emit("start",a.time,b);break;case"stopped":0!==a.time&&this.emit("stop",a.time);break;case"paused":this.emit("pause",a.time)}}),this._tickSource.forEachTickBetween(a,b,(a,b)=>{this.callback(a,b)}))}getStateAtTime(a){let b=this.toSeconds(a);return this._state.getValueAtTime(b)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}mH.mixin(np);class nq extends nd{constructor(){super(mt(nq.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";let a=mt(nq.getDefaults(),arguments,["delayTime","maxDelay"]),b=this.toSeconds(a.maxDelay);this._maxDelay=Math.max(b,this.toSeconds(a.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(b),this.delayTime=new nc({context:this.context,param:this._delayNode.delayTime,units:"time",value:a.delayTime,minValue:0,maxValue:this.maxDelay}),mK(this,"delayTime")}static getDefaults(){return Object.assign(nd.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function nr(a,b,c=2,d=mR().sampleRate){return mo(this,void 0,void 0,function*(){let e=mR(),f=new mO(c,b,d);mS(f),yield a(f);let g=f.render();mS(e);let h=yield g;return new mN(h)})}class ns extends mw{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let a=mt(ns.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=a.baseUrl,Object.keys(a.urls).forEach(b=>{this._loadingCount++;let c=a.urls[b];this.add(b,c,this._bufferLoaded.bind(this,a.onload),a.onerror)})}static getDefaults(){return{baseUrl:"",onerror:mM,onload:mM,urls:{}}}has(a){return this._buffers.has(a.toString())}get(a){return l3(this.has(a),`ToneAudioBuffers has no buffer named: ${a}`),this._buffers.get(a.toString())}_bufferLoaded(a){this._loadingCount--,0===this._loadingCount&&a&&a()}get loaded(){return Array.from(this._buffers).every(([a,b])=>b.loaded)}add(a,b,c=mM,d=mM){return mh(b)?this._buffers.set(a.toString(),new mN(this.baseUrl+b,c,d)):this._buffers.set(a.toString(),new mN(b,c,d)),this}dispose(){return super.dispose(),this._buffers.forEach(a=>a.dispose()),this._buffers.clear(),this}}class nt extends m4{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(a){return m$(super._frequencyToUnits(a))}_ticksToUnits(a){return m$(super._ticksToUnits(a))}_beatsToUnits(a){return m$(super._beatsToUnits(a))}_secondsToUnits(a){return m$(super._secondsToUnits(a))}toMidi(){return this.valueOf()}toFrequency(){return m0(this.toMidi())}transpose(a){return new nt(this.context,this.toMidi()+a)}}function nu(a,b){return new nt(mR(),a,b)}class nv extends m8{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(a){return this._getPPQ()*a}_secondsToUnits(a){return Math.floor(a/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(a){return a}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function nw(a,b){return new nv(mR(),a,b)}class nx extends na{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new mC,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(a,b){return this._events.add({callback:a,time:this.toSeconds(b)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(a){return this._events.cancel(this.toSeconds(a)),this}_drawLoop(){let a=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=a;){let b=this._events.shift();b&&a-b.time<=this.expiration&&b.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}mE(a=>{a.draw=new nx({context:a})}),mG(a=>{a.draw.dispose()});class ny extends mw{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(a){l3(mb(a.time),"Events must have a time property"),l3(mb(a.duration),"Events must have a duration parameter"),a.time=a.time.valueOf();let b=new nz(a.time,a.time+a.duration,a);for(null===this._root?this._root=b:this._root.insert(b),this._length++;null!==b;)b.updateHeight(),b.updateMax(),this._rebalance(b),b=b.parent;return this}remove(a){if(null!==this._root){let b=[];for(let c of(this._root.search(a.time,b),b))if(c.event===a){this._removeNode(c),this._length--;break}}return this}get length(){return this._length}cancel(a){return this.forEachFrom(a,a=>this.remove(a)),this}_setRoot(a){this._root=a,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(a,b){null!==a.parent?(a.isLeftChild()?a.parent.left=b:a.parent.right=b,this._rebalance(a.parent)):this._setRoot(b)}_removeNode(a){if(null===a.left&&null===a.right)this._replaceNodeInParent(a,null);else if(null===a.right)this._replaceNodeInParent(a,a.left);else if(null===a.left)this._replaceNodeInParent(a,a.right);else{let b=a.getBalance(),c,d=null;if(b>0){if(null===a.left.right)(c=a.left).right=a.right,d=c;else{for(c=a.left.right;null!==c.right;)c=c.right;c.parent&&(c.parent.right=c.left,d=c.parent,c.left=a.left,c.right=a.right)}}else if(null===a.right.left)(c=a.right).left=a.left,d=c;else{for(c=a.right.left;null!==c.left;)c=c.left;c.parent&&(c.parent.left=c.right,d=c.parent,c.left=a.left,c.right=a.right)}null!==a.parent?a.isLeftChild()?a.parent.left=c:a.parent.right=c:this._setRoot(c),d&&this._rebalance(d)}a.dispose()}_rotateLeft(a){let b=a.parent,c=a.isLeftChild(),d=a.right;d&&(a.right=d.left,d.left=a),null!==b?c?b.left=d:b.right=d:this._setRoot(d)}_rotateRight(a){let b=a.parent,c=a.isLeftChild(),d=a.left;d&&(a.left=d.right,d.right=a),null!==b?c?b.left=d:b.right=d:this._setRoot(d)}_rebalance(a){let b=a.getBalance();b>1&&a.left?0>a.left.getBalance()?this._rotateLeft(a.left):this._rotateRight(a):b< -1&&a.right&&(a.right.getBalance()>0?this._rotateRight(a.right):this._rotateLeft(a))}get(a){if(null!==this._root){let b=[];if(this._root.search(a,b),b.length>0){let c=b[0];for(let d=1;d<b.length;d++)b[d].low>c.low&&(c=b[d]);return c.event}}return null}forEach(a){if(null!==this._root){let b=[];this._root.traverse(a=>b.push(a)),b.forEach(b=>{b.event&&a(b.event)})}return this}forEachAtTime(a,b){if(null!==this._root){let c=[];this._root.search(a,c),c.forEach(a=>{a.event&&b(a.event)})}return this}forEachFrom(a,b){if(null!==this._root){let c=[];this._root.searchAfter(a,c),c.forEach(a=>{a.event&&b(a.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(a=>a.dispose()),this._root=null,this}}class nz{constructor(a,b,c){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=c,this.low=a,this.high=b,this.max=this.high}insert(a){a.low<=this.low?null===this.left?this.left=a:this.left.insert(a):null===this.right?this.right=a:this.right.insert(a)}search(a,b){if(!(a>this.max))null!==this.left&&this.left.search(a,b),this.low<=a&&this.high>a&&b.push(this),!(this.low>a)&&null!==this.right&&this.right.search(a,b)}searchAfter(a,b){this.low>=a&&(b.push(this),null!==this.left&&this.left.searchAfter(a,b)),null!==this.right&&this.right.searchAfter(a,b)}traverse(a){a(this),null!==this.left&&this.left.traverse(a),null!==this.right&&this.right.traverse(a)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let a=0;return null!==this.left&&null!==this.right?a=this.left.height-this.right.height:null!==this.left?a=this.left.height+1:null!==this.right&&(a=-(this.right.height+1)),a}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(a){this._left=a,null!==a&&(a.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(a){this._right=a,null!==a&&(a.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class nA extends nd{constructor(){super(mt(nA.getDefaults(),arguments,["volume"])),this.name="Volume";let a=mt(nA.getDefaults(),arguments,["volume"]);this.input=this.output=new nh({context:this.context,gain:a.volume,units:"decibels"}),this.volume=this.output.gain,mK(this,"volume"),this._unmutedVolume=a.volume,this.mute=a.mute}static getDefaults(){return Object.assign(nd.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value=== -1/0}set mute(a){!this.mute&&a?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!a&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class nB extends nd{constructor(){super(mt(nB.getDefaults(),arguments)),this.name="Destination",this.input=new nA({context:this.context}),this.output=new nh({context:this.context}),this.volume=this.input.volume;let a=mt(nB.getDefaults(),arguments);ne(this.input,this.output,this.context.rawContext.destination),this.mute=a.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(nd.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(a){this.input.mute=a}chain(...a){return this.input.disconnect(),a.unshift(this.input),a.push(this.output),ne(...a),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}mE(a=>{a.destination=new nB({context:a})}),mG(a=>{a.destination.dispose()});class nC{constructor(a,b){this.id=nC._eventId++;let c=Object.assign(nC.getDefaults(),b);this.transport=a,this.callback=c.callback,this._once=c.once,this.time=c.time}static getDefaults(){return{callback:mM,once:!1,time:0}}invoke(a){this.callback&&(this.callback(a),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}nC._eventId=0;class nD extends nC{constructor(a,b){super(a,b),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let c=Object.assign(nD.getDefaults(),b);this.duration=new nv(a.context,c.duration).valueOf(),this._interval=new nv(a.context,c.interval).valueOf(),this._nextTick=c.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},nC.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(a){this._createEvents(a),super.invoke(a)}_createEvents(a){let b=this.transport.getTicksAtTime(a);b>=this.time&&b>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new nv(this.context,this._nextTick).toSeconds()))}_restart(a){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;let b=this.transport.getTicksAtTime(a);b>this.time&&(this._nextTick=this.time+Math.ceil((b-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new nv(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new nv(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class nE extends na{constructor(){super(mt(nE.getDefaults(),arguments)),this.name="Transport",this._loop=new class extends mw{constructor(a){super(),this.name="TimelineValue",this._timeline=new mC({memory:10}),this._initialValue=a}set(a,b){return this._timeline.add({value:a,time:b}),this}get(a){let b=this._timeline.get(a);return b?b.value:this._initialValue}}(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new mC,this._repeatedEvents=new ny,this._syncedSignals=[],this._swingAmount=0;let a=mt(nE.getDefaults(),arguments);this._ppq=a.ppq,this._clock=new np({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=a.ppq,this.bpm.setValueAtTime(a.bpm,0),mK(this,"bpm"),this._timeSignature=a.timeSignature,this._swingTicks=a.ppq/2}static getDefaults(){return Object.assign(na.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(a,b){if(this._loop.get(a)&&b>=this._loopEnd&&(this.emit("loopEnd",a),this._clock.setTicksAtTime(this._loopStart,a),b=this._loopStart,this.emit("loopStart",a,this._clock.getSecondsAtTime(a)),this.emit("loop",a)),this._swingAmount>0&&b%this._ppq!=0&&b%(2*this._swingTicks)!=0){let c=b%(2*this._swingTicks)/(2*this._swingTicks),d=Math.sin(c*Math.PI)*this._swingAmount;a+=new nv(this.context,2*this._swingTicks/3).toSeconds()*d}this._timeline.forEachAtTime(b,b=>b.invoke(a))}schedule(a,b){let c=new nC(this,{callback:a,time:new m8(this.context,b).toTicks()});return this._addEvent(c,this._timeline)}scheduleRepeat(a,b,c,d=1/0){let e=new nD(this,{callback:a,duration:new m2(this.context,d).toTicks(),interval:new m2(this.context,b).toTicks(),time:new m8(this.context,c).toTicks()});return this._addEvent(e,this._repeatedEvents)}scheduleOnce(a,b){let c=new nC(this,{callback:a,once:!0,time:new m8(this.context,b).toTicks()});return this._addEvent(c,this._timeline)}clear(a){if(this._scheduledEvents.hasOwnProperty(a)){let b=this._scheduledEvents[a.toString()];b.timeline.remove(b.event),b.event.dispose(),delete this._scheduledEvents[a.toString()]}return this}_addEvent(a,b){return this._scheduledEvents[a.id.toString()]={event:a,timeline:b},b.add(a),a.id}cancel(a=0){let b=this.toTicks(a);return this._timeline.forEachFrom(b,a=>this.clear(a.id)),this._repeatedEvents.forEachFrom(b,a=>this.clear(a.id)),this}_bindClockEvents(){this._clock.on("start",(a,b)=>{b=new nv(this.context,b).toSeconds(),this.emit("start",a,b)}),this._clock.on("stop",a=>{this.emit("stop",a)}),this._clock.on("pause",a=>{this.emit("pause",a)})}get state(){return this._clock.getStateAtTime(this.now())}start(a,b){let c;return mb(b)&&(c=this.toTicks(b)),this._clock.start(a,c),this}stop(a){return this._clock.stop(a),this}pause(a){return this._clock.pause(a),this}toggle(a){return a=this.toSeconds(a),"started"!==this._clock.getStateAtTime(a)?this.start(a):this.stop(a),this}get timeSignature(){return this._timeSignature}set timeSignature(a){mg(a)&&(a=a[0]/a[1]*4),this._timeSignature=a}get loopStart(){return new m2(this.context,this._loopStart,"i").toSeconds()}set loopStart(a){this._loopStart=this.toTicks(a)}get loopEnd(){return new m2(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(a){this._loopEnd=this.toTicks(a)}get loop(){return this._loop.get(this.now())}set loop(a){this._loop.set(a,this.now())}setLoopPoints(a,b){return this.loopStart=a,this.loopEnd=b,this}get swing(){return this._swingAmount}set swing(a){this._swingAmount=a}get swingSubdivision(){return new nv(this.context,this._swingTicks).toNotation()}set swingSubdivision(a){this._swingTicks=this.toTicks(a)}get position(){let a=this.now(),b=this._clock.getTicksAtTime(a);return new nv(this.context,b).toBarsBeatsSixteenths()}set position(a){let b=this.toTicks(a);this.ticks=b}get seconds(){return this._clock.seconds}set seconds(a){let b=this.now(),c=this._clock.frequency.timeToTicks(a,b);this.ticks=c}get progress(){if(!this.loop)return 0;{let a=this.now(),b=this._clock.getTicksAtTime(a);return(b-this._loopStart)/(this._loopEnd-this._loopStart)}}get ticks(){return this._clock.ticks}set ticks(a){if(this._clock.ticks!==a){let b=this.now();if("started"===this.state){let c=this._clock.getTicksAtTime(b),d=this._clock.frequency.getDurationOfTicks(Math.ceil(c)-c,b),e=b+d;this.emit("stop",e),this._clock.setTicksAtTime(a,e),this.emit("start",e,this._clock.getSecondsAtTime(e))}else this._clock.setTicksAtTime(a,b)}}getTicksAtTime(a){return Math.round(this._clock.getTicksAtTime(a))}getSecondsAtTime(a){return this._clock.getSecondsAtTime(a)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(a){this._clock.frequency.multiplier=a}nextSubdivision(a){if(a=this.toTicks(a),"started"!==this.state)return 0;{let b=this.now(),c=this.getTicksAtTime(b),d=a-c%a;return this._clock.nextTickTime(d,b)}}syncSignal(a,b){if(!b){let c=this.now();if(0!==a.getValueAtTime(c)){let d=this.bpm.getValueAtTime(c),e=1/(60/d/this.PPQ);b=a.getValueAtTime(c)/e}else b=0}let f=new nh(b);return this.bpm.connect(f),f.connect(a._param),this._syncedSignals.push({initial:a.value,ratio:f,signal:a}),a.value=0,this}unsyncSignal(a){for(let b=this._syncedSignals.length-1;b>=0;b--){let c=this._syncedSignals[b];c.signal===a&&(c.ratio.dispose(),c.signal.value=c.initial,this._syncedSignals.splice(b,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),mL(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}mH.mixin(nE),mE(a=>{a.transport=new nE({context:a})}),mG(a=>{a.transport.dispose()});class nF extends nd{constructor(a){super(a),this.input=void 0,this._state=new nb("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=mM,this._syncedStop=mM,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new nA({context:this.context,mute:a.mute,volume:a.volume}),this.volume=this._volume.volume,mK(this,"volume"),this.onstop=a.onstop}static getDefaults(){return Object.assign(nd.getDefaults(),{mute:!1,onstop:mM,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(a){this._volume.mute=a}_clampToCurrentTime(a){return this._synced?a:Math.max(a,this.context.currentTime)}start(a,b,c){let d=ma(a)&&this._synced?this.context.transport.seconds:this.toSeconds(a);if(d=this._clampToCurrentTime(d),this._synced||"started"!==this._state.getValueAtTime(d)){if(this.log("start",d),this._state.setStateAtTime("started",d),this._synced){let e=this._state.get(d);e&&(e.offset=this.toSeconds(mu(b,0)),e.duration=c?this.toSeconds(c):void 0);let f=this.context.transport.schedule(a=>{this._start(a,b,c)},d);this._scheduled.push(f),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>d&&this._syncedStart(this.now(),this.context.transport.seconds)}else l5(this.context),this._start(d,b,c)}else l3(mx(d,this._state.get(d).time),"Start time must be strictly greater than previous start time"),this._state.cancel(d),this._state.setStateAtTime("started",d),this.log("restart",d),this.restart(d,b,c);return this}stop(a){let b=ma(a)&&this._synced?this.context.transport.seconds:this.toSeconds(a);if(b=this._clampToCurrentTime(b),"started"===this._state.getValueAtTime(b)||mb(this._state.getNextState("started",b))){if(this.log("stop",b),this._synced){let c=this.context.transport.schedule(this._stop.bind(this),b);this._scheduled.push(c)}else this._stop(b);this._state.cancel(b),this._state.setStateAtTime("stopped",b)}return this}restart(a,b,c){return a=this.toSeconds(a),"started"===this._state.getValueAtTime(a)&&(this._state.cancel(a),this._restart(a,b,c)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(a,b)=>{if(b>0){let c=this._state.get(b);if(c&&"started"===c.state&&c.time!==b){let d=b-this.toSeconds(c.time),e;c.duration&&(e=this.toSeconds(c.duration)-d),this._start(a,this.toSeconds(c.offset)+d,e)}}},this._syncedStop=a=>{let b=this.context.transport.getSecondsAtTime(Math.max(a-this.sampleTime,0));"started"===this._state.getValueAtTime(b)&&this._stop(a)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(a=>this.context.transport.clear(a)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=mM,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class nG extends ni{constructor(){super(mt(nG.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let a=mt(nG.getDefaults(),arguments,["url","onload"]);nf(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new nc({context:this.context,param:this._source.playbackRate,units:"positive",value:a.playbackRate}),this.loop=a.loop,this.loopStart=a.loopStart,this.loopEnd=a.loopEnd,this._buffer=new mN(a.url,a.onload,a.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(ni.getDefaults(),{url:new mN,loop:!1,loopEnd:0,loopStart:0,onload:mM,onerror:mM,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(a){this._fadeIn=a}get fadeOut(){return this._fadeOut}set fadeOut(a){this._fadeOut=a}get curve(){return this._curve}set curve(a){this._curve=a}start(a,b,c,d=1){l3(this.buffer.loaded,"buffer is either not set or not loaded");let e=this.toSeconds(a);this._startGain(e,d),b=this.loop?mu(b,this.loopStart):mu(b,0);let f=Math.max(this.toSeconds(b),0);if(this.loop){let g=this.toSeconds(this.loopEnd)||this.buffer.duration,h=this.toSeconds(this.loopStart),i=g-h;my(f,g)&&(f=(f-h)%i+h),mA(f,this.buffer.duration)&&(f=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,mz(f,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(e,f)),mb(c)){let j=this.toSeconds(c);j=Math.max(j,0),this.stop(e+j)}return this}_stopSource(a){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(a)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(a){this._source.loopStart=this.toSeconds(a)}get loopEnd(){return this._source.loopEnd}set loopEnd(a){this._source.loopEnd=this.toSeconds(a)}get buffer(){return this._buffer}set buffer(a){this._buffer.set(a)}get loop(){return this._source.loop}set loop(a){this._source.loop=a,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class nH extends nF{constructor(){super(mt(nH.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;let a=mt(nH.getDefaults(),arguments,["type"]);this._playbackRate=a.playbackRate,this.type=a.type,this._fadeIn=a.fadeIn,this._fadeOut=a.fadeOut}static getDefaults(){return Object.assign(nF.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(a){if(l3(a in nJ,"Noise: invalid type: "+a),this._type!==a&&(this._type=a,"started"===this.state)){let b=this.now();this._stop(b),this._start(b)}}get playbackRate(){return this._playbackRate}set playbackRate(a){this._playbackRate=a,this._source&&(this._source.playbackRate.value=a)}_start(a){let b=nJ[this._type];this._source=new nG({url:b,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(a),Math.random()*(b.duration-.001))}_stop(a){this._source&&(this._source.stop(this.toSeconds(a)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(a){this._fadeIn=a,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(a){this._fadeOut=a,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(a){this._stop(a),this._start(a)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}let nI={brown:null,pink:null,white:null},nJ={get brown(){if(!nI.brown){let nK=[];for(let nL=0;nL<2;nL++){let nM=new Float32Array(220500);nK[nL]=nM;let nN=0;for(let nO=0;nO<220500;nO++){let nP=2*Math.random()-1;nM[nO]=(nN+.02*nP)/1.02,nN=nM[nO],nM[nO]*=3.5}}nI.brown=new mN().fromArray(nK)}return nI.brown},get pink(){if(!nI.pink){let nQ=[];for(let nR=0;nR<2;nR++){let nS=new Float32Array(220500);nQ[nR]=nS;let nT,nU,nV,nW,nX,nY,nZ;nT=nU=nV=nW=nX=nY=nZ=0;for(let n$=0;n$<220500;n$++){let n_=2*Math.random()-1;nT=.99886*nT+.0555179*n_,nU=.99332*nU+.0750759*n_,nV=.969*nV+.153852*n_,nW=.8665*nW+.3104856*n_,nX=.55*nX+.5329522*n_,nY=-.7616*nY-.016898*n_,nS[n$]=nT+nU+nV+nW+nX+nY+nZ+.5362*n_,nS[n$]*=.11,nZ=.115926*n_}}nI.pink=new mN().fromArray(nQ)}return nI.pink},get white(){if(!nI.white){let n0=[];for(let n1=0;n1<2;n1++){let n2=new Float32Array(220500);n0[n1]=n2;for(let n3=0;n3<220500;n3++)n2[n3]=2*Math.random()-1}nI.white=new mN().fromArray(n0)}return nI.white}};class n4 extends nd{constructor(){super(mt(n4.getDefaults(),arguments,["volume"])),this.name="UserMedia";let a=mt(n4.getDefaults(),arguments,["volume"]);this._volume=this.output=new nA({context:this.context,volume:a.volume}),this.volume=this._volume.volume,mK(this,"volume"),this.mute=a.mute}static getDefaults(){return Object.assign(nd.getDefaults(),{mute:!1,volume:0})}open(a){return mo(this,void 0,void 0,function*(){l3(n4.supported,"UserMedia is not supported"),"started"===this.state&&this.close();let b=yield n4.enumerateDevices();md(a)?this._device=b[a]:(this._device=b.find(b=>b.label===a||b.deviceId===a),!this._device&&b.length>0&&(this._device=b[0]),l3(mb(this._device),`No matching device ${a}`));let c={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(c.audio.deviceId=this._device.deviceId);let d=yield navigator.mediaDevices.getUserMedia(c);if(!this._stream){this._stream=d;let e=this.context.createMediaStreamSource(d);nf(e,this.output),this._mediaStream=e}return this})}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(a=>{a.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return mo(this,void 0,void 0,function*(){let a=yield navigator.mediaDevices.enumerateDevices();return a.filter(a=>"audioinput"===a.kind)})}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(a){this._volume.mute=a}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return mb(navigator.mediaDevices)&&mb(navigator.mediaDevices.getUserMedia)}}function n5(a,b){return mo(this,void 0,void 0,function*(){let c=b/a.context.sampleRate,d=new mO(1,c,a.context.sampleRate),e=new a.constructor(Object.assign(a.get(),{frequency:2/c,detune:0,context:d})).toDestination();e.start(0);let f=yield d.render();return f.getChannelData(0)})}class n6 extends ni{constructor(){super(mt(n6.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let a=mt(n6.getDefaults(),arguments,["frequency","type"]);nf(this._oscillator,this._gainNode),this.type=a.type,this.frequency=new nc({context:this.context,param:this._oscillator.frequency,units:"frequency",value:a.frequency}),this.detune=new nc({context:this.context,param:this._oscillator.detune,units:"cents",value:a.detune}),mK(this,["frequency","detune"])}static getDefaults(){return Object.assign(ni.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(a){let b=this.toSeconds(a);return this.log("start",b),this._startGain(b),this._oscillator.start(b),this}_stopSource(a){this._oscillator.stop(a)}setPeriodicWave(a){return this._oscillator.setPeriodicWave(a),this}get type(){return this._oscillator.type}set type(a){this._oscillator.type=a}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class n7 extends nF{constructor(){super(mt(n7.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;let a=mt(n7.getDefaults(),arguments,["frequency","type"]);this.frequency=new nk({context:this.context,units:"frequency",value:a.frequency}),mK(this,"frequency"),this.detune=new nk({context:this.context,units:"cents",value:a.detune}),mK(this,"detune"),this._partials=a.partials,this._partialCount=a.partialCount,this._type=a.type,a.partialCount&&"custom"!==a.type&&(this._type=this.baseType+a.partialCount.toString()),this.phase=a.phase}static getDefaults(){return Object.assign(nF.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(a){let b=this.toSeconds(a),c=new n6({context:this.context,onended:()=>this.onstop(this)});this._oscillator=c,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(b)}_stop(a){let b=this.toSeconds(a);this._oscillator&&this._oscillator.stop(b)}_restart(a){let b=this.toSeconds(a);return this.log("restart",b),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(b),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){let a=n7._periodicWaveCache.find(a=>{var b,c;return a.phase===this._phase&&(b=a.partials,c=this._partials,b.length===c.length&&b.every((a,b)=>c[b]===a))});return a}{let b=n7._periodicWaveCache.find(a=>a.type===this._type&&a.phase===this._phase);return this._partialCount=b?b.partialCount:this._partialCount,b}}get type(){return this._type}set type(a){this._type=a;let b=-1!==["sine","square","sawtooth","triangle"].indexOf(a);if(0===this._phase&&b)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=a);else{let c=this._getCachedPeriodicWave();if(mb(c)){let{partials:d,wave:e}=c;this._wave=e,this._partials=d,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{let[f,g]=this._getRealImaginary(a,this._phase),h=this.context.createPeriodicWave(f,g);this._wave=h,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),n7._periodicWaveCache.push({imag:g,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:f,type:this._type,wave:this._wave}),n7._periodicWaveCache.length>100&&n7._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(a){this.partialCount&&"custom"!==this._type&&"custom"!==a?this.type=a+this.partialCount:this.type=a}get partialCount(){return this._partialCount}set partialCount(a){l4(a,0);let b=this._type,c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(c&&(b=c[1]),"custom"!==this._type)0===a?this.type=b:this.type=b+a.toString();else{let d=new Float32Array(a);this._partials.forEach((a,b)=>d[b]=a),this._partials=Array.from(d),this.type=this._type}}_getRealImaginary(a,b){let c=2048,d=new Float32Array(c),e=new Float32Array(c),f=1;if("custom"===a){if(f=this._partials.length+1,this._partialCount=this._partials.length,c=f,0===this._partials.length)return[d,e]}else{let g=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(a);g?(f=parseInt(g[2],10)+1,this._partialCount=parseInt(g[2],10),a=g[1],c=f=Math.max(f,2)):this._partialCount=0,this._partials=[]}for(let h=1;h<c;++h){let i=2/(h*Math.PI),j;switch(a){case"sine":j=h<=f?1:0,this._partials[h-1]=j;break;case"square":j=1&h?2*i:0,this._partials[h-1]=j;break;case"sawtooth":j=i*(1&h?1:-1),this._partials[h-1]=j;break;case"triangle":j=1&h?2*(i*i)*(h-1>>1&1?-1:1):0,this._partials[h-1]=j;break;case"custom":j=this._partials[h-1];break;default:throw TypeError("Oscillator: invalid type: "+a)}0!==j?(d[h]=-j*Math.sin(b*h),e[h]=j*Math.cos(b*h)):(d[h]=0,e[h]=0)}return[d,e]}_inverseFFT(a,b,c){let d=0,e=a.length;for(let f=0;f<e;f++)d+=a[f]*Math.cos(f*c)+b[f]*Math.sin(f*c);return d}getInitialValue(){let[a,b]=this._getRealImaginary(this._type,0),c=0,d=2*Math.PI;for(let e=0;e<32;e++)c=Math.max(this._inverseFFT(a,b,e/32*d),c);return mB(-this._inverseFFT(a,b,this._phase)/c,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(a){this._partials=a,this._partialCount=this._partials.length,a.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(a){this._phase=a*Math.PI/180,this.type=this._type}asArray(a=1024){return mo(this,void 0,void 0,function*(){return n5(this,a)})}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}n7._periodicWaveCache=[];class n8 extends nd{constructor(){super(Object.assign(mt(n8.getDefaults(),arguments,["context"])))}connect(a,b=0,c=0){return nl(this,a,b,c),this}}class n9 extends n8{constructor(){super(Object.assign(mt(n9.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let a=mt(n9.getDefaults(),arguments,["mapping","length"]);mg(a.mapping)||a.mapping instanceof Float32Array?this.curve=Float32Array.from(a.mapping):mc(a.mapping)&&this.setMap(a.mapping,a.length)}static getDefaults(){return Object.assign(nk.getDefaults(),{length:1024})}setMap(a,b=1024){let c=new Float32Array(b);for(let d=0,e=b;d<e;d++){let f=d/(e-1)*2-1;c[d]=a(f,d)}return this.curve=c,this}get curve(){return this._shaper.curve}set curve(a){this._shaper.curve=a}get oversample(){return this._shaper.oversample}set oversample(a){let b=["none","2x","4x"].some(b=>b.includes(a));l3(b,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=a}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class oa extends n8{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new n9({context:this.context,mapping:a=>(a+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class ob extends nk{constructor(){super(Object.assign(mt(ob.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;let a=mt(ob.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new nh({context:this.context,minValue:a.minValue,maxValue:a.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(a.value,0)}static getDefaults(){return Object.assign(nk.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class oc extends nF{constructor(){super(mt(oc.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new oa({context:this.context}),this._modulationNode=new nh({context:this.context});let a=mt(oc.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new n7({context:this.context,detune:a.detune,frequency:a.frequency,onstop:()=>this.onstop(this),phase:a.phase,type:a.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new n7({context:this.context,phase:a.phase,type:a.modulationType}),this.harmonicity=new ob({context:this.context,units:"positive",value:a.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),mK(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(n7.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(a){this._modulator.start(a),this._carrier.start(a)}_stop(a){this._modulator.stop(a),this._carrier.stop(a)}_restart(a){this._modulator.restart(a),this._carrier.restart(a)}get type(){return this._carrier.type}set type(a){this._carrier.type=a}get baseType(){return this._carrier.baseType}set baseType(a){this._carrier.baseType=a}get partialCount(){return this._carrier.partialCount}set partialCount(a){this._carrier.partialCount=a}get modulationType(){return this._modulator.type}set modulationType(a){this._modulator.type=a}get phase(){return this._carrier.phase}set phase(a){this._carrier.phase=a,this._modulator.phase=a}get partials(){return this._carrier.partials}set partials(a){this._carrier.partials=a}asArray(a=1024){return mo(this,void 0,void 0,function*(){return n5(this,a)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class od extends nF{constructor(){super(mt(od.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new nh({context:this.context,gain:0});let a=mt(od.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new n7({context:this.context,detune:a.detune,frequency:0,onstop:()=>this.onstop(this),phase:a.phase,type:a.type}),this.detune=this._carrier.detune,this.frequency=new nk({context:this.context,units:"frequency",value:a.frequency}),this._modulator=new n7({context:this.context,phase:a.phase,type:a.modulationType}),this.harmonicity=new ob({context:this.context,units:"positive",value:a.harmonicity}),this.modulationIndex=new ob({context:this.context,units:"positive",value:a.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),mK(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(n7.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(a){this._modulator.start(a),this._carrier.start(a)}_stop(a){this._modulator.stop(a),this._carrier.stop(a)}_restart(a){return this._modulator.restart(a),this._carrier.restart(a),this}get type(){return this._carrier.type}set type(a){this._carrier.type=a}get baseType(){return this._carrier.baseType}set baseType(a){this._carrier.baseType=a}get partialCount(){return this._carrier.partialCount}set partialCount(a){this._carrier.partialCount=a}get modulationType(){return this._modulator.type}set modulationType(a){this._modulator.type=a}get phase(){return this._carrier.phase}set phase(a){this._carrier.phase=a,this._modulator.phase=a}get partials(){return this._carrier.partials}set partials(a){this._carrier.partials=a}asArray(a=1024){return mo(this,void 0,void 0,function*(){return n5(this,a)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class oe extends nF{constructor(){super(mt(oe.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new nh({context:this.context,gain:0}),this._thresh=new n9({context:this.context,mapping:a=>a<=0?-1:1});let a=mt(oe.getDefaults(),arguments,["frequency","width"]);this.width=new nk({context:this.context,units:"audioRange",value:a.width}),this._triangle=new n7({context:this.context,detune:a.detune,frequency:a.frequency,onstop:()=>this.onstop(this),phase:a.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),mK(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(nF.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(a){a=this.toSeconds(a),this._triangle.start(a),this._widthGate.gain.setValueAtTime(1,a)}_stop(a){a=this.toSeconds(a),this._triangle.stop(a),this._widthGate.gain.cancelScheduledValues(a),this._widthGate.gain.setValueAtTime(0,a)}_restart(a){this._triangle.restart(a),this._widthGate.gain.cancelScheduledValues(a),this._widthGate.gain.setValueAtTime(1,a)}get phase(){return this._triangle.phase}set phase(a){this._triangle.phase=a}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(a){this._triangle.type=a}asArray(a=1024){return mo(this,void 0,void 0,function*(){return n5(this,a)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class of extends nF{constructor(){super(mt(of.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];let a=mt(of.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new nk({context:this.context,units:"frequency",value:a.frequency}),this.detune=new nk({context:this.context,units:"cents",value:a.detune}),this._spread=a.spread,this._type=a.type,this._phase=a.phase,this._partials=a.partials,this._partialCount=a.partialCount,this.count=a.count,mK(this,["frequency","detune"])}static getDefaults(){return Object.assign(n7.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(a){a=this.toSeconds(a),this._forEach(b=>b.start(a))}_stop(a){a=this.toSeconds(a),this._forEach(b=>b.stop(a))}_restart(a){this._forEach(b=>b.restart(a))}_forEach(a){for(let b=0;b<this._oscillators.length;b++)a(this._oscillators[b],b)}get type(){return this._type}set type(a){this._type=a,this._forEach(b=>b.type=a)}get spread(){return this._spread}set spread(a){if(this._spread=a,this._oscillators.length>1){let b=-a/2,c=a/(this._oscillators.length-1);this._forEach((a,d)=>a.detune.value=b+c*d)}}get count(){return this._oscillators.length}set count(a){if(l4(a,1),this._oscillators.length!==a){this._forEach(a=>a.dispose()),this._oscillators=[];for(let b=0;b<a;b++){let c=new n7({context:this.context,volume:-6-1.1*a,type:this._type,phase:this._phase+b/a*360,partialCount:this._partialCount,onstop:0===b?()=>this.onstop(this):mM});"custom"===this.type&&(c.partials=this._partials),this.frequency.connect(c.frequency),this.detune.connect(c.detune),c.detune.overridden=!1,c.connect(this.output),this._oscillators[b]=c}this.spread=this._spread,"started"===this.state&&this._forEach(a=>a.start())}}get phase(){return this._phase}set phase(a){this._phase=a,this._forEach((a,b)=>a.phase=this._phase+b/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(a){this._forEach(b=>b.baseType=a),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(a){this._partials=a,this._partialCount=this._partials.length,a.length&&(this._type="custom",this._forEach(b=>b.partials=a))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(a){this._partialCount=a,this._forEach(b=>b.partialCount=a),this._type=this._oscillators[0].type}asArray(a=1024){return mo(this,void 0,void 0,function*(){return n5(this,a)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(a=>a.dispose()),this}}class og extends nF{constructor(){super(mt(og.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new ob({context:this.context,value:2});let a=mt(og.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new oe({context:this.context,frequency:a.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new n7({context:this.context,detune:a.detune,frequency:a.frequency,onstop:()=>this.onstop(this),phase:a.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),mK(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(nF.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(a){a=this.toSeconds(a),this._modulator.start(a),this._pulse.start(a)}_stop(a){a=this.toSeconds(a),this._modulator.stop(a),this._pulse.stop(a)}_restart(a){this._modulator.restart(a),this._pulse.restart(a)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(a){this._modulator.phase=a}asArray(a=1024){return mo(this,void 0,void 0,function*(){return n5(this,a)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}let oh={am:oc,fat:of,fm:od,oscillator:n7,pulse:oe,pwm:og};class oi extends nF{constructor(){super(mt(oi.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";let a=mt(oi.getDefaults(),arguments,["frequency","type"]);this.frequency=new nk({context:this.context,units:"frequency",value:a.frequency}),this.detune=new nk({context:this.context,units:"cents",value:a.detune}),mK(this,["frequency","detune"]),this.set(a)}static getDefaults(){return Object.assign(n7.getDefaults(),od.getDefaults(),oc.getDefaults(),of.getDefaults(),oe.getDefaults(),og.getDefaults())}_start(a){this._oscillator.start(a)}_stop(a){this._oscillator.stop(a)}_restart(a){return this._oscillator.restart(a),this}get type(){let a="";return["am","fm","fat"].some(a=>this._sourceType===a)&&(a=this._sourceType),a+this._oscillator.type}set type(a){"fm"===a.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=a.substr(2)):"am"===a.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=a.substr(2)):"fat"===a.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=a.substr(3)):"pwm"===a?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===a?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=a)}get partials(){return this._oscillator.partials}set partials(a){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=a)}get partialCount(){return this._oscillator.partialCount}set partialCount(a){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=a)}set(a){return Reflect.has(a,"type")&&a.type&&(this.type=a.type),super.set(a),this}_createNewOscillator(a){if(a!==this._sourceType){this._sourceType=a;let b=oh[a],c=this.now();if(this._oscillator){let d=this._oscillator;d.stop(c),this.context.setTimeout(()=>d.dispose(),this.blockTime)}this._oscillator=new b({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(c)}}get phase(){return this._oscillator.phase}set phase(a){this._oscillator.phase=a}get sourceType(){return this._sourceType}set sourceType(a){let b="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(b=this._oscillator.type),"fm"===a?this.type="fm"+b:"am"===a?this.type="am"+b:"fat"===a?this.type="fat"+b:"oscillator"===a?this.type=b:"pulse"===a?this.type="pulse":"pwm"===a&&(this.type="pwm")}_getOscType(a,b){return a instanceof oh[b]}get baseType(){return this._oscillator.baseType}set baseType(a){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===a||"pwm"===a||(this._oscillator.baseType=a)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(a){this._getOscType(this._oscillator,"fat")&&md(a)&&(this._oscillator.count=a)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(a){this._getOscType(this._oscillator,"fat")&&md(a)&&(this._oscillator.spread=a)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(a){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&mh(a)&&(this._oscillator.modulationType=a)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(a=1024){return mo(this,void 0,void 0,function*(){return n5(this,a)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class oj extends nk{constructor(){super(Object.assign(mt(oj.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new nh({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,ne(this._constantSource,this._sum)}static getDefaults(){return Object.assign(nk.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class ok extends n8{constructor(){super(Object.assign(mt(ok.getDefaults(),arguments,["min","max"]))),this.name="Scale";let a=mt(ok.getDefaults(),arguments,["min","max"]);this._mult=this.input=new ob({context:this.context,value:a.max-a.min}),this._add=this.output=new oj({context:this.context,value:a.min}),this._min=a.min,this._max=a.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(n8.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(a){this._min=a,this._setRange()}get max(){return this._max}set max(a){this._max=a,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class ol extends n8{constructor(){super(Object.assign(mt(ol.getDefaults(),arguments))),this.name="Zero",this._gain=new nh({context:this.context}),this.output=this._gain,this.input=void 0,nf(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),ng(this.context.getConstant(0),this._gain),this}}class om extends nd{constructor(){super(mt(om.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=nc.prototype._fromType,this._toType=nc.prototype._toType,this._is=nc.prototype._is,this._clampValue=nc.prototype._clampValue;let a=mt(om.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new n7(a),this.frequency=this._oscillator.frequency,this._amplitudeGain=new nh({context:this.context,gain:a.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new nk({context:this.context,units:"audioRange",value:0}),this._zeros=new ol({context:this.context}),this._a2g=new oa({context:this.context}),this._scaler=this.output=new ok({context:this.context,max:a.max,min:a.min}),this.units=a.units,this.min=a.min,this.max=a.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),mK(this,["amplitude","frequency"]),this.phase=a.phase}static getDefaults(){return Object.assign(n7.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(a){return a=this.toSeconds(a),this._stoppedSignal.setValueAtTime(0,a),this._oscillator.start(a),this}stop(a){return a=this.toSeconds(a),this._stoppedSignal.setValueAtTime(this._stoppedValue,a),this._oscillator.stop(a),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(a){a=this._fromType(a),this._scaler.min=a}get max(){return this._toType(this._scaler.max)}set max(a){a=this._fromType(a),this._scaler.max=a}get type(){return this._oscillator.type}set type(a){this._oscillator.type=a,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(a){this._oscillator.partials=a,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(a){this._oscillator.phase=a,this._setStoppedValue()}get units(){return this._units}set units(a){let b=this.min,c=this.max;this._units=a,this.min=b,this.max=c}get state(){return this._oscillator.state}connect(a,b,c){return(a instanceof nc||a instanceof nk)&&(this.convert=a.convert,this.units=a.units),nl(this,a,b,c),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function on(a,b=1/0){let c=new WeakMap;return function(d,e){Reflect.defineProperty(d,e,{configurable:!0,enumerable:!0,get:function(){return c.get(this)},set:function(d){l4(d,a,b),c.set(this,d)}})}}function oo(a,b=1/0){let c=new WeakMap;return function(d,e){Reflect.defineProperty(d,e,{configurable:!0,enumerable:!0,get:function(){return c.get(this)},set:function(d){l4(this.toSeconds(d),a,b),c.set(this,d)}})}}class op extends nF{constructor(){super(mt(op.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;let a=mt(op.getDefaults(),arguments,["url","onload"]);this._buffer=new mN({onload:this._onload.bind(this,a.onload),onerror:a.onerror,reverse:a.reverse,url:a.url}),this.autostart=a.autostart,this._loop=a.loop,this._loopStart=a.loopStart,this._loopEnd=a.loopEnd,this._playbackRate=a.playbackRate,this.fadeIn=a.fadeIn,this.fadeOut=a.fadeOut}static getDefaults(){return Object.assign(nF.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:mM,onerror:mM,playbackRate:1,reverse:!1})}load(a){return mo(this,void 0,void 0,function*(){return yield this._buffer.load(a),this._onload(),this})}_onload(a=mM){a(),this.autostart&&this.start()}_onSourceEnd(a){this.onstop(this),this._activeSources.delete(a),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(a,b,c){return super.start(a,b,c),this}_start(a,b,c){b=this._loop?mu(b,this._loopStart):mu(b,0);let d=this.toSeconds(b),e=c;c=mu(c,Math.max(this._buffer.duration-d,0));let f=this.toSeconds(c);f/=this._playbackRate,a=this.toSeconds(a);let g=new nG({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(a+f),this._state.setStateAtTime("stopped",a+f,{implicitEnd:!0})),this._activeSources.add(g),this._loop&&ma(e)?g.start(a,d):g.start(a,d,f-this.toSeconds(this.fadeOut))}_stop(a){let b=this.toSeconds(a);this._activeSources.forEach(a=>a.stop(b))}restart(a,b,c){return super.restart(a,b,c),this}_restart(a,b,c){this._stop(a),this._start(a,b,c)}seek(a,b){let c=this.toSeconds(b);if("started"===this._state.getValueAtTime(c)){let d=this.toSeconds(a);this._stop(c),this._start(c,d)}return this}setLoopPoints(a,b){return this.loopStart=a,this.loopEnd=b,this}get loopStart(){return this._loopStart}set loopStart(a){this._loopStart=a,this.buffer.loaded&&l4(this.toSeconds(a),0,this.buffer.duration),this._activeSources.forEach(b=>{b.loopStart=a})}get loopEnd(){return this._loopEnd}set loopEnd(a){this._loopEnd=a,this.buffer.loaded&&l4(this.toSeconds(a),0,this.buffer.duration),this._activeSources.forEach(b=>{b.loopEnd=a})}get buffer(){return this._buffer}set buffer(a){this._buffer.set(a)}get loop(){return this._loop}set loop(a){if(this._loop!==a&&(this._loop=a,this._activeSources.forEach(b=>{b.loop=a}),a)){let b=this._state.getNextState("stopped",this.now());b&&this._state.cancel(b.time)}}get playbackRate(){return this._playbackRate}set playbackRate(a){this._playbackRate=a;let b=this.now(),c=this._state.getNextState("stopped",b);c&&c.implicitEnd&&(this._state.cancel(c.time),this._activeSources.forEach(a=>a.cancelStop())),this._activeSources.forEach(c=>{c.playbackRate.setValueAtTime(a,b)})}get reverse(){return this._buffer.reverse}set reverse(a){this._buffer.reverse=a}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(a=>a.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}mn([oo(0)],op.prototype,"fadeIn",void 0),mn([oo(0)],op.prototype,"fadeOut",void 0);class oq extends nd{constructor(){super(mt(oq.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;let a=mt(oq.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new nA({context:this.context,volume:a.volume}),this.volume=this._volume.volume,mK(this,"volume"),this._buffers=new ns({urls:a.urls,onload:a.onload,baseUrl:a.baseUrl,onerror:a.onerror}),this.mute=a.mute,this._fadeIn=a.fadeIn,this._fadeOut=a.fadeOut}static getDefaults(){return Object.assign(nF.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:mM,onerror:mM,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(a){this._volume.mute=a}get fadeIn(){return this._fadeIn}set fadeIn(a){this._fadeIn=a,this._players.forEach(b=>{b.fadeIn=a})}get fadeOut(){return this._fadeOut}set fadeOut(a){this._fadeOut=a,this._players.forEach(b=>{b.fadeOut=a})}get state(){let a=Array.from(this._players).some(([a,b])=>"started"===b.state);return a?"started":"stopped"}has(a){return this._buffers.has(a)}player(a){if(l3(this.has(a),`No Player with the name ${a} exists on this object`),!this._players.has(a)){let b=new op({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(a)}).connect(this.output);this._players.set(a,b)}return this._players.get(a)}get loaded(){return this._buffers.loaded}add(a,b,c){return l3(!this._buffers.has(a),"A buffer with that name already exists on this object"),this._buffers.add(a,b,c),this}stopAll(a){return this._players.forEach(b=>b.stop(a)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(a=>a.dispose()),this._buffers.dispose(),this}}class or extends nF{constructor(){super(mt(or.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];let a=mt(or.getDefaults(),arguments,["url","onload"]);this.buffer=new mN({onload:a.onload,onerror:a.onerror,reverse:a.reverse,url:a.url}),this._clock=new np({context:this.context,callback:this._tick.bind(this),frequency:1/a.grainSize}),this._playbackRate=a.playbackRate,this._grainSize=a.grainSize,this._overlap=a.overlap,this.detune=a.detune,this.overlap=a.overlap,this.loop=a.loop,this.playbackRate=a.playbackRate,this.grainSize=a.grainSize,this.loopStart=a.loopStart,this.loopEnd=a.loopEnd,this.reverse=a.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(nF.getDefaults(),{onload:mM,onerror:mM,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(a,b,c){b=mu(b,0),b=this.toSeconds(b),a=this.toSeconds(a);let d=1/this._clock.frequency.getValueAtTime(a);this._clock.start(a,b/d),c&&this.stop(a+this.toSeconds(c))}restart(a,b,c){return super.restart(a,b,c),this}_restart(a,b,c){this._stop(a),this._start(a,b,c)}_stop(a){this._clock.stop(a)}_onstop(a){this._activeSources.forEach(b=>{b.fadeOut=0,b.stop(a)}),this.onstop(this)}_tick(a){let b=this._clock.getTicksAtTime(a),c=b*this._grainSize;if(this.log("offset",c),!this.loop&&c>this.buffer.duration){this.stop(a);return}let d=c<this._overlap?0:this._overlap,e=new nG({context:this.context,url:this.buffer,fadeIn:d,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:mY(this.detune/100)}).connect(this.output);e.start(a,this._grainSize*b),e.stop(a+this._grainSize/this.playbackRate),this._activeSources.push(e),e.onended=()=>{let a=this._activeSources.indexOf(e);-1!==a&&this._activeSources.splice(a,1)}}get playbackRate(){return this._playbackRate}set playbackRate(a){l4(a,.001),this._playbackRate=a,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(a){this.buffer.loaded&&l4(this.toSeconds(a),0,this.buffer.duration),this._loopStart=this.toSeconds(a)}get loopEnd(){return this._loopEnd}set loopEnd(a){this.buffer.loaded&&l4(this.toSeconds(a),0,this.buffer.duration),this._loopEnd=this.toSeconds(a)}get reverse(){return this.buffer.reverse}set reverse(a){this.buffer.reverse=a}get grainSize(){return this._grainSize}set grainSize(a){this._grainSize=this.toSeconds(a),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(a){let b=this.toSeconds(a);l4(b,0),this._overlap=b}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(a=>a.dispose()),this}}class os extends n8{constructor(){super(...arguments),this.name="Abs",this._abs=new n9({context:this.context,mapping:a=>.001>Math.abs(a)?0:Math.abs(a)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class ot extends n8{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new n9({context:this.context,mapping:a=>2*Math.abs(a)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class ou extends n8{constructor(){super(...arguments),this.name="Negate",this._multiply=new ob({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class ov extends nk{constructor(){super(Object.assign(mt(ov.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new nh({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new ou({context:this.context}),this.subtrahend=this._param,ne(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(nk.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class ow extends n8{constructor(){super(Object.assign(mt(ow.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new n9({context:this.context,length:127,mapping:a=>a<=0?0:1}),this._scale=this.input=new ob({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class ox extends nk{constructor(){super(Object.assign(mt(ox.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;let a=mt(ox.getDefaults(),arguments,["value"]);this._subtract=this.input=new ov({context:this.context,value:a.value}),this._gtz=this.output=new ow({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,mK(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(nk.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class oy extends n8{constructor(){super(Object.assign(mt(oy.getDefaults(),arguments,["value"]))),this.name="Pow";let a=mt(oy.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new n9({context:this.context,mapping:this._expFunc(a.value),length:8192}),this._exponent=a.value}static getDefaults(){return Object.assign(n8.getDefaults(),{value:1})}_expFunc(a){return b=>Math.pow(Math.abs(b),a)}get value(){return this._exponent}set value(a){this._exponent=a,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class oz extends ok{constructor(){super(Object.assign(mt(oz.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";let a=mt(oz.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new oy({context:this.context,value:a.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(ok.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(a){this._exp.value=a}dispose(){return super.dispose(),this._exp.dispose(),this}}class oA extends nk{constructor(){super(mt(nk.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;let a=mt(nk.getDefaults(),arguments,["value","units"]);this._lastVal=a.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new nj({context:this.context,offset:a.value,units:a.units}).start(0),this.setValueAtTime(a.value,0)}_onTick(a){let b=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==b&&(this._lastVal=b,this._constantSource.offset.setValueAtTime(b,a))}_anchorValue(a){let b=super.getValueAtTime(this.context.transport.seconds);this._lastVal=b,this._constantSource.offset.cancelAndHoldAtTime(a),this._constantSource.offset.setValueAtTime(b,a)}getValueAtTime(a){let b=new m8(this.context,a).toSeconds();return super.getValueAtTime(b)}setValueAtTime(a,b){let c=new m8(this.context,b).toSeconds();return super.setValueAtTime(a,c),this}linearRampToValueAtTime(a,b){let c=new m8(this.context,b).toSeconds();return super.linearRampToValueAtTime(a,c),this}exponentialRampToValueAtTime(a,b){let c=new m8(this.context,b).toSeconds();return super.exponentialRampToValueAtTime(a,c),this}setTargetAtTime(a,b,c){let d=new m8(this.context,b).toSeconds();return super.setTargetAtTime(a,d,c),this}cancelScheduledValues(a){let b=new m8(this.context,a).toSeconds();return super.cancelScheduledValues(b),this}setValueCurveAtTime(a,b,c,d){let e=new m8(this.context,b).toSeconds();return c=this.toSeconds(c),super.setValueCurveAtTime(a,e,c,d),this}cancelAndHoldAtTime(a){let b=new m8(this.context,a).toSeconds();return super.cancelAndHoldAtTime(b),this}setRampPoint(a){let b=new m8(this.context,a).toSeconds();return super.setRampPoint(b),this}exponentialRampTo(a,b,c){let d=new m8(this.context,c).toSeconds();return super.exponentialRampTo(a,b,d),this}linearRampTo(a,b,c){let d=new m8(this.context,c).toSeconds();return super.linearRampTo(a,b,d),this}targetRampTo(a,b,c){let d=new m8(this.context,c).toSeconds();return super.targetRampTo(a,b,d),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class oB extends nd{constructor(){super(mt(oB.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new nk({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let a=mt(oB.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=a.attack,this.decay=a.decay,this.sustain=a.sustain,this.release=a.release,this.attackCurve=a.attackCurve,this.releaseCurve=a.releaseCurve,this.decayCurve=a.decayCurve}static getDefaults(){return Object.assign(nd.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(a,b){if(mh(a))return a;{let c;for(c in oC)if(oC[c][b]===a)return c;return a}}_setCurve(a,b,c){if(mh(c)&&Reflect.has(oC,c)){let d=oC[c];me(d)?"_decayCurve"!==a&&(this[a]=d[b]):this[a]=d}else if(mg(c)&&"_decayCurve"!==a)this[a]=c;else throw Error("Envelope: invalid curve: "+c)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(a){this._setCurve("_attackCurve","In",a)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(a){this._setCurve("_releaseCurve","Out",a)}get decayCurve(){return this._decayCurve}set decayCurve(a){l3(["linear","exponential"].some(b=>b===a),`Invalid envelope curve: ${a}`),this._decayCurve=a}triggerAttack(a,b=1){this.log("triggerAttack",a,b),a=this.toSeconds(a);let c=this.toSeconds(this.attack),d=c,e=this.toSeconds(this.decay),f=this.getValueAtTime(a);if(f>0){let g=1/d,h=1-f;d=h/g}if(d<this.sampleTime)this._sig.cancelScheduledValues(a),this._sig.setValueAtTime(b,a);else if("linear"===this._attackCurve)this._sig.linearRampTo(b,d,a);else if("exponential"===this._attackCurve)this._sig.targetRampTo(b,d,a);else{this._sig.cancelAndHoldAtTime(a);let i=this._attackCurve;for(let j=1;j<i.length;j++)if(i[j-1]<=f&&f<=i[j]){(i=this._attackCurve.slice(j))[0]=f;break}this._sig.setValueCurveAtTime(i,a,d,b)}if(e&&this.sustain<1){let k=b*this.sustain,l=a+d;this.log("decay",l),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(k,e+l):this._sig.exponentialApproachValueAtTime(k,l,e)}return this}triggerRelease(a){this.log("triggerRelease",a),a=this.toSeconds(a);let b=this.getValueAtTime(a);if(b>0){let c=this.toSeconds(this.release);c<this.sampleTime?this._sig.setValueAtTime(0,a):"linear"===this._releaseCurve?this._sig.linearRampTo(0,c,a):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,c,a):(l3(mg(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(a),this._sig.setValueCurveAtTime(this._releaseCurve,a,c,b))}return this}getValueAtTime(a){return this._sig.getValueAtTime(a)}triggerAttackRelease(a,b,c=1){return b=this.toSeconds(b),this.triggerAttack(b,c),this.triggerRelease(b+this.toSeconds(a)),this}cancel(a){return this._sig.cancelScheduledValues(this.toSeconds(a)),this}connect(a,b=0,c=0){return nl(this,a,b,c),this}asArray(a=1024){return mo(this,void 0,void 0,function*(){let b=a/this.context.sampleRate,c=new mO(1,b,this.context.sampleRate),d=this.toSeconds(this.attack)+this.toSeconds(this.decay),e=d+this.toSeconds(this.release),f=.1*e,g=e+f,h=new this.constructor(Object.assign(this.get(),{attack:b*this.toSeconds(this.attack)/g,decay:b*this.toSeconds(this.decay)/g,release:b*this.toSeconds(this.release)/g,context:c}));h._sig.toDestination(),h.triggerAttackRelease(b*(d+f)/g,0);let i=yield c.render();return i.getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}mn([oo(0)],oB.prototype,"attack",void 0),mn([oo(0)],oB.prototype,"decay",void 0),mn([on(0,1)],oB.prototype,"sustain",void 0),mn([oo(0)],oB.prototype,"release",void 0);let oC=(()=>{var a;let b,c,d=[];for(b=0;b<128;b++)d[b]=Math.sin(b/127*(Math.PI/2));let e=[];for(b=0;b<127;b++){c=b/127;let f=Math.sin(c*(2*Math.PI)*6.4-Math.PI/2)+1;e[b]=f/10+.83*c}e[127]=1;let g=[];for(b=0;b<128;b++)g[b]=Math.ceil(b/127*5)/5;let h=[];for(b=0;b<128;b++)c=b/127,h[b]=.5*(1-Math.cos(Math.PI*c));let i=[];for(b=0;b<128;b++){c=b/127;let j=4*Math.pow(c,3)+.2,k=Math.cos(j*Math.PI*2*c);i[b]=Math.abs(k*(1-c))}function l(a){let b=Array(a.length);for(let c=0;c<a.length;c++)b[c]=1-a[c];return b}return{bounce:{In:l(i),Out:i},cosine:{In:d,Out:(a=d).slice(0).reverse()},exponential:"exponential",linear:"linear",ripple:{In:e,Out:l(e)},sine:{In:h,Out:l(h)},step:{In:g,Out:l(g)}}})();class oD extends nd{constructor(){super(mt(oD.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;let a=mt(oD.getDefaults(),arguments);this._volume=this.output=new nA({context:this.context,volume:a.volume}),this.volume=this._volume.volume,mK(this,"volume")}static getDefaults(){return Object.assign(nd.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let a=!1;return this._synced||(this._synced=!0,a=!0),a}_syncMethod(a,b){let c=this["_original_"+a]=this[a];this[a]=(...a)=>{let d=a[b],e=this.context.transport.schedule(d=>{a[b]=d,c.apply(this,a)},d);this._scheduledEvents.push(e)}}unsync(){return this._scheduledEvents.forEach(a=>this.context.transport.clear(a)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(a,b,c,d){let e=this.toSeconds(c),f=this.toSeconds(b);return this.triggerAttack(a,e,d),this.triggerRelease(e+f),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class oE extends oD{constructor(){super(mt(oE.getDefaults(),arguments));let a=mt(oE.getDefaults(),arguments);this.portamento=a.portamento,this.onsilence=a.onsilence}static getDefaults(){return Object.assign(oD.getDefaults(),{detune:0,onsilence:mM,portamento:0})}triggerAttack(a,b,c=1){this.log("triggerAttack",a,b,c);let d=this.toSeconds(b);return this._triggerEnvelopeAttack(d,c),this.setNote(a,d),this}triggerRelease(a){this.log("triggerRelease",a);let b=this.toSeconds(a);return this._triggerEnvelopeRelease(b),this}setNote(a,b){let c=this.toSeconds(b),d=a instanceof m4?a.toFrequency():a;if(this.portamento>0&&this.getLevelAtTime(c)>.05){let e=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(d,e,c)}else this.frequency.setValueAtTime(d,c);return this}}mn([oo(0)],oE.prototype,"portamento",void 0);class oF extends oB{constructor(){super(mt(oF.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new nh({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class oG extends oE{constructor(){super(mt(oG.getDefaults(),arguments)),this.name="Synth";let a=mt(oG.getDefaults(),arguments);this.oscillator=new oi(Object.assign({context:this.context,detune:a.detune,onstop:()=>this.onsilence(this)},a.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new oF(Object.assign({context:this.context},a.envelope)),this.oscillator.chain(this.envelope,this.output),mK(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(oE.getDefaults(),{envelope:Object.assign(mv(oB.getDefaults(),Object.keys(nd.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(mv(oi.getDefaults(),[...Object.keys(nF.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(a,b){if(this.envelope.triggerAttack(a,b),this.oscillator.start(a),0===this.envelope.sustain){let c=this.toSeconds(this.envelope.attack),d=this.toSeconds(this.envelope.decay);this.oscillator.stop(a+c+d)}}_triggerEnvelopeRelease(a){this.envelope.triggerRelease(a),this.oscillator.stop(a+this.toSeconds(this.envelope.release))}getLevelAtTime(a){return a=this.toSeconds(a),this.envelope.getValueAtTime(a)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class oH extends oE{constructor(){super(mt(oH.getDefaults(),arguments)),this.name="ModulationSynth";let a=mt(oH.getDefaults(),arguments);this._carrier=new oG({context:this.context,oscillator:a.oscillator,envelope:a.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new oG({context:this.context,oscillator:a.modulation,envelope:a.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new nk({context:this.context,units:"frequency"}),this.detune=new nk({context:this.context,value:a.detune,units:"cents"}),this.harmonicity=new ob({context:this.context,value:a.harmonicity,minValue:0}),this._modulationNode=new nh({context:this.context,gain:0}),mK(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(oE.getDefaults(),{harmonicity:3,oscillator:Object.assign(mv(oi.getDefaults(),[...Object.keys(nF.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(mv(oB.getDefaults(),Object.keys(nd.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(mv(oi.getDefaults(),[...Object.keys(nF.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(mv(oB.getDefaults(),Object.keys(nd.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(a,b){this._carrier._triggerEnvelopeAttack(a,b),this._modulator._triggerEnvelopeAttack(a,b)}_triggerEnvelopeRelease(a){return this._carrier._triggerEnvelopeRelease(a),this._modulator._triggerEnvelopeRelease(a),this}getLevelAtTime(a){return a=this.toSeconds(a),this.envelope.getValueAtTime(a)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class oI extends oH{constructor(){super(mt(oI.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new oa({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class oJ extends nd{constructor(){super(mt(oJ.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";let a=mt(oJ.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new nc({context:this.context,units:"number",value:a.Q,param:this._filter.Q}),this.frequency=new nc({context:this.context,units:"frequency",value:a.frequency,param:this._filter.frequency}),this.detune=new nc({context:this.context,units:"cents",value:a.detune,param:this._filter.detune}),this.gain=new nc({context:this.context,units:"decibels",convert:!1,value:a.gain,param:this._filter.gain}),this.type=a.type}static getDefaults(){return Object.assign(nd.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(a){l3(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(a),`Invalid filter type: ${a}`),this._filter.type=a}getFrequencyResponse(a=128){let b=new Float32Array(a);for(let c=0;c<a;c++){let d=Math.pow(c/a,2),e=19980*d+20;b[c]=e}let f=new Float32Array(a),g=new Float32Array(a),h=this.context.createBiquadFilter();return h.type=this.type,h.Q.value=this.Q.value,h.frequency.value=this.frequency.value,h.gain.value=this.gain.value,h.getFrequencyResponse(b,f,g),f}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class oK extends nd{constructor(){super(mt(oK.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new nh({context:this.context}),this.output=new nh({context:this.context}),this._filters=[];let a=mt(oK.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new nk({context:this.context,units:"positive",value:a.Q}),this.frequency=new nk({context:this.context,units:"frequency",value:a.frequency}),this.detune=new nk({context:this.context,units:"cents",value:a.detune}),this.gain=new nk({context:this.context,units:"decibels",convert:!1,value:a.gain}),this._type=a.type,this.rolloff=a.rolloff,mK(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(nd.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(a){l3(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(a),`Invalid filter type: ${a}`),this._type=a,this._filters.forEach(b=>b.type=a)}get rolloff(){return this._rolloff}set rolloff(a){let b=md(a)?a:parseInt(a,10),c=[-12,-24,-48,-96],d=c.indexOf(b);l3(-1!==d,`rolloff can only be ${c.join(", ")}`),d+=1,this._rolloff=b,this.input.disconnect(),this._filters.forEach(a=>a.disconnect()),this._filters=Array(d);for(let e=0;e<d;e++){let f=new oJ({context:this.context});f.type=this._type,this.frequency.connect(f.frequency),this.detune.connect(f.detune),this.Q.connect(f.Q),this.gain.connect(f.gain),this._filters[e]=f}this._internalChannels=this._filters,ne(this.input,...this._internalChannels,this.output)}getFrequencyResponse(a=128){let b=new oJ({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),c=new Float32Array(a).map(()=>1);return this._filters.forEach(()=>{let d=b.getFrequencyResponse(a);d.forEach((a,b)=>c[b]*=a)}),b.dispose(),c}dispose(){return super.dispose(),this._filters.forEach(a=>{a.dispose()}),mL(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class oL extends oB{constructor(){super(mt(oL.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";let a=mt(oL.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=a.octaves,this._baseFrequency=this.toFrequency(a.baseFrequency),this._exponent=this.input=new oy({context:this.context,value:a.exponent}),this._scale=this.output=new ok({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(oB.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(a){let b=this.toFrequency(a);l4(b,0),this._baseFrequency=b,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(a){this._octaves=a,this._scale.max=this._baseFrequency*Math.pow(2,a)}get exponent(){return this._exponent.value}set exponent(a){this._exponent.value=a}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class oM extends oE{constructor(){super(mt(oM.getDefaults(),arguments)),this.name="MonoSynth";let a=mt(oM.getDefaults(),arguments);this.oscillator=new oi(Object.assign(a.oscillator,{context:this.context,detune:a.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new oK(Object.assign(a.filter,{context:this.context})),this.filterEnvelope=new oL(Object.assign(a.filterEnvelope,{context:this.context})),this.envelope=new oF(Object.assign(a.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),mK(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(oE.getDefaults(),{envelope:Object.assign(mv(oB.getDefaults(),Object.keys(nd.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(mv(oK.getDefaults(),Object.keys(nd.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(mv(oL.getDefaults(),Object.keys(nd.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(mv(oi.getDefaults(),Object.keys(nF.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(a,b=1){if(this.envelope.triggerAttack(a,b),this.filterEnvelope.triggerAttack(a),this.oscillator.start(a),0===this.envelope.sustain){let c=this.toSeconds(this.envelope.attack),d=this.toSeconds(this.envelope.decay);this.oscillator.stop(a+c+d)}}_triggerEnvelopeRelease(a){this.envelope.triggerRelease(a),this.filterEnvelope.triggerRelease(a),this.oscillator.stop(a+this.toSeconds(this.envelope.release))}getLevelAtTime(a){return a=this.toSeconds(a),this.envelope.getValueAtTime(a)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class oN extends oE{constructor(){super(mt(oN.getDefaults(),arguments)),this.name="DuoSynth";let a=mt(oN.getDefaults(),arguments);this.voice0=new oM(Object.assign(a.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new oM(Object.assign(a.voice1,{context:this.context})),this.harmonicity=new ob({context:this.context,units:"positive",value:a.harmonicity}),this._vibrato=new om({frequency:a.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new nh({context:this.context,units:"normalRange",gain:a.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new nk({context:this.context,units:"frequency",value:440}),this.detune=new nk({context:this.context,units:"cents",value:a.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),mK(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(a){return a=this.toSeconds(a),this.voice0.envelope.getValueAtTime(a)+this.voice1.envelope.getValueAtTime(a)}static getDefaults(){return ms(oE.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:ms(mv(oM.getDefaults(),Object.keys(oE.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:ms(mv(oM.getDefaults(),Object.keys(oE.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(a,b){this.voice0._triggerEnvelopeAttack(a,b),this.voice1._triggerEnvelopeAttack(a,b)}_triggerEnvelopeRelease(a){return this.voice0._triggerEnvelopeRelease(a),this.voice1._triggerEnvelopeRelease(a),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class oO extends oH{constructor(){super(mt(oO.getDefaults(),arguments)),this.name="FMSynth";let a=mt(oO.getDefaults(),arguments);this.modulationIndex=new ob({context:this.context,value:a.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(oH.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}let oP=[1,1.483,1.932,2.546,2.63,3.897];class oQ extends oE{constructor(){super(mt(oQ.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];let a=mt(oQ.getDefaults(),arguments);this.detune=new nk({context:this.context,units:"cents",value:a.detune}),this.frequency=new nk({context:this.context,units:"frequency"}),this._amplitude=new nh({context:this.context,gain:0}).connect(this.output),this._highpass=new oK({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let b=0;b<oP.length;b++){let c=new od({context:this.context,harmonicity:a.harmonicity,modulationIndex:a.modulationIndex,modulationType:"square",onstop:0===b?()=>this.onsilence(this):mM,type:"square"});c.connect(this._highpass),this._oscillators[b]=c;let d=new ob({context:this.context,value:oP[b]});this._freqMultipliers[b]=d,this.frequency.chain(d,c.frequency),this.detune.connect(c.detune)}this._filterFreqScaler=new ok({context:this.context,max:7e3,min:this.toFrequency(a.resonance)}),this.envelope=new oB({attack:a.envelope.attack,attackCurve:"linear",context:this.context,decay:a.envelope.decay,release:a.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=a.octaves,this.octaves=a.octaves}static getDefaults(){return ms(oE.getDefaults(),{envelope:Object.assign(mv(oB.getDefaults(),Object.keys(nd.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(a,b=1){return this.envelope.triggerAttack(a,b),this._oscillators.forEach(b=>b.start(a)),0===this.envelope.sustain&&this._oscillators.forEach(b=>{b.stop(a+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(a){return this.envelope.triggerRelease(a),this._oscillators.forEach(b=>b.stop(a+this.toSeconds(this.envelope.release))),this}getLevelAtTime(a){return a=this.toSeconds(a),this.envelope.getValueAtTime(a)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(a){this._oscillators.forEach(b=>b.modulationIndex.value=a)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(a){this._oscillators.forEach(b=>b.harmonicity.value=a)}get resonance(){return this._filterFreqScaler.min}set resonance(a){this._filterFreqScaler.min=this.toFrequency(a),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(a){this._octaves=a,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,a)}dispose(){return super.dispose(),this._oscillators.forEach(a=>a.dispose()),this._freqMultipliers.forEach(a=>a.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class oR extends oG{constructor(){super(mt(oR.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;let a=mt(oR.getDefaults(),arguments);this.pitchDecay=a.pitchDecay,this.octaves=a.octaves,mK(this,["oscillator","envelope"])}static getDefaults(){return ms(oE.getDefaults(),oG.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(a,b){let c=this.toSeconds(b),d=this.toFrequency(a instanceof m4?a.toFrequency():a),e=d*this.octaves;return this.oscillator.frequency.setValueAtTime(e,c),this.oscillator.frequency.exponentialRampToValueAtTime(d,c+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}mn([on(0)],oR.prototype,"octaves",void 0),mn([oo(0)],oR.prototype,"pitchDecay",void 0);class oS extends oD{constructor(){super(mt(oS.getDefaults(),arguments)),this.name="NoiseSynth";let a=mt(oS.getDefaults(),arguments);this.noise=new nH(Object.assign({context:this.context},a.noise)),this.envelope=new oF(Object.assign({context:this.context},a.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(oD.getDefaults(),{envelope:Object.assign(mv(oB.getDefaults(),Object.keys(nd.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(mv(nH.getDefaults(),Object.keys(nF.getDefaults())),{type:"white"})})}triggerAttack(a,b=1){return a=this.toSeconds(a),this.envelope.triggerAttack(a,b),this.noise.start(a),0===this.envelope.sustain&&this.noise.stop(a+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(a){return a=this.toSeconds(a),this.envelope.triggerRelease(a),this.noise.stop(a+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(a,b,c=1){return b=this.toSeconds(b),a=this.toSeconds(a),this.triggerAttack(b,c),this.triggerRelease(b+a),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}let oT=new Set;function oU(a){oT.add(a)}function oV(a,b){let c=`registerProcessor("${a}", ${b})`;oT.add(c)}class oW extends nd{constructor(a){super(a),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=mM;let b=URL.createObjectURL(new Blob([Array.from(oT).join("\n")],{type:"text/javascript"})),c=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(b,c).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(c,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}let oX=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;oU(oX);let oY=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;oU(oY);let oZ=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;oU(oZ);let o$="feedback-comb-filter",o_=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;oV(o$,o_);class o0 extends oW{constructor(){super(mt(o0.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";let a=mt(o0.getDefaults(),arguments,["delayTime","resonance"]);this.input=new nh({context:this.context}),this.output=new nh({context:this.context}),this.delayTime=new nc({context:this.context,value:a.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new nc({context:this.context,value:a.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),mK(this,["resonance","delayTime"])}_audioWorkletName(){return o$}static getDefaults(){return Object.assign(nd.getDefaults(),{delayTime:.1,resonance:.5})}onReady(a){ne(this.input,a,this.output);let b=a.parameters.get("delayTime");this.delayTime.setParam(b);let c=a.parameters.get("feedback");this.resonance.setParam(c)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class o1 extends nd{constructor(){super(mt(o1.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";let a=mt(o1.getDefaults(),arguments,["frequency","type"]);this._frequency=a.frequency,this._type=a.type,this.input=new nh({context:this.context}),this.output=new nh({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(nd.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){let a=this._filter,b=this.toFrequency(this._frequency),c=1/(2*Math.PI*b);if("lowpass"===this._type){let d=1/(c*this.context.sampleRate),e=d-1;this._filter=this.context.createIIRFilter([d,0],[1,e])}else{let f=1/(c*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,f])}this.input.chain(this._filter,this.output),a&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(a),a.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(a){this._frequency=a,this._createFilter()}get type(){return this._type}set type(a){this._type=a,this._createFilter()}getFrequencyResponse(a=128){let b=new Float32Array(a);for(let c=0;c<a;c++){let d=Math.pow(c/a,2),e=19980*d+20;b[c]=e}let f=new Float32Array(a),g=new Float32Array(a);return this._filter.getFrequencyResponse(b,f,g),f}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class o2 extends nd{constructor(){super(mt(o2.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";let a=mt(o2.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new o0({context:this.context,delayTime:a.delayTime,resonance:a.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new o1({context:this.context,frequency:a.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(nd.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(a){this._lowpass.frequency=a}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class o3 extends oD{constructor(){super(mt(o3.getDefaults(),arguments)),this.name="PluckSynth";let a=mt(o3.getDefaults(),arguments);this._noise=new nH({context:this.context,type:"pink"}),this.attackNoise=a.attackNoise,this._lfcf=new o2({context:this.context,dampening:a.dampening,resonance:a.resonance}),this.resonance=a.resonance,this.release=a.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return ms(oD.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(a){this._lfcf.dampening=a}triggerAttack(a,b){let c=this.toFrequency(a);b=this.toSeconds(b);let d=1/c;return this._lfcf.delayTime.setValueAtTime(d,b),this._noise.start(b),this._noise.stop(b+d*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(b),this._lfcf.resonance.setValueAtTime(this.resonance,b),this}triggerRelease(a){return this._lfcf.resonance.linearRampTo(0,this.release,a),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class o4 extends oD{constructor(){super(mt(o4.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;let a=mt(o4.getDefaults(),arguments,["voice","options"]);l3(!md(a.voice),"DEPRECATED: The polyphony count is no longer the first argument.");let b=a.voice.getDefaults();this.options=Object.assign(b,a.options),this.voice=a.voice,this.maxPolyphony=a.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();let c=this._voices.indexOf(this._dummyVoice);this._voices.splice(c,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(oD.getDefaults(),{maxPolyphony:32,options:{},voice:oG})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(a){this._availableVoices.push(a);let b=this._activeVoices.findIndex(b=>b.voice===a);this._activeVoices.splice(b,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){let a=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return a.connect(this.output),this._voices.push(a),a}l9("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){let a=this._availableVoices.shift(),b=this._voices.indexOf(a);this._voices.splice(b,1),this.context.isOffline||a.dispose()}}_triggerAttack(a,b,c){a.forEach(a=>{let d=new nt(this.context,a).toMidi(),e=this._getNextAvailableVoice();e&&(e.triggerAttack(a,b,c),this._activeVoices.push({midi:d,voice:e,released:!1}),this.log("triggerAttack",a,b))})}_triggerRelease(a,b){a.forEach(a=>{let c=new nt(this.context,a).toMidi(),d=this._activeVoices.find(({midi:a,released:b})=>a===c&&!b);d&&(d.voice.triggerRelease(b),d.released=!0,this.log("triggerRelease",a,b))})}_scheduleEvent(a,b,c,d){l3(!this.disposed,"Synth was already disposed"),c<=this.now()?"attack"===a?this._triggerAttack(b,c,d):this._triggerRelease(b,c):this.context.setTimeout(()=>{this._scheduleEvent(a,b,c,d)},c-this.now())}triggerAttack(a,b,c){Array.isArray(a)||(a=[a]);let d=this.toSeconds(b);return this._scheduleEvent("attack",a,d,c),this}triggerRelease(a,b){Array.isArray(a)||(a=[a]);let c=this.toSeconds(b);return this._scheduleEvent("release",a,c),this}triggerAttackRelease(a,b,c,d){let e=this.toSeconds(c);if(this.triggerAttack(a,e,d),mg(b)){l3(mg(a),"If the duration is an array, the notes must also be an array");for(let f=0;f<a.length;f++){let g=b[Math.min(f,b.length-1)],h=this.toSeconds(g);l3(h>0,"The duration must be greater than 0"),this.triggerRelease(a[f],e+h)}}else{let i=this.toSeconds(b);l3(i>0,"The duration must be greater than 0"),this.triggerRelease(a,e+i)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(a){let b=mv(a,["onsilence","context"]);return this.options=ms(this.options,b),this._voices.forEach(a=>a.set(b)),this._dummyVoice.set(b),this}get(){return this._dummyVoice.get()}releaseAll(a){let b=this.toSeconds(a);return this._activeVoices.forEach(({voice:a})=>{a.triggerRelease(b)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(a=>a.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class o5 extends oD{constructor(){super(mt(o5.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;let a=mt(o5.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),b={};Object.keys(a.urls).forEach(c=>{let d=parseInt(c,10);if(l3(mi(c)||md(d)&&isFinite(d),`url key is neither a note or midi pitch: ${c}`),mi(c)){let e=new m4(this.context,c).toMidi();b[e]=a.urls[c]}else md(d)&&isFinite(d)&&(b[d]=a.urls[d])}),this._buffers=new ns({urls:b,onload:a.onload,baseUrl:a.baseUrl,onerror:a.onerror}),this.attack=a.attack,this.release=a.release,this.curve=a.curve,this._buffers.loaded&&Promise.resolve().then(a.onload)}static getDefaults(){return Object.assign(oD.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:mM,onerror:mM,release:.1,urls:{}})}_findClosest(a){let b=0;for(;b<96;){if(this._buffers.has(a+b))return-b;if(this._buffers.has(a-b))return b;b++}throw Error(`No available buffers for note: ${a}`)}triggerAttack(a,b,c=1){return this.log("triggerAttack",a,b,c),Array.isArray(a)||(a=[a]),a.forEach(a=>{let d=m_(new m4(this.context,a).toFrequency()),e=Math.round(d),f=this._findClosest(e),g=this._buffers.get(e-f),h=mY(f+(d-e)),i=new nG({url:g,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);i.start(b,0,g.duration/h,c),mg(this._activeSources.get(e))||this._activeSources.set(e,[]),this._activeSources.get(e).push(i),i.onended=()=>{if(this._activeSources&&this._activeSources.has(e)){let a=this._activeSources.get(e),b=a.indexOf(i);-1!==b&&a.splice(b,1)}}}),this}triggerRelease(a,b){return this.log("triggerRelease",a,b),Array.isArray(a)||(a=[a]),a.forEach(a=>{let c=new m4(this.context,a).toMidi();if(this._activeSources.has(c)&&this._activeSources.get(c).length){let d=this._activeSources.get(c);b=this.toSeconds(b),d.forEach(a=>{a.stop(b)}),this._activeSources.set(c,[])}}),this}releaseAll(a){let b=this.toSeconds(a);return this._activeSources.forEach(a=>{for(;a.length;){let c=a.shift();c.stop(b)}}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(a,b,c,d=1){let e=this.toSeconds(c);return this.triggerAttack(a,e,d),mg(b)?(l3(mg(a),"notes must be an array when duration is array"),a.forEach((a,c)=>{let d=b[Math.min(c,b.length-1)];this.triggerRelease(a,e+this.toSeconds(d))})):this.triggerRelease(a,e+this.toSeconds(b)),this}add(a,b,c){if(l3(mi(a)||isFinite(a),`note must be a pitch or midi: ${a}`),mi(a)){let d=new m4(this.context,a).toMidi();this._buffers.add(d,b,c)}else this._buffers.add(a,b,c);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(a=>{a.forEach(a=>a.dispose())}),this._activeSources.clear(),this}}mn([oo(0)],o5.prototype,"attack",void 0),mn([oo(0)],o5.prototype,"release",void 0);class o6 extends na{constructor(){super(mt(o6.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new nb("stopped"),this._startOffset=0;let a=mt(o6.getDefaults(),arguments,["callback","value"]);this._loop=a.loop,this.callback=a.callback,this.value=a.value,this._loopStart=this.toTicks(a.loopStart),this._loopEnd=this.toTicks(a.loopEnd),this._playbackRate=a.playbackRate,this._probability=a.probability,this._humanize=a.humanize,this.mute=a.mute,this._playbackRate=a.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(na.getDefaults(),{callback:mM,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(a=-1){this._state.forEachFrom(a,a=>{let b;if("started"===a.state){-1!==a.id&&this.context.transport.clear(a.id);let c=a.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||md(this._loop)&&this._loop>1){b=1/0,md(this._loop)&&(b=this._loop*this._getLoopDuration());let d=this._state.getAfter(c);null!==d&&(b=Math.min(b,d.time-c)),b!==1/0&&(this._state.setStateAtTime("stopped",c+b+1,{id:-1}),b=new nv(this.context,b));let e=new nv(this.context,this._getLoopDuration());a.id=this.context.transport.scheduleRepeat(this._tick.bind(this),e,new nv(this.context,c),b)}else a.id=this.context.transport.schedule(this._tick.bind(this),new nv(this.context,c))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(a){this._startOffset=a}get probability(){return this._probability}set probability(a){this._probability=a}get humanize(){return this._humanize}set humanize(a){this._humanize=a}start(a){let b=this.toTicks(a);return"stopped"===this._state.getValueAtTime(b)&&(this._state.add({id:-1,state:"started",time:b}),this._rescheduleEvents(b)),this}stop(a){this.cancel(a);let b=this.toTicks(a);if("started"===this._state.getValueAtTime(b)){this._state.setStateAtTime("stopped",b,{id:-1});let c=this._state.getBefore(b),d=b;null!==c&&(d=c.time),this._rescheduleEvents(d)}return this}cancel(a){a=mu(a,-1/0);let b=this.toTicks(a);return this._state.forEachFrom(b,a=>{this.context.transport.clear(a.id)}),this._state.cancel(b),this}_tick(a){let b=this.context.transport.getTicksAtTime(a);if(!this.mute&&"started"===this._state.getValueAtTime(b)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let c=.02;mf(this.humanize)||(c=this.toSeconds(this.humanize)),a+=(2*Math.random()-1)*c}this.callback(a,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(a){this._loop=a,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(a){this._playbackRate=a,this._rescheduleEvents()}get loopEnd(){return new nv(this.context,this._loopEnd).toSeconds()}set loopEnd(a){this._loopEnd=this.toTicks(a),this._loop&&this._rescheduleEvents()}get loopStart(){return new nv(this.context,this._loopStart).toSeconds()}set loopStart(a){this._loopStart=this.toTicks(a),this._loop&&this._rescheduleEvents()}get progress(){if(!this._loop)return 0;{let a=this.context.transport.ticks,b=this._state.get(a);if(null===b||"started"!==b.state)return 0;{let c=this._getLoopDuration(),d=(a-b.time)%c;return d/c}}}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class o7 extends na{constructor(){super(mt(o7.getDefaults(),arguments,["callback","interval"])),this.name="Loop";let a=mt(o7.getDefaults(),arguments,["callback","interval"]);this._event=new o6({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:a.interval,playbackRate:a.playbackRate,probability:a.probability}),this.callback=a.callback,this.iterations=a.iterations}static getDefaults(){return Object.assign(na.getDefaults(),{interval:"4n",callback:mM,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(a){return this._event.start(a),this}stop(a){return this._event.stop(a),this}cancel(a){return this._event.cancel(a),this}_tick(a){this.callback(a)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(a){this._event.loopEnd=a}get playbackRate(){return this._event.playbackRate}set playbackRate(a){this._event.playbackRate=a}get humanize(){return this._event.humanize}set humanize(a){this._event.humanize=a}get probability(){return this._event.probability}set probability(a){this._event.probability=a}get mute(){return this._event.mute}set mute(a){this._event.mute=a}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(a){a===1/0?this._event.loop=!0:this._event.loop=a}dispose(){return super.dispose(),this._event.dispose(),this}}class o8 extends o6{constructor(){super(mt(o8.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new nb("stopped"),this._events=new Set;let a=mt(o8.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,a.events.forEach(a=>{mg(a)?this.add(a[0],a[1]):this.add(a)})}static getDefaults(){return Object.assign(o6.getDefaults(),{events:[]})}start(a,b){let c=this.toTicks(a);if("started"!==this._state.getValueAtTime(c)){b=mu(b,this._loop?this._loopStart:0),b=this._loop?mu(b,this._loopStart):mu(b,0);let d=this.toTicks(b);this._state.add({id:-1,offset:d,state:"started",time:c}),this._forEach(a=>{this._startNote(a,c,d)})}return this}_startNote(a,b,c){b-=c,this._loop?a.startOffset>=this._loopStart&&a.startOffset<this._loopEnd?(a.startOffset<c&&(b+=this._getLoopDuration()),a.start(new nv(this.context,b))):a.startOffset<this._loopStart&&a.startOffset>=c&&(a.loop=!1,a.start(new nv(this.context,b))):a.startOffset>=c&&a.start(new nv(this.context,b))}get startOffset(){return this._startOffset}set startOffset(a){this._startOffset=a,this._forEach(a=>{a.startOffset+=this._startOffset})}stop(a){let b=this.toTicks(a);return this._state.cancel(b),this._state.setStateAtTime("stopped",b),this._forEach(b=>{b.stop(a)}),this}at(a,b){let c=new m8(this.context,a).toTicks(),d=new nv(this.context,1).toSeconds(),e=this._events.values(),f=e.next();for(;!f.done;){let g=f.value;if(Math.abs(c-g.startOffset)<d)return mb(b)&&(g.value=b),g;f=e.next()}return mb(b)?(this.add(a,b),this.at(a)):null}add(a,b){a instanceof Object&&Reflect.has(a,"time")&&(a=(b=a).time);let c=this.toTicks(a),d;return b instanceof o6?(d=b).callback=this._tick.bind(this):d=new o6({callback:this._tick.bind(this),context:this.context,value:b}),d.startOffset=c,d.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(d),this._restartEvent(d),this}_restartEvent(a){this._state.forEach(b=>{"started"===b.state?this._startNote(a,b.time,b.offset):a.stop(new nv(this.context,b.time))})}remove(a,b){return me(a)&&a.hasOwnProperty("time")&&(a=(b=a).time),a=this.toTicks(a),this._events.forEach(c=>{c.startOffset===a&&(ma(b)||mb(b)&&c.value===b)&&(this._events.delete(c),c.dispose())}),this}clear(){return this._forEach(a=>a.dispose()),this._events.clear(),this}cancel(a){return this._forEach(b=>b.cancel(a)),this._state.cancel(this.toTicks(a)),this}_forEach(a){return this._events&&this._events.forEach(b=>{b instanceof o8?b._forEach(a):a(b)}),this}_setAll(a,b){this._forEach(c=>{c[a]=b})}_tick(a,b){this.mute||this.callback(a,b)}_testLoopBoundries(a){this._loop&&(a.startOffset<this._loopStart||a.startOffset>=this._loopEnd)?a.cancel(0):"stopped"===a.state&&this._restartEvent(a)}get probability(){return this._probability}set probability(a){this._probability=a,this._setAll("probability",a)}get humanize(){return this._humanize}set humanize(a){this._humanize=a,this._setAll("humanize",a)}get loop(){return this._loop}set loop(a){this._loop=a,this._forEach(b=>{b.loopStart=this.loopStart,b.loopEnd=this.loopEnd,b.loop=a,this._testLoopBoundries(b)})}get loopEnd(){return new nv(this.context,this._loopEnd).toSeconds()}set loopEnd(a){this._loopEnd=this.toTicks(a),this._loop&&this._forEach(b=>{b.loopEnd=a,this._testLoopBoundries(b)})}get loopStart(){return new nv(this.context,this._loopStart).toSeconds()}set loopStart(a){this._loopStart=this.toTicks(a),this._loop&&this._forEach(a=>{a.loopStart=this.loopStart,this._testLoopBoundries(a)})}get playbackRate(){return this._playbackRate}set playbackRate(a){this._playbackRate=a,this._setAll("playbackRate",a)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*o9(a){let b=0;for(;b<a.length;)b=pc(b,a),yield a[b],b++}function*pa(a){let b=a.length-1;for(;b>=0;)b=pc(b,a),yield a[b],b--}function*pb(a,b){for(;;)yield*b(a)}function pc(a,b){return mB(a,0,b.length-1)}function*pd(a,b){let c=b?0:a.length-1;for(;;)c=pc(c,a),yield a[c],b?++c>=a.length-1&&(b=!1):--c<=0&&(b=!0)}function*pe(a){let b=0,c=0;for(;b<a.length;)b=pc(b,a),yield a[b],c++,b+=c%2?2:-1}function*pf(a){let b=a.length-1,c=0;for(;b>=0;)b=pc(b,a),yield a[b],c++,b+=c%2?-2:1}function*pg(a){let b=[];for(let c=0;c<a.length;c++)b.push(c);for(;b.length>0;){let d=b.splice(Math.floor(b.length*Math.random()),1),e=pc(d[0],a);yield a[e]}}function*ph(a,b="up",c=0){switch(l3(a.length>0,"The array must have more than one value in it"),b){case"up":yield*pb(a,o9);case"down":yield*pb(a,pa);case"upDown":yield*pd(a,!0);case"downUp":yield*pd(a,!1);case"alternateUp":yield*pb(a,pe);case"alternateDown":yield*pb(a,pf);case"random":yield*function*(a){for(;;){let b=Math.floor(Math.random()*a.length);yield a[b]}}(a);case"randomOnce":yield*pb(a,pg);case"randomWalk":yield*function*(a){let b=Math.floor(Math.random()*a.length);for(;;)0===b?b++:b===a.length-1?b--:.5>Math.random()?b--:b++,yield a[b]}(a)}}class pi extends o7{constructor(){super(mt(pi.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";let a=mt(pi.getDefaults(),arguments,["callback","values","pattern"]);this.callback=a.callback,this._values=a.values,this._pattern=ph(a.values,a.pattern),this._type=a.pattern}static getDefaults(){return Object.assign(o7.getDefaults(),{pattern:"up",values:[],callback:mM})}_tick(a){let b=this._pattern.next();this._value=b.value,this.callback(a,this._value)}get values(){return this._values}set values(a){this._values=a,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(a){this._type=a,this._pattern=ph(this._values,this._type)}}class pj extends o6{constructor(){super(mt(pj.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new o8({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];let a=mt(pj.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(a.subdivision),this.events=a.events,this.loop=a.loop,this.loopStart=a.loopStart,this.loopEnd=a.loopEnd,this.playbackRate=a.playbackRate,this.probability=a.probability,this.humanize=a.humanize,this.mute=a.mute,this.playbackRate=a.playbackRate}static getDefaults(){return Object.assign(mv(o6.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(a,b){null!==b&&this.callback(a,b)}get events(){return this._events}set events(a){this.clear(),this._eventsArray=a,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(a,b){return this._part.start(a,b?this._indexTime(b):b),this}stop(a){return this._part.stop(a),this}get subdivision(){return new nv(this.context,this._subdivision).toSeconds()}_createSequence(a){return new Proxy(a,{get:(a,b)=>a[b],set:(a,b,c)=>(mh(b)&&isFinite(parseInt(b,10))&&mg(c)?a[b]=this._createSequence(c):a[b]=c,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(a,b,c){a.forEach((a,d)=>{let e=d*b+c;if(mg(a))this._rescheduleSequence(a,b/a.length,e);else{let f=new nv(this.context,e,"i").toSeconds();this._part.add(f,a)}})}_indexTime(a){return new nv(this.context,a*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(a){this._part.loop=a}get loopStart(){return this._loopStart}set loopStart(a){this._loopStart=a,this._part.loopStart=this._indexTime(a)}get loopEnd(){return this._loopEnd}set loopEnd(a){this._loopEnd=a,0===a?this._part.loopEnd=this._indexTime(this._eventsArray.length):this._part.loopEnd=this._indexTime(a)}get startOffset(){return this._part.startOffset}set startOffset(a){this._part.startOffset=a}get playbackRate(){return this._part.playbackRate}set playbackRate(a){this._part.playbackRate=a}get probability(){return this._part.probability}set probability(a){this._part.probability=a}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(a){this._part.humanize=a}get length(){return this._part.length}}class pk extends nd{constructor(){super(Object.assign(mt(pk.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new ot({context:this.context}),this.a=new nh({context:this.context,gain:0}),this.b=new nh({context:this.context,gain:0}),this.output=new nh({context:this.context}),this._internalChannels=[this.a,this.b];let a=mt(pk.getDefaults(),arguments,["fade"]);this.fade=new nk({context:this.context,units:"normalRange",value:a.fade}),mK(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",nf(this._split,this.a.gain,0),nf(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(nd.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class pl extends nd{constructor(a){super(a),this.name="Effect",this._dryWet=new pk({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new nh({context:this.context}),this.effectReturn=new nh({context:this.context}),this.input=new nh({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(a.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],mK(this,"wet")}static getDefaults(){return Object.assign(nd.getDefaults(),{wet:1})}connectEffect(a){return this._internalChannels.push(a),this.effectSend.chain(a,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class pm extends pl{constructor(a){super(a),this.name="LFOEffect",this._lfo=new om({context:this.context,frequency:a.frequency,amplitude:a.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=a.type,mK(this,["frequency","depth"])}static getDefaults(){return Object.assign(pl.getDefaults(),{frequency:1,type:"sine",depth:1})}start(a){return this._lfo.start(a),this}stop(a){return this._lfo.stop(a),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(a){this._lfo.type=a}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class pn extends pm{constructor(){super(mt(pn.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";let a=mt(pn.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new oK(Object.assign(a.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=a.octaves,this.baseFrequency=a.baseFrequency}static getDefaults(){return Object.assign(pm.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(a){this._lfo.min=this.toFrequency(a),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(a){this._octaves=a,this._lfo.max=this._lfo.min*Math.pow(2,a)}dispose(){return super.dispose(),this.filter.dispose(),this}}class po extends nd{constructor(){super(Object.assign(mt(po.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let a=mt(po.getDefaults(),arguments,["pan"]);this.pan=new nc({context:this.context,param:this._panner.pan,value:a.pan,minValue:-1,maxValue:1}),this._panner.channelCount=a.channelCount,this._panner.channelCountMode="explicit",mK(this,"pan")}static getDefaults(){return Object.assign(nd.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class pp extends pm{constructor(){super(mt(pp.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";let a=mt(pp.getDefaults(),arguments,["frequency"]);this._panner=new po({context:this.context,channelCount:a.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(pm.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class pq extends nd{constructor(){super(mt(pq.getDefaults(),arguments,["smoothing"])),this.name="Follower";let a=mt(pq.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new os({context:this.context}),this._lowpass=this.output=new o1({context:this.context,frequency:1/this.toSeconds(a.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=a.smoothing}static getDefaults(){return Object.assign(nd.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(a){this._smoothing=a,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class pr extends pl{constructor(){super(mt(pr.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";let a=mt(pr.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new pq({context:this.context,smoothing:a.follower}),this._sweepRange=new oz({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(a.baseFrequency),this._octaves=a.octaves,this._inputBoost=new nh({context:this.context}),this._bandpass=new oK({context:this.context,rolloff:-48,frequency:0,Q:a.Q}),this._peaking=new oK({context:this.context,type:"peaking"}),this._peaking.gain.value=a.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=a.sensitivity,mK(this,["gain","Q"])}static getDefaults(){return Object.assign(pl.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(a){this._octaves=a,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(a){this._follower.smoothing=a}get baseFrequency(){return this._baseFrequency}set baseFrequency(a){this._baseFrequency=this.toFrequency(a),this._setSweepRange()}get sensitivity(){return mX(1/this._inputBoost.gain.value)}set sensitivity(a){this._inputBoost.gain.value=1/mW(a)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}let ps="bit-crusher",pt=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;oV(ps,pt);class pu extends pl{constructor(){super(mt(pu.getDefaults(),arguments,["bits"])),this.name="BitCrusher";let a=mt(pu.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new pv({context:this.context,bits:a.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(pl.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class pv extends oW{constructor(){super(mt(pv.getDefaults(),arguments)),this.name="BitCrusherWorklet";let a=mt(pv.getDefaults(),arguments);this.input=new nh({context:this.context}),this.output=new nh({context:this.context}),this.bits=new nc({context:this.context,value:a.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(oW.getDefaults(),{bits:12})}_audioWorkletName(){return ps}onReady(a){ne(this.input,a,this.output);let b=a.parameters.get("bits");this.bits.setParam(b)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class pw extends pl{constructor(){super(mt(pw.getDefaults(),arguments,["order"])),this.name="Chebyshev";let a=mt(pw.getDefaults(),arguments,["order"]);this._shaper=new n9({context:this.context,length:4096}),this._order=a.order,this.connectEffect(this._shaper),this.order=a.order,this.oversample=a.oversample}static getDefaults(){return Object.assign(pl.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(a,b,c){return c.has(b)||(0===b?c.set(b,0):1===b?c.set(b,a):c.set(b,2*a*this._getCoefficient(a,b-1,c)-this._getCoefficient(a,b-2,c))),c.get(b)}get order(){return this._order}set order(a){this._order=a,this._shaper.setMap(b=>this._getCoefficient(b,a,new Map))}get oversample(){return this._shaper.oversample}set oversample(a){this._shaper.oversample=a}dispose(){return super.dispose(),this._shaper.dispose(),this}}class px extends nd{constructor(){super(mt(px.getDefaults(),arguments,["channels"])),this.name="Split";let a=mt(px.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(a.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(nd.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class py extends nd{constructor(){super(mt(py.getDefaults(),arguments,["channels"])),this.name="Merge";let a=mt(py.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(a.channels)}static getDefaults(){return Object.assign(nd.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class pz extends nd{constructor(a){super(a),this.name="StereoEffect",this.input=new nh({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new pk({context:this.context,fade:a.wet}),this.wet=this._dryWet.fade,this._split=new px({context:this.context,channels:2}),this._merge=new py({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),mK(this,["wet"])}connectEffectLeft(...a){this._split.connect(a[0],0,0),ne(...a),nf(a[a.length-1],this._merge,0,0)}connectEffectRight(...a){this._split.connect(a[0],1,0),ne(...a),nf(a[a.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(nd.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class pA extends pz{constructor(a){super(a),this.feedback=new nk({context:this.context,value:a.feedback,units:"normalRange"}),this._feedbackL=new nh({context:this.context}),this._feedbackR=new nh({context:this.context}),this._feedbackSplit=new px({context:this.context,channels:2}),this._feedbackMerge=new py({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),mK(this,["feedback"])}static getDefaults(){return Object.assign(pz.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class pB extends pA{constructor(){super(mt(pB.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";let a=mt(pB.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=a.depth,this._delayTime=a.delayTime/1e3,this._lfoL=new om({context:this.context,frequency:a.frequency,min:0,max:1}),this._lfoR=new om({context:this.context,frequency:a.frequency,min:0,max:1,phase:180}),this._delayNodeL=new nq({context:this.context}),this._delayNodeR=new nq({context:this.context}),this.frequency=this._lfoL.frequency,mK(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=a.type,this.spread=a.spread}static getDefaults(){return Object.assign(pA.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(a){this._depth=a;let b=this._delayTime*a;this._lfoL.min=Math.max(this._delayTime-b,0),this._lfoL.max=this._delayTime+b,this._lfoR.min=Math.max(this._delayTime-b,0),this._lfoR.max=this._delayTime+b}get delayTime(){return 1e3*this._delayTime}set delayTime(a){this._delayTime=a/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(a){this._lfoL.type=a,this._lfoR.type=a}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(a){this._lfoL.phase=90-a/2,this._lfoR.phase=a/2+90}start(a){return this._lfoL.start(a),this._lfoR.start(a),this}stop(a){return this._lfoL.stop(a),this._lfoR.stop(a),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class pC extends pl{constructor(){super(mt(pC.getDefaults(),arguments,["distortion"])),this.name="Distortion";let a=mt(pC.getDefaults(),arguments,["distortion"]);this._shaper=new n9({context:this.context,length:4096}),this._distortion=a.distortion,this.connectEffect(this._shaper),this.distortion=a.distortion,this.oversample=a.oversample}static getDefaults(){return Object.assign(pl.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(a){this._distortion=a;let b=100*a,c=Math.PI/180;this._shaper.setMap(a=>.001>Math.abs(a)?0:(3+b)*a*20*c/(Math.PI+b*Math.abs(a)))}get oversample(){return this._shaper.oversample}set oversample(a){this._shaper.oversample=a}dispose(){return super.dispose(),this._shaper.dispose(),this}}class pD extends pl{constructor(a){super(a),this.name="FeedbackEffect",this._feedbackGain=new nh({context:this.context,gain:a.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,mK(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(pl.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class pE extends pD{constructor(){super(mt(pE.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";let a=mt(pE.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new nq({context:this.context,delayTime:a.delayTime,maxDelay:a.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),mK(this,"delayTime")}static getDefaults(){return Object.assign(pD.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class pF extends pl{constructor(){super(mt(pF.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";let a=mt(pF.getDefaults(),arguments,["frequency"]);this.frequency=new nk({context:this.context,units:"frequency",value:a.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new n6({context:this.context,type:"sine"}),this._cosine=new n7({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new ob({context:this.context}),this._cosineMultiply=new ob({context:this.context}),this._negate=new ou({context:this.context}),this._add=new oj({context:this.context}),this._phaseShifter=new class extends nd{constructor(a){super(a),this.name="PhaseShiftAllpass",this.input=new nh({context:this.context}),this.output=new nh({context:this.context}),this.offset90=new nh({context:this.context}),this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),ne(this.input,...this._bank0,this._oneSampleDelay,this.output),ne(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(a){let b=a.map(a=>{let b=[[a*a,0,-1],[1,0,-(a*a)]];return this.context.createIIRFilter(b[0],b[1])});return b}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach(a=>a.disconnect()),this._bank1.forEach(a=>a.disconnect()),this._oneSampleDelay.disconnect(),this}}({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);let b=this.immediate();this._sine.start(b),this._cosine.start(b)}static getDefaults(){return Object.assign(pl.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}let pG=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],pH=[225,556,441,341];class pI extends pz{constructor(){super(mt(pI.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];let a=mt(pI.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new nk({context:this.context,value:a.roomSize,units:"normalRange"}),this._allpassFiltersL=pH.map(a=>{let b=this.context.createBiquadFilter();return b.type="allpass",b.frequency.value=a,b}),this._allpassFiltersR=pH.map(a=>{let b=this.context.createBiquadFilter();return b.type="allpass",b.frequency.value=a,b}),this._combFilters=pG.map((b,c)=>{let d=new o2({context:this.context,dampening:a.dampening,delayTime:b});return c<pG.length/2?this.connectEffectLeft(d,...this._allpassFiltersL):this.connectEffectRight(d,...this._allpassFiltersR),this.roomSize.connect(d.resonance),d}),mK(this,["roomSize"])}static getDefaults(){return Object.assign(pz.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(a){this._combFilters.forEach(b=>b.dampening=a)}dispose(){return super.dispose(),this._allpassFiltersL.forEach(a=>a.disconnect()),this._allpassFiltersR.forEach(a=>a.disconnect()),this._combFilters.forEach(a=>a.dispose()),this.roomSize.dispose(),this}}let pJ=[.06748,.06404,.08212,.09004],pK=[.773,.802,.753,.733];class pL extends pz{constructor(){super(mt(pL.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];let a=mt(pL.getDefaults(),arguments,["roomSize"]);this.roomSize=new nk({context:this.context,value:a.roomSize,units:"normalRange"}),this._scaleRoomSize=new ok({context:this.context,min:-.733,max:.197}),this._allpassFilters=[347,113,37].map(a=>{let b=this.context.createBiquadFilter();return b.type="allpass",b.frequency.value=a,b}),this._feedbackCombFilters=pJ.map((a,b)=>{let c=new o0({context:this.context,delayTime:a});return this._scaleRoomSize.connect(c.resonance),c.resonance.value=pK[b],b<pJ.length/2?this.connectEffectLeft(...this._allpassFilters,c):this.connectEffectRight(...this._allpassFilters,c),c}),this.roomSize.connect(this._scaleRoomSize),mK(this,["roomSize"])}static getDefaults(){return Object.assign(pz.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(a=>a.disconnect()),this._feedbackCombFilters.forEach(a=>a.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class pM extends pA{constructor(a){super(a),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),mK(this,["feedback"])}}class pN extends pM{constructor(){super(mt(pN.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";let a=mt(pN.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new nq({context:this.context,maxDelay:a.maxDelay}),this._rightDelay=new nq({context:this.context,maxDelay:a.maxDelay}),this._rightPreDelay=new nq({context:this.context,maxDelay:a.maxDelay}),this.delayTime=new nk({context:this.context,units:"time",value:a.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),mK(this,["delayTime"])}static getDefaults(){return Object.assign(pM.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class pO extends pD{constructor(){super(mt(pO.getDefaults(),arguments,["pitch"])),this.name="PitchShift";let a=mt(pO.getDefaults(),arguments,["pitch"]);this._frequency=new nk({context:this.context}),this._delayA=new nq({maxDelay:1,context:this.context}),this._lfoA=new om({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new nq({maxDelay:1,context:this.context}),this._lfoB=new om({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new pk({context:this.context}),this._crossFadeLFO=new om({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new nq({delayTime:a.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,mK(this,"delayTime"),this._pitch=a.pitch,this._windowSize=a.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);let b=this.now();this._lfoA.start(b),this._lfoB.start(b),this._crossFadeLFO.start(b),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(pD.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(a){this._pitch=a;let b=0;a<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,b=mY(a-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,b=mY(a)-1),this._frequency.value=b*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(a){this._windowSize=this.toSeconds(a),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class pP extends pz{constructor(){super(mt(pP.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";let a=mt(pP.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new om({context:this.context,frequency:a.frequency,min:0,max:1}),this._lfoR=new om({context:this.context,frequency:a.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(a.baseFrequency),this._octaves=a.octaves,this.Q=new nk({context:this.context,value:a.Q,units:"positive"}),this._filtersL=this._makeFilters(a.stages,this._lfoL),this._filtersR=this._makeFilters(a.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=a.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=a.baseFrequency,this.octaves=a.octaves,this._lfoL.start(),this._lfoR.start(),mK(this,["frequency","Q"])}static getDefaults(){return Object.assign(pz.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(a,b){let c=[];for(let d=0;d<a;d++){let e=this.context.createBiquadFilter();e.type="allpass",this.Q.connect(e.Q),b.connect(e.frequency),c.push(e)}return c}get octaves(){return this._octaves}set octaves(a){this._octaves=a;let b=this._baseFrequency*Math.pow(2,a);this._lfoL.max=b,this._lfoR.max=b}get baseFrequency(){return this._baseFrequency}set baseFrequency(a){this._baseFrequency=this.toFrequency(a),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(a=>a.disconnect()),this._filtersR.forEach(a=>a.disconnect()),this.frequency.dispose(),this}}class pQ extends pl{constructor(){super(mt(pQ.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();let a=mt(pQ.getDefaults(),arguments,["decay"]);this._decay=a.decay,this._preDelay=a.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(pl.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(a){l4(a=this.toSeconds(a),.001),this._decay=a,this.generate()}get preDelay(){return this._preDelay}set preDelay(a){l4(a=this.toSeconds(a),0),this._preDelay=a,this.generate()}generate(){return mo(this,void 0,void 0,function*(){let a=this.ready,b=new mO(2,this._decay+this._preDelay,this.context.sampleRate),c=new nH({context:b}),d=new nH({context:b}),e=new py({context:b});c.connect(e,0,0),d.connect(e,0,1);let f=new nh({context:b}).toDestination();e.connect(f),c.start(0),d.start(0),f.gain.setValueAtTime(0,0),f.gain.setValueAtTime(1,this._preDelay),f.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);let g=b.render();return this.ready=g.then(mM),yield a,this._convolver.buffer=(yield g).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class pR extends nd{constructor(){super(mt(pR.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new px({channels:2,context:this.context}),this._midAdd=new oj({context:this.context}),this.mid=new ob({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new ov({context:this.context}),this.side=new ob({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class pS extends nd{constructor(){super(mt(pS.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new nh({context:this.context}),this.side=new nh({context:this.context}),this._left=new oj({context:this.context}),this._leftMult=new ob({context:this.context,value:Math.SQRT1_2}),this._right=new ov({context:this.context}),this._rightMult=new ob({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new py({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class pT extends pl{constructor(a){super(a),this.name="MidSideEffect",this._midSideMerge=new pS({context:this.context}),this._midSideSplit=new pR({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...a){this._midSend.chain(...a,this._midReturn)}connectEffectSide(...a){this._sideSend.chain(...a,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class pU extends pT{constructor(){super(mt(pU.getDefaults(),arguments,["width"])),this.name="StereoWidener";let a=mt(pU.getDefaults(),arguments,["width"]);this.width=new nk({context:this.context,value:a.width,units:"normalRange"}),mK(this,["width"]),this._twoTimesWidthMid=new ob({context:this.context,value:2}),this._twoTimesWidthSide=new ob({context:this.context,value:2}),this._midMult=new ob({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new ov({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),nf(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new ob({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(pT.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class pV extends pz{constructor(){super(mt(pV.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";let a=mt(pV.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new om({context:this.context,type:a.type,min:1,max:0}),this._lfoR=new om({context:this.context,type:a.type,min:1,max:0}),this._amplitudeL=new nh({context:this.context}),this._amplitudeR=new nh({context:this.context}),this.frequency=new nk({context:this.context,value:a.frequency,units:"frequency"}),this.depth=new nk({context:this.context,value:a.depth,units:"normalRange"}),mK(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=a.spread}static getDefaults(){return Object.assign(pz.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(a){return this._lfoL.start(a),this._lfoR.start(a),this}stop(a){return this._lfoL.stop(a),this._lfoR.stop(a),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(a){this._lfoL.type=a,this._lfoR.type=a}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(a){this._lfoL.phase=90-a/2,this._lfoR.phase=a/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class pW extends pl{constructor(){super(mt(pW.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";let a=mt(pW.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new nq({context:this.context,delayTime:0,maxDelay:a.maxDelay}),this._lfo=new om({context:this.context,type:a.type,min:0,max:a.maxDelay,frequency:a.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=a.depth,mK(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(pl.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(a){this._lfo.type=a}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class pX extends nd{constructor(){super(mt(pX.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];let a=mt(pX.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new nh({context:this.context}),this._split=new px({context:this.context,channels:a.channels}),this.input.connect(this._split),l4(a.channels,1);for(let b=0;b<a.channels;b++)this._analysers[b]=this.context.createAnalyser(),this._split.connect(this._analysers[b],b,0);this.size=a.size,this.type=a.type}static getDefaults(){return Object.assign(nd.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return(this._analysers.forEach((a,b)=>{let c=this._buffers[b];"fft"===this._type?a.getFloatFrequencyData(c):"waveform"===this._type&&a.getFloatTimeDomainData(c)}),1===this.channels)?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(a){this._analysers.forEach((b,c)=>{b.fftSize=2*a,this._buffers[c]=new Float32Array(a)})}get channels(){return this._analysers.length}get type(){return this._type}set type(a){l3("waveform"===a||"fft"===a,`Analyser: invalid type: ${a}`),this._type=a}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(a){this._analysers.forEach(b=>b.smoothingTimeConstant=a)}dispose(){return super.dispose(),this._analysers.forEach(a=>a.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class pY extends nd{constructor(){super(mt(pY.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new pX({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class pZ extends pY{constructor(){super(mt(pZ.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;let a=mt(pZ.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new pX({context:this.context,size:256,type:"waveform",channels:a.channels}),this.smoothing=a.smoothing,this.normalRange=a.normalRange}static getDefaults(){return Object.assign(pY.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return l9("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){let a=this._analyser.getValue(),b=1===this.channels?[a]:a,c=b.map(a=>{let b=a.reduce((a,b)=>a+b*b,0),c=Math.sqrt(b/a.length);return this._rms=Math.max(c,this._rms*this.smoothing),this.normalRange?this._rms:mX(this._rms)});return 1===this.channels?c[0]:c}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class p$ extends pY{constructor(){super(mt(p$.getDefaults(),arguments,["size"])),this.name="FFT";let a=mt(p$.getDefaults(),arguments,["size"]);this.normalRange=a.normalRange,this._analyser.type="fft",this.size=a.size}static getDefaults(){return Object.assign(nd.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){let a=this._analyser.getValue();return a.map(a=>this.normalRange?mW(a):a)}get size(){return this._analyser.size}set size(a){this._analyser.size=a}get smoothing(){return this._analyser.smoothing}set smoothing(a){this._analyser.smoothing=a}getFrequencyOfIndex(a){return l3(0<=a&&a<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),a*this.context.sampleRate/(2*this.size)}}class p_ extends pY{constructor(){super(mt(p_.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){let a=this._analyser.getValue();return a[0]}}class p0 extends pY{constructor(){super(mt(p0.getDefaults(),arguments,["size"])),this.name="Waveform";let a=mt(p0.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=a.size}static getDefaults(){return Object.assign(pY.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(a){this._analyser.size=a}}class p1 extends nd{constructor(){super(mt(p1.getDefaults(),arguments,["solo"])),this.name="Solo";let a=mt(p1.getDefaults(),arguments,["solo"]);this.input=this.output=new nh({context:this.context}),p1._allSolos.has(this.context)||p1._allSolos.set(this.context,new Set),p1._allSolos.get(this.context).add(this),this.solo=a.solo}static getDefaults(){return Object.assign(nd.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(a){a?this._addSolo():this._removeSolo(),p1._allSolos.get(this.context).forEach(a=>a._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){p1._soloed.has(this.context)||p1._soloed.set(this.context,new Set),p1._soloed.get(this.context).add(this)}_removeSolo(){p1._soloed.has(this.context)&&p1._soloed.get(this.context).delete(this)}_isSoloed(){return p1._soloed.has(this.context)&&p1._soloed.get(this.context).has(this)}_noSolos(){return!p1._soloed.has(this.context)||p1._soloed.has(this.context)&&0===p1._soloed.get(this.context).size}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),p1._allSolos.get(this.context).delete(this),this._removeSolo(),this}}p1._allSolos=new Map,p1._soloed=new Map;class p2 extends nd{constructor(){super(mt(p2.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";let a=mt(p2.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new po({context:this.context,pan:a.pan,channelCount:a.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new nA({context:this.context,volume:a.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=a.mute,mK(this,["pan","volume"])}static getDefaults(){return Object.assign(nd.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(a){this._volume.mute=a}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class p3 extends nd{constructor(){super(mt(p3.getDefaults(),arguments,["volume","pan"])),this.name="Channel";let a=mt(p3.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new p1({solo:a.solo,context:this.context}),this._panVol=this.output=new p2({context:this.context,pan:a.pan,volume:a.volume,mute:a.mute,channelCount:a.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),mK(this,["pan","volume"])}static getDefaults(){return Object.assign(nd.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(a){this._solo.solo=a}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(a){this._panVol.mute=a}_getBus(a){return p3.buses.has(a)||p3.buses.set(a,new nh({context:this.context})),p3.buses.get(a)}send(a,b=0){let c=this._getBus(a),d=new nh({context:this.context,units:"decibels",gain:b});return this.connect(d),d.connect(c),d}receive(a){let b=this._getBus(a);return b.connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}p3.buses=new Map;class p4 extends nd{constructor(){super(mt(p4.getDefaults(),arguments)),this.name="Mono",this.input=new nh({context:this.context}),this._merge=this.output=new py({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class p5 extends nd{constructor(){super(mt(p5.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new nh({context:this.context}),this.output=void 0,this.low=new oK({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new oK({context:this.context,frequency:0,type:"highpass"}),this.mid=new oK({context:this.context,frequency:0,type:"lowpass"}),this.high=new oK({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];let a=mt(p5.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new nk({context:this.context,units:"frequency",value:a.lowFrequency}),this.highFrequency=new nk({context:this.context,units:"frequency",value:a.highFrequency}),this.Q=new nk({context:this.context,units:"positive",value:a.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),mK(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(nd.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),mL(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class p6 extends nd{constructor(){super(...arguments),this.name="Listener",this.positionX=new nc({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new nc({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new nc({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new nc({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new nc({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new nc({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new nc({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new nc({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new nc({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(nd.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}mE(a=>{a.listener=new p6({context:a})}),mG(a=>{a.listener.dispose()});class p7 extends nd{constructor(){super(mt(p7.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";let a=mt(p7.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=a.panningModel,this.maxDistance=a.maxDistance,this.distanceModel=a.distanceModel,this.coneOuterGain=a.coneOuterGain,this.coneOuterAngle=a.coneOuterAngle,this.coneInnerAngle=a.coneInnerAngle,this.refDistance=a.refDistance,this.rolloffFactor=a.rolloffFactor,this.positionX=new nc({context:this.context,param:this._panner.positionX,value:a.positionX}),this.positionY=new nc({context:this.context,param:this._panner.positionY,value:a.positionY}),this.positionZ=new nc({context:this.context,param:this._panner.positionZ,value:a.positionZ}),this.orientationX=new nc({context:this.context,param:this._panner.orientationX,value:a.orientationX}),this.orientationY=new nc({context:this.context,param:this._panner.orientationY,value:a.orientationY}),this.orientationZ=new nc({context:this.context,param:this._panner.orientationZ,value:a.orientationZ})}static getDefaults(){return Object.assign(nd.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(a,b,c){return this.positionX.value=a,this.positionY.value=b,this.positionZ.value=c,this}setOrientation(a,b,c){return this.orientationX.value=a,this.orientationY.value=b,this.orientationZ.value=c,this}get panningModel(){return this._panner.panningModel}set panningModel(a){this._panner.panningModel=a}get refDistance(){return this._panner.refDistance}set refDistance(a){this._panner.refDistance=a}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(a){this._panner.rolloffFactor=a}get distanceModel(){return this._panner.distanceModel}set distanceModel(a){this._panner.distanceModel=a}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(a){this._panner.coneInnerAngle=a}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(a){this._panner.coneOuterAngle=a}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(a){this._panner.coneOuterGain=a}get maxDistance(){return this._panner.maxDistance}set maxDistance(a){this._panner.maxDistance=a}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class p8 extends nd{constructor(){super(mt(p8.getDefaults(),arguments)),this.name="Recorder";let a=mt(p8.getDefaults(),arguments);this.input=new nh({context:this.context}),l3(p8.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:a.mimeType})}static getDefaults(){return nd.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==mj&&Reflect.has(mj,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return mo(this,void 0,void 0,function*(){l3("started"!==this.state,"Recorder is already started");let a=new Promise(a=>{let b=()=>{this._recorder.removeEventListener("start",b,!1),a()};this._recorder.addEventListener("start",b,!1)});return this._recorder.start(),yield a})}stop(){return mo(this,void 0,void 0,function*(){l3("stopped"!==this.state,"Recorder is not started");let a=new Promise(a=>{let b=c=>{this._recorder.removeEventListener("dataavailable",b,!1),a(c.data)};this._recorder.addEventListener("dataavailable",b,!1)});return this._recorder.stop(),yield a})}pause(){return l3("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class p9 extends nd{constructor(){super(mt(p9.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;let a=mt(p9.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new nc({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:a.threshold}),this.attack=new nc({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:a.attack}),this.release=new nc({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:a.release}),this.knee=new nc({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:a.knee}),this.ratio=new nc({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:a.ratio}),mK(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(nd.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class qa extends nd{constructor(){super(Object.assign(mt(qa.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";let a=mt(qa.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new pq({context:this.context,smoothing:a.smoothing}),this._gt=new ox({context:this.context,value:mW(a.threshold)}),this.input=new nh({context:this.context}),this._gate=this.output=new nh({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(nd.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return mX(this._gt.value)}set threshold(a){this._gt.value=mW(a)}get smoothing(){return this._follower.smoothing}set smoothing(a){this._follower.smoothing=a}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class qb extends nd{constructor(){super(Object.assign(mt(qb.getDefaults(),arguments,["threshold"]))),this.name="Limiter";let a=mt(qb.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new p9({context:this.context,ratio:20,attack:.003,release:.01,threshold:a.threshold}),this.threshold=this._compressor.threshold,mK(this,"threshold")}static getDefaults(){return Object.assign(nd.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class qc extends nd{constructor(){super(Object.assign(mt(qc.getDefaults(),arguments))),this.name="MidSideCompressor";let a=mt(qc.getDefaults(),arguments);this._midSideSplit=this.input=new pR({context:this.context}),this._midSideMerge=this.output=new pS({context:this.context}),this.mid=new p9(Object.assign(a.mid,{context:this.context})),this.side=new p9(Object.assign(a.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),mK(this,["mid","side"])}static getDefaults(){return Object.assign(nd.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class qd extends nd{constructor(){super(Object.assign(mt(qd.getDefaults(),arguments))),this.name="MultibandCompressor";let a=mt(qd.getDefaults(),arguments);this._splitter=this.input=new p5({context:this.context,lowFrequency:a.lowFrequency,highFrequency:a.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new nh({context:this.context}),this.low=new p9(Object.assign(a.low,{context:this.context})),this.mid=new p9(Object.assign(a.mid,{context:this.context})),this.high=new p9(Object.assign(a.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),mK(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(nd.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class qe extends nd{constructor(){super(mt(qe.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new nh({context:this.context}),this._internalChannels=[];let a=mt(qe.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new p5({context:this.context,highFrequency:a.highFrequency,lowFrequency:a.lowFrequency}),this._lowGain=new nh({context:this.context,gain:a.low,units:"decibels"}),this._midGain=new nh({context:this.context,gain:a.mid,units:"decibels"}),this._highGain=new nh({context:this.context,gain:a.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),mK(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(nd.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),mL(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class qf extends nd{constructor(){super(mt(qf.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();let a=mt(qf.getDefaults(),arguments,["url","onload"]);this._buffer=new mN(a.url,b=>{this.buffer=b,a.onload()}),this.input=new nh({context:this.context}),this.output=new nh({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=a.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(nd.getDefaults(),{normalize:!0,onload:mM})}load(a){return mo(this,void 0,void 0,function*(){this.buffer=yield this._buffer.load(a)})}get buffer(){return this._buffer.length?this._buffer:null}set buffer(a){a&&this._buffer.set(a),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));let b=this._buffer.get();this._convolver.buffer=b||null}get normalize(){return this._convolver.normalize}set normalize(a){this._convolver.normalize=a}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function qg(){return mR().now()}function qh(){return mR().immediate()}let qi=mR().transport;function qj(){return mR().transport}let qk=mR().destination,ql=mR().destination;function qm(){return mR().destination}let qn=mR().listener;function qo(){return mR().listener}let qp=mR().draw;function qq(){return mR().draw}let qr=mR();function qs(){return mN.loaded()}let qt=mN,qu=ns,qv=nG},3897:function(a){a.exports=function(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d},a.exports.__esModule=!0,a.exports.default=a.exports},5372:function(a){a.exports=function(a){if(Array.isArray(a))return a},a.exports.__esModule=!0,a.exports.default=a.exports},6690:function(a){a.exports=function(a,b){if(!(a instanceof b))throw TypeError("Cannot call a class as a function")},a.exports.__esModule=!0,a.exports.default=a.exports},9728:function(a){function b(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}a.exports=function(a,c,d){return c&&b(a.prototype,c),d&&b(a,d),Object.defineProperty(a,"prototype",{writable:!1}),a},a.exports.__esModule=!0,a.exports.default=a.exports},8872:function(a){a.exports=function(a,b){var c,d,e=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=e){var f=[],g=!0,h=!1;try{for(e=e.call(a);!(g=(c=e.next()).done)&&(f.push(c.value),!b||f.length!==b);g=!0);}catch(i){h=!0,d=i}finally{try{g||null==e.return||e.return()}finally{if(h)throw d}}return f}},a.exports.__esModule=!0,a.exports.default=a.exports},2218:function(a){a.exports=function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},a.exports.__esModule=!0,a.exports.default=a.exports},7424:function(a,b,c){var d=c(5372),e=c(8872),f=c(6116),g=c(2218);a.exports=function(a,b){return d(a)||e(a,b)||f(a,b)||g()},a.exports.__esModule=!0,a.exports.default=a.exports},6116:function(a,b,c){var d=c(3897);a.exports=function(a,b){if(a){if("string"==typeof a)return d(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(a);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return d(a,b)}},a.exports.__esModule=!0,a.exports.default=a.exports}}])