(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return c(3949)}])},3949:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return a9}});var d,e,f,g,h,i,j,k,l,m=c(5893),n=c(9008),o=c.n(n),p=c(7294),q=c(828),r=p.createContext(null),s=function(a){var b=a.fallback,d=a.children,e=(0,q.Z)(p.useState(null),2),f=e[0],g=e[1];return p.useEffect(function(){c.e(878).then(c.bind(c,4878)).then(function(a){return g(a)})},[]),(0,m.jsx)(r.Provider,{value:f,children:b&&!f?b:d})},t=c(6042),u=c(9396),v=Object.freeze({memory:{insert:{duration:8,mode:"note"},highlightedIndex:null,selectedIndex:null,layouts:[]},saved:{sheet:{type:"unset",layout:null,key:"C",metre:"4/4",title:""}}}),w=function(a){return Object.freeze({memory:{insert:{setDuration:function(b){return a.setMemory(function(a){return(0,u.Z)((0,t.Z)({},a),{insert:(0,u.Z)((0,t.Z)({},a.insert),{duration:b})})})},setMode:function(b){return a.setMemory(function(a){return(0,u.Z)((0,t.Z)({},a),{insert:(0,u.Z)((0,t.Z)({},a.insert),{mode:b})})})}},setHighlighted:function(b){return a.setMemory(function(a){return(0,u.Z)((0,t.Z)({},a),{highlightedIndex:b})})},setSelected:function(b){return a.setMemory(function(a){return(0,u.Z)((0,t.Z)({},a),{selectedIndex:b})})},setLayouts:function(b){return a.setMemory(function(a){return(0,u.Z)((0,t.Z)({},a),{layouts:b})})}},saved:{setSheet:function(b){return a.setSaved(function(a){return(0,u.Z)((0,t.Z)({},a),{sheet:b})})},modifySheet:function(b){return a.setSaved(function(a){return(0,u.Z)((0,t.Z)({},a),{sheet:b(a.sheet)})})}}})},x=(0,p.createContext)({data:v,fn:w({setMemory:function(a){return a},setSaved:function(a){return a}})}),y=function(a){var b=(0,p.useState)(v.memory),c=b[0],d=b[1],e=(0,p.useState)(v.saved),f=e[0],g=e[1],h=w({setMemory:d,setSaved:g});return(0,m.jsx)(x.Provider,{value:{data:{memory:c,saved:f},fn:h},children:a.children})},z=c(9626),A=c.n(z),B=function(a){var b=(0,p.useContext)(x),c=(0,p.useState)(0),d=c[0],e=c[1],f=function(a){return b.fn.saved.modifySheet(function(a){return(0,u.Z)((0,t.Z)({},a),{key:b.data.memory.layouts[d].key,type:b.data.memory.layouts[d].type,layout:b.data.memory.layouts[d].label,chords:[]})})};return(0,m.jsxs)("div",{className:A().layoutChooser,children:[(0,m.jsx)("h1",{children:"Choose a layout"}),(0,m.jsx)("select",{className:A().layouts,onChange:function(a){return e(Number(a.target.value))},children:b.data.memory.layouts.map(function(a,b){return(0,m.jsx)("option",{value:b,defaultChecked:0==b,children:a.label},b)})}),(0,m.jsx)("button",{onClick:f,children:"Next"})]})},C=c(4273),D=c.n(C),E=function(a){var b=(0,p.useContext)(x);return(0,m.jsxs)("div",{className:D().chordSwitcher,children:[(0,m.jsx)("button",{className:D().note+("note"==b.data.memory.insert.mode?" "+D().active:""),onClick:function(a){return b.fn.memory.insert.setMode("note")},children:"+"}),(0,m.jsx)("button",{className:D().chord+("chord"==b.data.memory.insert.mode?" "+D().active:""),onClick:function(a){return b.fn.memory.insert.setMode("chord")},children:"\uD834\uDD5F+"})]})},F=c(7568),G=c(4051),H=c.n(G),I=c(5675),J=c.n(I),K=c(3845),L=c.n(K),M=function(a){return(0,m.jsx)("button",{className:L().iconButton,onClick:a.onClick,children:(0,m.jsx)(J(),{src:a.icon,layout:"fill"})})};function N(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:void 0;(0,p.useEffect)(function(){if(a)return a.addEventListener(b,c),function(){return a.removeEventListener(b,c)}},d)}var O,P,Q,R,S,T=function(a){var b,c=a.editorRef,d=(0,p.useState)(!1),e=d[0],f=d[1];N(c.current,"onfullscreenchange",function(a){return c&&f(!!document.fullscreenElement)},[c]);var g=(b=(0,F.Z)(H().mark(function a(){var b;return H().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(e&&document.fullscreenElement)){a.next=6;break}return a.next=3,document.exitFullscreen();case 3:f(!1),a.next=10;break;case 6:return a.next=9,null===(b=c.current)|| void 0===b?void 0:b.requestFullscreen({navigationUI:"auto"});case 9:f(!0);case 10:case"end":return a.stop()}},a)})),function(){return b.apply(this,arguments)});return(0,m.jsx)(M,{icon:"./img/fullscreen.svg",onClick:g})},U=c(9815),V=c(4924),W=Object.freeze((d={},(0,V.Z)(d,0,{in:"",out:""}),(0,V.Z)(d,1,{in:"↙",out:"↖"}),(0,V.Z)(d,2,{in:"⤦",out:"⤣"}),(0,V.Z)(d,3,{in:"⇙",out:"⇖"}),d)),X=Object.freeze((e={},(0,V.Z)(e,1,{in:"①",out:"1"}),(0,V.Z)(e,2,{in:"②",out:"2"}),(0,V.Z)(e,3,{in:"③",out:"3"}),(0,V.Z)(e,4,{in:"④",out:"4"}),(0,V.Z)(e,5,{in:"⑤",out:"5"}),(0,V.Z)(e,6,{in:"⑥",out:"6"}),(0,V.Z)(e,7,{in:"⑦",out:"7"}),(0,V.Z)(e,8,{in:"⑧",out:"8"}),(0,V.Z)(e,9,{in:"⑨",out:"9"}),(0,V.Z)(e,10,{in:"⑩",out:"10"}),e)),Y=function(a,b){var c;return b&&"".concat(null!==(f=null===(c=W[b])|| void 0===c?void 0:c[a])&& void 0!==f?f:"")||""},Z=function(a,b){var c;return null!==(h=b&&"".concat(null!==(g=null===(c=W[b])|| void 0===c?void 0:c[a])&& void 0!==g?g:"","\xa0").concat(b))&& void 0!==h?h:""},$=function(a,b){var c;return null!==(i=null===(c=X[b])|| void 0===c?void 0:c[a])&& void 0!==i?i:"".concat(b)},_=Object.freeze((j={},(0,V.Z)(j,0,["C"]),(0,V.Z)(j,.5,["^C","_D"]),(0,V.Z)(j,1,["D"]),(0,V.Z)(j,1.5,["^D","_E"]),(0,V.Z)(j,2,["E"]),(0,V.Z)(j,2.5,["^E","_F"]),(0,V.Z)(j,3,["F"]),(0,V.Z)(j,3.5,["^F","_G"]),(0,V.Z)(j,4,["G"]),(0,V.Z)(j,4.5,["^G","_A"]),(0,V.Z)(j,5,["A"]),(0,V.Z)(j,5.5,["^A","_B"]),(0,V.Z)(j,6,["B"]),(0,V.Z)(j,6.5,["^B","_C"]),j)),aa=Object.freeze((k={},(0,V.Z)(k,0,"C"),(0,V.Z)(k,.5,"Db"),(0,V.Z)(k,1,"D"),(0,V.Z)(k,1.5,"Eb"),(0,V.Z)(k,2,"E"),(0,V.Z)(k,2.5,"Fb"),(0,V.Z)(k,3,"F"),(0,V.Z)(k,3.5,"Gb"),(0,V.Z)(k,4,"G"),(0,V.Z)(k,4.5,"Ab"),(0,V.Z)(k,5,"A"),(0,V.Z)(k,5.5,"Bb"),(0,V.Z)(k,6,"B"),(0,V.Z)(k,6.5,"Cb"),k)),ab=Object.freeze("⁰\xb9\xb2\xb3⁴⁵⁶⁷⁸⁹"),ac=function(a,b){return a.split("").filter(function(a){return a==b}).length},ad=function(a){return(a.match(/[=_]?[cdefgab][,']*/g)?1:0)+ac(a,"'")-ac(a,",")},ae=function(a){var b=ad(a),c=a.toUpperCase().match(/[\^_]?[CDEFGAB]/);if(!c)return -1;var d=Number(Object.entries(_).find(function(a){return a[1].includes(c[0])})[0]);return(b+4)*7+d},af=function(a){var b,c=!!a.match(/_[cdefgab].*/i),d=!!a.match(/\^[cdefgab].*/i),e=ad(a),f=a.match(/[\^_]?([cdefgab]).*/i);return f&&f[1]?f[1].toUpperCase()+(c?"♭":"")+(d?"♯":"")+(b="".concat(e+4),"".concat(b).split("").map(function(a){return null!==(l=ab[Number(a)])&& void 0!==l?l:a}).join("")):a},ag=function(a){var b=ad(a),c=a.toUpperCase().match(/[\^_]?[CDEFGAB]/);if(!c)return"";var d=Number(Object.entries(_).find(function(a){return a[1].includes(c[0])})[0]);return"".concat(aa[d]).concat(b+4)},ah=function(a){var b=Number(a);return Number.isInteger(64/b)?"".concat(64/b,"n"):"".concat(64/Math.floor(2*b/3),"n.")},ai=(O=function(a,b,c){var d=a.chords.slice(0,(null!=c?c:a.chords.length)+1),e=a.chords.slice((null!=c?c:a.chords.length)+1);return(0,u.Z)((0,t.Z)({},a),{chords:(0,U.Z)(d).concat((0,U.Z)(b),(0,U.Z)(e))})},P=function(a,b,c,d){return O(a,[{type:"chord",notes:b,duration:c}],d)},Q=function(a,b,c){return O(a,[{type:"silence",duration:b}],c)},R=function(a,b){return O(a,[{type:"bar"}],b)},S=function(a,b,c,d){var e=a.chords[null!=d?d:a.chords.length-1],f=a.chords.slice(0,(null!=d?d:a.chords.length)-1),g=a.chords.slice(d?d+1:a.chords.length);return(null==e?void 0:e.type)=="chord"?(0,u.Z)((0,t.Z)({},a),{chords:(0,U.Z)(f).concat([{type:"chord",notes:(0,U.Z)(e.notes).concat((0,U.Z)(b)),duration:e.duration}],(0,U.Z)(g))}):P(a,b,c,d)},Object.freeze({toABC:function(a,b){var c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:[],d=(function(a,b){for(var c=[],d=0;d<a.length;d+=b)c.push(a.slice(d,Math.min(d+b,a.length)));return c})(a.chords,b).map(function(a,d){var e=a.map(function(a){switch(a.type){case"bar":return"|";case"silence":return"z"+a.duration;case"chord":return"["+a.notes.map(function(a){return a.note}).join("")+"]"+a.duration}}),f=!0,g=!1,h=void 0;try{for(var i,j=c[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value;Math.floor(k/b)==d&&(e[k%b]="!mark!"+e[k%b])}}catch(l){g=!0,h=l}finally{try{f||null==j.return||j.return()}finally{if(g)throw h}}var m=a.map(function(a){switch(a.type){case"bar":return"|";case"silence":return"";case"chord":return(0,U.Z)(a.notes).sort(function(a,b){return ae(a.note)-ae(b.note)}).map(function(a){return Y(a.dir,a.bend)+$(a.dir,a.position)}).join("")}});return e.join(" ")+"\nw: "+m.join(" ")}).join("\n");return["X:1","T:".concat(a.title),"M:".concat(a.metre),"L:1/64","K:".concat(a.key),d].join("\n")},addNote:P,addSilence:Q,addBar:R,extendChord:S})),aj=c(1104),ak=c.n(aj),al=function(a){var b=(0,p.useContext)(x),c=function(c){if("diatonic"==b.data.saved.sheet.type){var d,e=null!==(d=b.data.memory.selectedIndex)&& void 0!==d?d:b.data.saved.sheet.chords.length-1;b.fn.saved.modifySheet(function(a){return"diatonic"==a.type?(0,u.Z)((0,t.Z)({},a),{chords:(0,U.Z)(a.chords.slice(0,e)).concat((0,U.Z)(a.chords.slice(e+1)))}):a}),a.onRemove&&a.onRemove()}},d=function(c){"diatonic"==b.data.saved.sheet.type&&(b.fn.saved.modifySheet(function(a){return"diatonic"==a.type?ai.addSilence(a,b.data.memory.insert.duration,b.data.memory.selectedIndex):a}),a.onAdd&&a.onAdd("silence"))},e=function(c){"diatonic"==b.data.saved.sheet.type&&(b.fn.saved.modifySheet(function(a){return"diatonic"==a.type?ai.addBar(a,b.data.memory.selectedIndex):a}),a.onAdd&&a.onAdd("bar"))};return(0,m.jsxs)("div",{className:ak().musicalElements,children:[(0,m.jsx)("button",{onClick:c,children:"⇤"}),(0,m.jsx)("button",{onClick:d,children:"\uD834\uDD3D"}),(0,m.jsx)("button",{onClick:e,children:"|"})]})},am=function(a,b){var c,d,e=function(c){if(b.chordCallback&&h.push(a.getContext().setTimeout(function(){return b.chordCallback(c,b.chords[c],b.durations[c])},g)),!b.durations[c])return"continue";var d=ah(b.durations[c]);if(!b.chords[c].includes("z")){var e=b.chords[c].map(function(a){return ag(a)}).filter(function(a){return!!a});f.triggerAttackRelease(e,Array(e.length).fill(d),g)}g+=a.Time(d).toSeconds()},f=new a.PolySynth().toDestination();f.sync();for(var g=0,h=[],i=0;i<b.chords.length;++i)e(i);g+=null!==(c=b.timeMargin)&& void 0!==c?c:1;var j=null;return{promise:new Promise(function(b,c){j=b,d=a.getContext().setTimeout(function(){f.disconnect(),f.dispose(),a.Transport.cancel(),a.Transport.stop(),console.log("disposed"),j(!0)},g),a.Transport.start()}),stop:function(){d&&a.getContext().clearTimeout(d);var b=!0,c=!1,e=void 0;try{for(var g,i=h[Symbol.iterator]();!(b=(g=i.next()).done);b=!0){var k=g.value;a.getContext().clearTimeout(k)}}catch(l){c=!0,e=l}finally{try{b||null==i.return||i.return()}finally{if(c)throw e}}f.disconnect(),f.dispose(),a.Transport.cancel(),a.Transport.stop(),j(!1)}}},an=c(9045),ao=c.n(an),ap=Object.freeze({promise:null,stop:function(){}}),aq=function(a){var b=(0,p.useContext)(x),c=(0,p.useContext)(r),d=(0,p.useState)(ap),e=d[0],f=d[1],g=(0,p.useState)(!1),h=g[0],i=g[1],j=function(){if("diatonic"==b.data.saved.sheet.type&&!h){i(!0);var a,d=am(c,{chords:b.data.saved.sheet.chords.map(function(a){switch(a.type){case"bar":return[];case"silence":return["z"];case"chord":return a.notes.map(function(a){return a.note})}}),durations:b.data.saved.sheet.chords.map(function(a){return"bar"==a.type?"":a.duration}),chordCallback:function(a){return b.fn.memory.setHighlighted(a)}});null===(a=d.promise)|| void 0===a||a.then(function(a){i(!1),b.fn.memory.setHighlighted(null)}),f(d)}};return(0,m.jsxs)("div",{className:ao().musicControl+(h?" "+ao().playing:""),children:[(0,m.jsx)("button",{className:ao().play,onClick:function(a){c&&(i(!0),j())}}),(0,m.jsx)("button",{className:ao().stop,onClick:function(a){c&&(i(!1),e.stop())}})]})},ar=c(8461),as=c.n(ar),at=Object.freeze([1,2,4,8,16,32,64]),au=function(a){var b=null,c=!1;if(at.includes(a.duration))b=a.duration;else{var d=3*a.duration/2;at.includes(d)&&(b=d,c=!0)}return(0,m.jsx)("span",{className:as().noteComponent,children:b?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{className:as().note,children:(0,m.jsx)(J(),{src:"./img/".concat(b,"n.svg"),layout:"fill"})}),c&&(0,m.jsx)("span",{className:as().dot})]}):(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("span",{className:as().notePlaceholder,children:a.duration})})})},av=c(1714),aw=c.n(av),ax=Object.freeze([{symbol:"\uD834\uDD63",value:1,display:"1/64"},{symbol:"\uD834\uDD62",value:2,display:"1/32"},{symbol:"\uD834\uDD61",value:4,display:"1/16"},{symbol:"\uD834\uDD60",value:8,display:"1/8",default:!0},{symbol:"\uD834\uDD5F",value:16,display:"1/4"},{symbol:"\uD834\uDD5F.",value:24,display:"3/8"},{symbol:"\uD834\uDD5E",value:32,display:"1/2"},{symbol:"\uD834\uDD5E.",value:48,display:"3/4"},{symbol:"\uD834\uDD5D",value:64,display:"1/1"},{symbol:"\uD834\uDD5D.",value:96,display:"3/2"},]),ay=function(a){var b,c=(0,p.useContext)(x),d=function(a){return c.fn.memory.insert.setDuration(Number(a.target.value))};return(0,m.jsxs)("label",{className:aw().notelengths,children:[(0,m.jsx)("input",{type:"checkbox"}),(0,m.jsxs)("span",{className:aw().togglePanel,children:[(0,m.jsx)("span",{className:aw().icon,children:(0,m.jsx)(au,{duration:8})}),(0,m.jsx)("span",{className:aw().toggle}),(0,m.jsx)("div",{className:aw().list,onChange:d,children:ax.map(function(a,c){return(0,m.jsxs)("label",{children:[(0,m.jsx)("input",{type:"radio",name:"notelength",value:"".concat(a.value),defaultChecked:null!==(b=a.default)&& void 0!==b&&b}),(0,m.jsx)("div",{children:(0,m.jsx)(au,{duration:64/a.value})})]},c)})})]})]})},az=c(9914),aA=function(a){var b=(0,p.useRef)(null),c=(0,p.useState)(null),d=(c[0],c[1]);return(0,p.useEffect)(function(){if(b.current){var c;d((0,az.renderAbc)(b.current,a.abc,null!==(c=a.options)&& void 0!==c?c:{}))}return function(){}},[b,a.abc,a.options]),(0,m.jsx)("div",{ref:b})},aB=c(9631),aC=c.n(aB),aD=function(a){var b=(0,p.useContext)(x),c=(0,p.useState)(0),d=c[0],e=c[1],f=(0,p.useRef)(null);N(window,"resize",function(a){return f&&e(f.current.getBoundingClientRect().width)},[f]);var g="diatonic"==b.data.saved.sheet.type?ai.toABC(b.data.saved.sheet,8,[b.data.memory.highlightedIndex,b.data.memory.selectedIndex].filter(function(a){return!!a})):"";return(0,m.jsx)("div",{className:aC().sheetWrapper,ref:f,children:(0,m.jsx)(aA,{abc:g,options:{initialClef:!0,staffwidth:d,wrap:{minSpacing:1.5,maxSpacing:2,preferredMeasuresPerLine:4},clickListener:function(a,c,d,e,f,g){if("diatonic"==b.data.saved.sheet.type){var h,i,j=null===(h=b.data.saved.sheet.chords.map(function(a,b){return{v:a,i:b}}).filter(function(a){return["chord","silence"].includes(a.v.type)}))|| void 0===h?void 0:null===(i=h[f.index])|| void 0===i?void 0:i.i;b.fn.memory.setSelected(j)}},selectTypes:["note"]}})})},aE=c(8170),aF=c.n(aE),aG=function(a){var b,c,d=null!==(b=a.data.find(function(a){return"out"==a.dir&&!a.bend}))&& void 0!==b?b:{dir:"out",note:"C"},e=null!==(c=a.data.find(function(a){return"in"==a.dir&&!a.bend}))&& void 0!==c?c:{dir:"in",note:"C"},f=a.data.filter(function(a){return"out"==a.dir}).map(function(a){return(0,u.Z)((0,t.Z)({},a),{bend:a.bend||0})}).sort(function(a,b){return b.bend-a.bend}),g=a.data.filter(function(a){return"in"==a.dir}).map(function(a){return(0,u.Z)((0,t.Z)({},a),{bend:a.bend||0})}).sort(function(a,b){return a.bend-b.bend}),h=f.length>1,i=g.length>1;return(0,m.jsxs)("span",{className:aF().hole,children:[(0,m.jsx)("p",{className:aF().note,children:a.number}),(0,m.jsxs)("span",{className:aF().buttonarea,children:[(0,m.jsx)("button",{name:"ho_".concat(a.number),onClick:function(b){return!h&&a.onSelectSound((0,t.Z)({position:a.number},d))},children:af(d.note)}),(0,m.jsx)("label",{className:"".concat(aF().bendpanel," ").concat(aF().out),htmlFor:"ho_".concat(a.number),children:h&&f.map(function(b,c){return(0,m.jsxs)("button",{onClick:function(c){return a.onSelectSound((0,t.Z)({position:a.number},b))},children:[b.bend&&Z(b.dir,b.bend)||""," ",af(b.note)]},c)})})]}),(0,m.jsxs)("span",{className:aF().buttonarea,children:[(0,m.jsx)("button",{name:"hi_".concat(a.number),onClick:function(b){return!i&&a.onSelectSound((0,t.Z)({position:a.number},e))},children:af(e.note)}),(0,m.jsx)("label",{className:"".concat(aF().bendpanel," ").concat(aF().in),htmlFor:"hi_".concat(a.number),children:i&&g.map(function(b,c){return(0,m.jsxs)("button",{onClick:function(c){return a.onSelectSound((0,t.Z)({position:a.number},b))},children:[b.bend&&Z(b.dir,b.bend)||""," ",af(b.note)]},c)})})]})]})},aH=function(a){return(0,m.jsx)("div",{className:aF().harmonica,children:(0,m.jsx)("div",{className:aF().body,children:Array(10).fill(0).map(function(b,c){var d,e;return(0,m.jsx)(aG,{onSelectSound:null!==(d=a.onSelectSound)&& void 0!==d?d:function(a){},number:c+1,data:null!==(e=a.layout&&a.layout[c+1])&& void 0!==e?e:[]},c)})})})},aI=c(4280),aJ=c.n(aI),aK=function(a){var b=(0,p.useContext)(x),c=function(a){var c="note"==b.data.memory.insert.mode?ai.addNote:ai.extendChord;b.fn.saved.modifySheet(function(d){return"diatonic"==d.type?c(d,[a],b.data.memory.insert.duration,b.data.memory.selectedIndex):d}),b.fn.memory.setSelected(null)},d=b.data.memory.layouts.find(function(a){return a.label==b.data.saved.sheet.layout}),e="diatonic"==d.type&&d.layout;return(0,m.jsx)("span",{className:aJ().harmonicaWrapper,children:(0,m.jsx)(aH,{layout:e,onSelectSound:c})})},aL=Object.freeze(Array(80).fill(0).map(function(a,b){return String.fromCharCode(43+b)})),aM=Object.freeze("!"),aN=Object.freeze("#"),aO=Object.freeze("$"),aP=Object.freeze("~"),aQ=Object.freeze("|");function aR(a){var b;return aL[("out"==a.dir?0:40)+(a.position-1)*4+(null!==(b=a.bend)&& void 0!==b?b:0)]}function aS(a){var b=aL.findIndex(function(b){return b==a});return{bend:b%4,dir:b>=40?"in":"out",position:Math.floor(b%40/4)+1}}var aT=function(a){var b=(0,p.useContext)(x);return(0,m.jsx)(M,{icon:"./img/share.svg",onClick:function(a){return window.open("?"+function(a){var b,c,d=a.memory.layouts.find(function(b){return b.label==a.saved.sheet.layout}),e=a.saved.sheet;if(d){switch(d.type){case"diatonic":if("diatonic"!=e.type)throw Error("Sheet type doesn't match layout type");c=["D"+d.sign,d.label,d.key,Object.entries(b=d.layout).map(function(a){var b=(0,q.Z)(a,2),c=b[0];return b[1].map(function(a){return aR((0,u.Z)((0,t.Z)({},a),{position:Number(c)}))+a.note}).join(aM)}).join(aM),[e.title,e.metre,e.key].join(aM),e.chords.map(function(a){switch(a.type){case"bar":return aQ;case"silence":return aP+a.duration;case"chord":return a.notes.map(function(a){return aR(a)}).join(aO)+a.duration}}).join(aM)];break;case"chromatic":c=["C"]}return encodeURI(c.join(aN))}}(b.data))}})},aU=c(2688),aV=c.n(aU),aW=c(2235),aX=c.n(aW),aY=function(a){var b,c=(0,p.useContext)(x);return(0,m.jsxs)("span",{className:aX().titleField,children:[(0,m.jsx)("span",{className:aX().brief,children:a.brief}),(0,m.jsx)("input",{placeholder:null!==(b=a.placeholder)&& void 0!==b?b:a.brief+"...",type:"text",onChange:function(a){c.fn.saved.modifySheet(function(b){return(0,u.Z)((0,t.Z)({},b),{title:a.target.value})})},defaultValue:c.data.saved.sheet.title})]})},aZ=c(1894),a$=c.n(aZ),a_=Object.freeze(["4/4","2/4","3/4","6/8","9/8","12/8",]),a0=function(a){var b=(0,p.useContext)(x);return(0,m.jsxs)("span",{className:a$().metreField,children:[(0,m.jsx)("span",{className:a$().brief,children:a.brief}),(0,m.jsx)("select",{onChange:function(a){return b.fn.saved.modifySheet(function(b){return(0,u.Z)((0,t.Z)({},b),{metre:a.target.value})})},defaultValue:b.data.saved.sheet.metre,children:a_.map(function(a,b){return(0,m.jsx)("option",{value:a,children:a},b)})})]})},a1=function(a){var b=(0,p.useContext)(x),c=(0,p.useRef)(null);return(0,m.jsxs)("div",{ref:c,className:aV().editor,children:[(0,m.jsxs)("header",{children:[(0,m.jsxs)("span",{children:[(0,m.jsx)(aY,{brief:"C\xedm"}),(0,m.jsx)(a0,{brief:"Ritmus"})]}),(0,m.jsxs)("span",{children:[(0,m.jsx)(aT,{}),(0,m.jsx)(aq,{}),(0,m.jsx)(T,{editorRef:c})]})]}),(0,m.jsx)("main",{children:(0,m.jsx)(aD,{})}),(0,m.jsxs)("footer",{children:[(0,m.jsx)(aK,{}),(0,m.jsxs)("span",{className:aV().music,children:[(0,m.jsx)(ay,{}),(0,m.jsx)(al,{onAdd:function(a){b.fn.memory.setSelected(null)},onRemove:function(){b.fn.memory.setSelected(null)}}),(0,m.jsx)(E,{})]})]})]})},a2=function(a){var b=(0,p.useContext)(x),c="unset"!=b.data.saved.sheet.type&&b.data.memory.layouts.some(function(a){return a.label==b.data.saved.sheet.layout});return(0,m.jsx)(m.Fragment,{children:c?a.children:a.fallback})},a3=c(1163),a4=c(9736),a5=c.n(a4),a6=function(a){return(0,m.jsxs)("div",{className:a5().loading,children:[(0,m.jsxs)("div",{className:a5().animationContainer,children:[(0,m.jsx)("div",{className:a5().dot+" "+a5().red}),(0,m.jsx)("div",{className:a5().dot+" "+a5().red}),(0,m.jsx)("div",{className:a5().dot+" "+a5().blue}),(0,m.jsx)("div",{className:a5().dot+" "+a5().blue})]}),(0,m.jsx)("span",{className:a5().text,children:"Loading..."})]})},a7=function(a){var b=(0,p.useContext)(x),c=(0,a3.useRouter)(),d=(0,p.useState)(!1),e=d[0],f=d[1];return(0,p.useEffect)(function(){var a=function(a){var b=decodeURI(a);try{if("D"===b[0]){var c,d,e=b.split(aN),f=e[1],g=e[2],h=(d=(c=e[3]).split(aM).map(function(a){return(0,u.Z)((0,t.Z)({},aS(a[0])),{note:a.slice(1)})}),Object.fromEntries(Array(10).fill(0).map(function(a,b){return[b+1,d.filter(function(a){return a.position==b+1}).sort(function(a,b){return a.bend-b.bend})]}))),i=e[4].split(aM),j=e[5].split(aM);return(0,u.Z)((0,t.Z)({},v),{memory:(0,u.Z)((0,t.Z)({},v.memory),{layouts:[{type:"diatonic",sign:e[0].slice(1),label:f,layout:h,key:g}]}),saved:{sheet:{type:"diatonic",title:i[0],metre:i[1],key:i[2],chords:j.map(function(a){if(a.startsWith(aQ))return{type:"bar"};if(a.startsWith(aP))return{type:"silence",duration:a.slice(aP.length)};var b=a.slice(0,1).split(aO);return{type:"chord",notes:b.map(function(a){var b=aS(a);return(0,u.Z)((0,t.Z)({},b),{note:h[b.position].find(function(a){return a.bend==b.bend&&a.dir==b.dir}).note})}),duration:a.slice(1)}}),layout:f}}})}return(0,t.Z)({},v)}catch(k){return console.error("Error while loading: ",k),(0,t.Z)({},v)}}(c.asPath.slice(c.asPath.indexOf("?")+1));a&&(b.fn.memory.setLayouts(a.memory.layouts),b.fn.saved.setSheet(a.saved.sheet)),f(!0)},[c.asPath]),(0,m.jsx)(m.Fragment,{children:e?a.children:(0,m.jsx)(a6,{})})},a8=function(a){var b=(0,p.useContext)(x),c=(0,p.useState)(!1),d=c[0],e=c[1];return(0,p.useEffect)(function(){(0,F.Z)(H().mark(function c(){var d,f;return H().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,fetch(a.layoutPath,{method:"GET",headers:{Accept:"application/json"}});case 2:if(200!=(d=c.sent).status){c.next=9;break}return c.next=6,d.text();case 6:c.t0=c.sent,c.next=10;break;case 9:c.t0="";case 10:var g;(f=c.t0)&&b.fn.memory.setLayouts((g=f,Object.values(JSON.parse(g).layouts))),e(!0);case 13:case"end":return c.stop()}},c)}))()},[a.layoutPath]),(0,m.jsx)(m.Fragment,{children:d?a.children:(0,m.jsx)(a6,{})})};function a9(){return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(o(),{children:(0,m.jsx)("title",{children:"Harm-tab"})}),(0,m.jsx)(s,{children:(0,m.jsx)(y,{children:(0,m.jsx)(a7,{children:(0,m.jsx)(a8,{layoutPath:"layouts.json",children:(0,m.jsx)(a2,{fallback:(0,m.jsx)(B,{}),children:(0,m.jsx)(a1,{})})})})})})]})}},4273:function(a){a.exports={panel:"ChordSwitcher_panel__NIqWV",chordSwitcher:"ChordSwitcher_chordSwitcher__5Vddf",active:"ChordSwitcher_active__V11sS"}},8170:function(a){a.exports={"harmonica-colors":"DiatonicHarmonica_harmonica-colors__jYnaA",harmonica:"DiatonicHarmonica_harmonica__uLRZU",body:"DiatonicHarmonica_body__k6qUd",hole:"DiatonicHarmonica_hole__3oKrL",note:"DiatonicHarmonica_note__5DuTV",buttonarea:"DiatonicHarmonica_buttonarea__Koj0e",bendpanel:"DiatonicHarmonica_bendpanel__x313w"}},2688:function(a){a.exports={"index-colors":"Editor_index-colors__Fog57",editor:"Editor_editor__DnxpZ",music:"Editor_music__QiB81"}},4280:function(a){a.exports={"index-colors":"EditorDiatonicHarmonica_index-colors__iNX7_",harmonicaWrapper:"EditorDiatonicHarmonica_harmonicaWrapper__VpIiI"}},9631:function(a){a.exports={"index-colors":"EditorSheet_index-colors__2doFh",sheetWrapper:"EditorSheet_sheetWrapper__uvvu5"}},3845:function(a){a.exports={iconButton:"IconButton_iconButton__9Rd5C",active:"IconButton_active__xxdZl"}},9626:function(a){a.exports={layoutChooser:"LayoutChooser_layoutChooser__Ja8g3"}},9736:function(a){a.exports={loading:"Loading_loading__gDSZL",animationContainer:"Loading_animationContainer__Api0v",dot:"Loading_dot__v01Q8",dotmove:"Loading_dotmove__t81e6",red:"Loading_red__BH52t",blue:"Loading_blue__y56we",text:"Loading_text__eGipa"}},1894:function(a){a.exports={metreField:"MetreField_metreField__GhFfD",brief:"MetreField_brief__BCxDi"}},9045:function(a){a.exports={musicControl:"MusicControl_musicControl__pt62P",play:"MusicControl_play__EJ9PL",stop:"MusicControl_stop__2NjoQ",playing:"MusicControl_playing__YSUa0"}},1104:function(a){a.exports={panel:"MusicalElements_panel__mwTWe",musicalElements:"MusicalElements_musicalElements__bels2"}},8461:function(a){a.exports={noteComponent:"Note_noteComponent__8pLVa",notePlaceholder:"Note_notePlaceholder__EPz2W",note:"Note_note__Ec38g",dot:"Note_dot__Luh9v"}},1714:function(a){a.exports={panel:"NoteLengths_panel__5w_3l",notelengths:"NoteLengths_notelengths__N66SC","cap-max-width":"NoteLengths_cap-max-width__Ajnee",togglePanel:"NoteLengths_togglePanel__yR_PQ",toggle:"NoteLengths_toggle__M2H00",list:"NoteLengths_list__Kl_Wv",icon:"NoteLengths_icon__QnSGZ"}},2235:function(a){a.exports={titleField:"TitleField_titleField__3jo2w",brief:"TitleField_brief__2loHB"}}},function(a){a.O(0,[910,774,888,179],function(){var b;return a(a.s=8312)}),_N_E=a.O()}])